import{o as R,a as B,c as n,d as a,e,f as b,t as l,i as d,h as f,B as T,F as S,r as x,m as C,q as y,p as F,y as P,k as j}from"./index-DuL8nq5a.js";const z={class:"events-page"},I={class:"podcasts-section"},M={key:0,class:"podcast-show-hero",style:{"margin-top":"10px"}},$=["src","alt"],q={class:"podcast-show-hero-meta"},O={class:"podcast-show-hero-title"},W={class:"podcast-show-hero-desc"},G={class:"episode-subtitle",style:{"margin-bottom":"10px"}},H={key:0,class:"episode-dot"},J={key:1},K={class:"podcast-show-hero-actions"},Q=["href"],X={class:"episode-list",style:{"margin-top":"12px"}},Y=["src","alt"],Z={class:"episode-meta"},ss={class:"episode-title"},es={class:"episode-subtitle"},ts={key:0,class:"episode-dot"},os={key:1},ns={key:0,class:"episode-desc"},is={class:"episode-actions"},as=["href"],ls={key:1,class:"empty-state",style:{"margin-top":"14px"}},rs={class:"podcasts-section"},ds={class:"episode-list"},cs=["src","alt"],us={class:"episode-meta"},ps={class:"episode-title"},vs={class:"episode-subtitle"},hs={key:0,class:"episode-dot"},_s={key:1},ms={key:0,class:"episode-desc"},gs={class:"episode-actions"},fs=["href"],ys={key:2,class:"episode-open",style:{opacity:"0.7",cursor:"default"}},ws={key:0,class:"podcasts-section"},ks={class:"episode-list"},Cs={__name:"EventsView",setup(Ss){const v=C(!0),h=C([]),_=C([]),N=typeof window<"u"?window.location.origin:"";function m(o){return typeof o=="string"&&/^https?:\/\//i.test(o)}function A(o){if(!Array.isArray(o))return null;for(const t of o)if(m(t))return t;return null}const g=y(()=>{var s,r;const o=Array.isArray((s=h.value)==null?void 0:s.events)?h.value.events:[],t=Array.isArray((r=_.value)==null?void 0:r.videos)?_.value.videos:[],p=new Map;for(const i of t)i!=null&&i.event_id&&p.set(String(i.event_id),i);return o.map(i=>{const u=p.get(String(i.id||"")),V=A(i==null?void 0:i.photos),D=m(i==null?void 0:i.image)?i.image:null,U=m(u==null?void 0:u.thumbnail)?u.thumbnail:null;return{...i,image:V||D||U||null,photos:Array.isArray(i==null?void 0:i.photos)?i.photos.filter(m):[],videoUrl:(u==null?void 0:u.url)||null,videoStatus:(u==null?void 0:u.status)==="available"?"Recording available":(u==null?void 0:u.status)==="coming_soon"?"Recording coming soon":""}})}),w=y(()=>{const o=g.value.filter(s=>String(s.status||"").toLowerCase()==="upcoming"),t=g.value.filter(s=>!["upcoming","past"].includes(String(s.status||"").toLowerCase())),p=new Date;for(const s of t){const r=s.date?new Date(s.date):null;(!r||isNaN(r.getTime())||r>=p)&&o.push(s)}return o.sort((s,r)=>String(s.date||"").localeCompare(String(r.date||""))),o.slice(0,12)}),E=y(()=>{const o=g.value.filter(s=>String(s.status||"").toLowerCase()==="past"),t=g.value.filter(s=>!["upcoming","past"].includes(String(s.status||"").toLowerCase())),p=new Date;for(const s of t){const r=s.date?new Date(s.date):null;r&&!isNaN(r.getTime())&&r<p&&o.push(s)}return o.sort((s,r)=>String(r.date||"").localeCompare(String(s.date||""))),o}),c=y(()=>w.value[0]||null);function k(o){if(!o)return"";const t=new Date(o);return isNaN(t.getTime())?String(o):t.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}async function L(o){try{await navigator.clipboard.writeText(o),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Link copied."}}))}catch{}}return R(async()=>{v.value=!0;try{const o=await B("/api/events");h.value={events:o.events||[]},_.value={videos:o.videos||[]}}catch{h.value={events:[]},_.value={videos:[]}}v.value=!1}),(o,t)=>{const p=F("router-link");return n(),a("div",z,[t[14]||(t[14]=e("section",{class:"podcasts-hero"},[e("div",{class:"podcasts-hero-inner"},[e("h1",null,[e("i",{class:"fas fa-calendar","aria-hidden":"true"}),b(" Events ")]),e("p",null,"Upcoming live Ahoy shows, plus past events and recordings.")])],-1)),e("section",I,[t[9]||(t[9]=e("div",{class:"podcasts-section-header"},[e("h2",null,"Upcoming")],-1)),c.value?(n(),a("div",M,[e("img",{class:"podcast-show-hero-art",src:c.value.image||"/static/img/default-cover.jpg",alt:c.value.title},null,8,$),e("div",q,[t[6]||(t[6]=e("div",{class:"podcast-show-hero-kicker"},"Featured event",-1)),e("h1",O,l(c.value.title),1),e("p",W,l(c.value.description),1),e("div",G,[e("span",null,l(k(c.value.date)),1),t[5]||(t[5]=e("span",{class:"episode-dot"},"•",-1)),e("span",null,l(c.value.time||""),1),c.value.venue?(n(),a("span",H,"•")):d("",!0),c.value.venue?(n(),a("span",J,l(c.value.venue),1)):d("",!0)]),e("div",K,[e("a",{class:"podcast-cta",href:c.value.rsvp_external_url||"/events",onClick:t[0]||(t[0]=f(()=>{},["stop"]))},l(c.value.rsvp_external_url?"RSVP":"View"),9,Q),e("button",{type:"button",class:"podcast-cta secondary",onClick:t[1]||(t[1]=s=>L(c.value.rsvp_external_url||T(N)+"/events"))}," Copy link ")])])])):d("",!0),e("div",X,[(n(!0),a(S,null,x(w.value,s=>(n(),a("article",{key:s.id||s.title,class:"episode-row"},[e("img",{class:"episode-art",src:s.image||"/static/img/default-cover.jpg",alt:s.title,loading:"lazy"},null,8,Y),e("div",Z,[e("div",ss,l(s.title||"Live Show"),1),e("div",es,[e("span",null,l(k(s.date)),1),t[7]||(t[7]=e("span",{class:"episode-dot"},"•",-1)),e("span",null,l(s.time||""),1),s.venue?(n(),a("span",ts,"•")):d("",!0),s.venue?(n(),a("span",os,l(s.venue),1)):d("",!0)]),s.description?(n(),a("div",ns,l(s.description),1)):d("",!0)]),e("div",is,[e("a",{class:"episode-open",href:s.rsvp_external_url||"/events",onClick:t[2]||(t[2]=f(()=>{},["stop"]))},l(s.rsvp_external_url?"RSVP":"Open"),9,as)])]))),128))]),!v.value&&w.value.length===0?(n(),a("div",ls,[...t[8]||(t[8]=[e("i",{class:"fas fa-calendar-times"},null,-1),e("h4",null,"No upcoming events",-1),e("p",null,"Check back soon.",-1)])])):d("",!0)]),e("section",rs,[t[12]||(t[12]=e("div",{class:"podcasts-section-header"},[e("h2",null,"Past events")],-1)),e("div",ds,[(n(!0),a(S,null,x(E.value,s=>(n(),a("article",{key:s.id||s.title,class:"episode-row"},[e("img",{class:"episode-art",src:s.image||"/static/img/default-cover.jpg",alt:s.title,loading:"lazy"},null,8,cs),e("div",us,[e("div",ps,l(s.title||"Event"),1),e("div",vs,[e("span",null,l(k(s.date)),1),t[10]||(t[10]=e("span",{class:"episode-dot"},"•",-1)),e("span",null,l(s.venue||""),1),s.videoStatus?(n(),a("span",hs,"•")):d("",!0),s.videoStatus?(n(),a("span",_s,l(s.videoStatus),1)):d("",!0)]),s.description?(n(),a("div",ms,l(s.description),1)):d("",!0)]),e("div",gs,[s.videoUrl?(n(),a("a",{key:0,class:"episode-open",href:s.videoUrl,target:"_blank",rel:"noopener",onClick:t[3]||(t[3]=f(()=>{},["stop"]))}," Watch ",8,fs)):d("",!0),s.id||s.title?(n(),P(p,{key:1,to:`/events/${encodeURIComponent(s.id||s.title)}`,class:"episode-open",onClick:t[4]||(t[4]=f(()=>{},["stop"]))},{default:j(()=>[...t[11]||(t[11]=[b(" View ",-1)])]),_:1},8,["to"])):d("",!0),!s.videoUrl&&s.videoStatus?(n(),a("span",ys,l(s.videoStatus),1)):d("",!0)])]))),128))])]),v.value?(n(),a("section",ws,[e("div",ks,[(n(),a(S,null,x(4,s=>e("div",{class:"episode-row",key:s},[...t[13]||(t[13]=[e("div",{class:"episode-art skeleton",style:{width:"80px",height:"80px","border-radius":"8px"}},null,-1),e("div",{class:"episode-meta"},[e("div",{class:"skeleton",style:{height:"14px",width:"60%","margin-bottom":"6px"}}),e("div",{class:"skeleton",style:{height:"12px",width:"40%"}})],-1)])])),64))])])):d("",!0)])}}};export{Cs as default};
