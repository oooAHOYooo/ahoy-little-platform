import{_ as K,u as Z,m as S,S as D,T,o as $,E as w,b as Q,c as p,d as v,e,G as ee,f as o,B as A,F as te,t as f,j as h,k as y,n as N,h as I,C as se,i as ne,U as P,N as ae,p as oe,V as le,W as ie,X as re,Y as de,s as ue}from"./index-WQBy9ztw.js";const ce={class:"settings-page"},ge={class:"settings-container"},me={class:"settings-content"},pe={class:"settings-section neu-card"},ve={class:"settings-profile"},fe={class:"settings-value"},he={class:"settings-links"},ye={key:1,class:"settings-guest"},be={class:"settings-section neu-card"},Se={class:"settings-row setting-toggle-row"},we=["aria-pressed"],ke={class:"settings-row setting-toggle-row"},Ee=["aria-pressed"],xe={class:"settings-grid"},Ce={class:"setting-item"},Ve={class:"dial-container"},_e={class:"dial-value"},Le={class:"settings-section neu-card experimental-section"},Me={class:"experimental-grid"},De={class:"downloads-table-wrap"},Te={key:0,class:"downloads-table"},Ae=["href"],Ne={key:1,class:"downloads-table-loading"},Ie={key:2,class:"downloads-table-error"},V="ahoySettings",Pe={__name:"SettingsView",setup(Oe){const O=ue(),g=ae(),k=Z(),Y=S(null),l=P({masterVolume:75}),r=S(D()),d=S(T());function B(){r.value=!r.value,le(r.value),r.value&&ie()}function F(){d.value=!d.value,re(d.value),d.value&&de()}const a=P({version:"",date:"",download_url:"",name:"",loading:!0,error:""}),_=S("");function J(){const s=new Date;_.value=s.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}let E=!1,x=null,u=null,c=null;function R(){g.isLoggedIn.value?w("/api/user/profile",{credentials:"include"}).then(s=>{var t;(t=s==null?void 0:s.preferences)!=null&&t.audioSettings&&(l.masterVolume=Math.max(0,Math.min(100,s.preferences.audioSettings.masterVolume??75))),C()}).catch(()=>C()):C()}function C(){var s;try{const t=localStorage.getItem(V);if(t){const n=JSON.parse(t);((s=n.audioSettings)==null?void 0:s.masterVolume)!=null&&(l.masterVolume=Math.max(0,Math.min(100,n.audioSettings.masterVolume)))}}catch{}b()}function X(){const s={audioSettings:{...l}};localStorage.setItem(V,JSON.stringify(s)),g.isLoggedIn.value&&w("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({preferences:{audioSettings:l}})}).catch(()=>{}),b(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Settings saved!",type:"success"}}))}function z(){l.masterVolume=75;const s={audioSettings:{...l}};localStorage.setItem(V,JSON.stringify(s)),g.isLoggedIn.value&&w("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({preferences:{audioSettings:l}})}).catch(()=>{}),b(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Settings reset to defaults",type:"info"}}))}function b(){var t;const s=l.masterVolume/100;document.querySelectorAll("audio").forEach(n=>{n.volume=s});try{const n=(t=k.getAudioElement)==null?void 0:t.call(k);n&&(n.volume=s)}catch{}}function L(s,t){E=!0,x=t;const n=s.currentTarget;u=m=>U(m,n),c=()=>M(),document.addEventListener("mousemove",u),document.addEventListener("mouseup",c),document.addEventListener("touchmove",u,{passive:!1}),document.addEventListener("touchend",c)}function U(s,t){if(!E||!t)return;const n=s.touches?s.touches[0].clientX:s.clientX,m=s.touches?s.touches[0].clientY:s.clientY,i=t.getBoundingClientRect(),G=i.left+i.width/2,H=i.top+i.height/2,W=(Math.atan2(m-H,n-G)*(180/Math.PI)+90+360)%360,q=Math.max(0,Math.min(100,W/1.8));x==="masterVolume"&&(l.masterVolume=q),b()}function M(){E=!1,x=null,u&&(document.removeEventListener("mousemove",u),document.removeEventListener("touchmove",u)),c&&(document.removeEventListener("mouseup",c),document.removeEventListener("touchend",c)),u=null,c=null}async function j(){await g.logout(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Signed out",type:"success"}})),O.push("/")}return $(()=>{r.value=D(),d.value=T(),R(),J(),w("/api/downloads/latest",{credentials:"include"}).then(s=>{a.version=(s==null?void 0:s.version)??"",a.date=(s==null?void 0:s.date)??"",a.download_url=(s==null?void 0:s.download_url)??"",a.name=(s==null?void 0:s.name)??"",a.loading=!1}).catch(()=>{a.error="No macOS release available",a.loading=!1})}),Q(()=>{M()}),(s,t)=>{var m;const n=oe("router-link");return p(),v("div",ce,[e("div",ge,[t[26]||(t[26]=ee('<section class="podcasts-hero settings-page-header" data-v-6ba27906><div class="podcasts-hero-inner" data-v-6ba27906><h1 data-v-6ba27906><i class="fas fa-cog" aria-hidden="true" data-v-6ba27906></i> Settings </h1><p data-v-6ba27906>Customize your Ahoy experience.</p></div></section><div class="settings-header desktop-only" data-v-6ba27906><div class="settings-header-icon" data-v-6ba27906><i class="fas fa-cog" data-v-6ba27906></i></div><h1 data-v-6ba27906>Settings</h1><p data-v-6ba27906>Customize your Ahoy experience</p></div>',2)),e("div",me,[e("div",pe,[t[8]||(t[8]=e("h2",null,[e("i",{class:"fas fa-user"}),o(" Account")],-1)),A(g).isLoggedIn.value?(p(),v(te,{key:0},[e("div",ve,[t[2]||(t[2]=e("span",{class:"settings-label"},"Logged in as",-1)),e("span",fe,f((m=A(g).user.value)==null?void 0:m.email),1)]),e("div",he,[h(n,{to:"/account",class:"settings-link"},{default:y(()=>[...t[3]||(t[3]=[e("i",{class:"fas fa-user-circle"},null,-1),o(" Account & wallet ",-1)])]),_:1}),h(n,{to:"/my-saves",class:"settings-link"},{default:y(()=>[...t[4]||(t[4]=[e("i",{class:"fas fa-bookmark"},null,-1),o(" Saved ",-1)])]),_:1})]),e("button",{type:"button",class:"neu-btn neu-btn-secondary logout-btn",onClick:j},[...t[5]||(t[5]=[e("i",{class:"fas fa-sign-out-alt"},null,-1),o(" Sign out ",-1)])])],64)):(p(),v("div",ye,[t[7]||(t[7]=e("p",null,"Sign in to manage your preferences.",-1)),h(n,{to:"/login",class:"neu-btn neu-btn-primary"},{default:y(()=>[...t[6]||(t[6]=[o("Sign in",-1)])]),_:1})]))]),e("div",be,[t[15]||(t[15]=e("h2",null,[e("i",{class:"fas fa-volume-up"}),o(" Audio")],-1)),e("div",Se,[t[10]||(t[10]=e("div",{class:"setting-toggle-label"},[e("span",{class:"setting-toggle-title"},"Save chime"),e("span",{class:"setting-toggle-desc"},"Play a short sound when you save a track or show")],-1)),e("button",{type:"button",class:N(["setting-toggle-btn",{on:r.value}]),"aria-pressed":r.value,onClick:B},[...t[9]||(t[9]=[e("span",{class:"setting-toggle-thumb"},null,-1)])],10,we)]),e("div",ke,[t[12]||(t[12]=e("div",{class:"setting-toggle-label"},[e("span",{class:"setting-toggle-title"},"Tap sound"),e("span",{class:"setting-toggle-desc"},"A tiny chime when you tap buttons and links")],-1)),e("button",{type:"button",class:N(["setting-toggle-btn",{on:d.value}]),"aria-pressed":d.value,onClick:F},[...t[11]||(t[11]=[e("span",{class:"setting-toggle-thumb"},null,-1)])],10,Ee)]),e("div",xe,[e("div",Ce,[t[14]||(t[14]=e("label",null,"Master Volume",-1)),e("div",Ve,[e("div",{ref_key:"dialEl",ref:Y,class:"neu-dial",style:se({transform:`rotate(${l.masterVolume*1.8-90}deg)`}),onMousedown:t[0]||(t[0]=I(i=>L(i,"masterVolume"),["prevent"])),onTouchstart:t[1]||(t[1]=I(i=>L(i,"masterVolume"),["prevent"]))},[...t[13]||(t[13]=[e("div",{class:"dial-handle"},null,-1)])],36),e("span",_e,f(Math.round(l.masterVolume)),1)])])])]),e("div",Le,[t[21]||(t[21]=e("h2",null,[e("i",{class:"fas fa-flask"}),o(" Experimental")],-1)),t[22]||(t[22]=e("p",{class:"experimental-disclaimer"},"These features are still in development and may change or be removed.",-1)),e("div",Me,[h(n,{to:"/focus",class:"experimental-card neu-card-inset"},{default:y(()=>[...t[16]||(t[16]=[e("div",{class:"experimental-card-icon"},[e("i",{class:"fas fa-headphones"})],-1),e("div",{class:"experimental-card-info"},[e("h3",null,"Focus Mode"),e("p",null,"Ambient audio for deep focus and relaxation")],-1),e("i",{class:"fas fa-chevron-right experimental-card-arrow"},null,-1)])]),_:1}),h(n,{to:"/mp3-player",class:"experimental-card neu-card-inset"},{default:y(()=>[...t[17]||(t[17]=[e("div",{class:"experimental-card-icon"},[e("i",{class:"fas fa-compact-disc"})],-1),e("div",{class:"experimental-card-info"},[e("h3",null,"MP3 Player"),e("p",null,"Import and play MP3s from your computer — Winamp style")],-1),e("i",{class:"fas fa-chevron-right experimental-card-arrow"},null,-1)])]),_:1}),h(n,{to:"/download",class:"experimental-card neu-card-inset"},{default:y(()=>[...t[18]||(t[18]=[e("div",{class:"experimental-card-icon"},[e("i",{class:"fas fa-download"})],-1),e("div",{class:"experimental-card-info"},[e("h3",null,"Download"),e("p",null,"Get Ahoy on web, Android, iOS, or desktop")],-1),e("i",{class:"fas fa-chevron-right experimental-card-arrow"},null,-1)])]),_:1})]),t[23]||(t[23]=e("p",{class:"downloads-table-intro"},[o("Latest macOS desktop build — also at "),e("a",{href:"/downloads",target:"_blank",rel:"noopener"},"app.ahoy.ooo/downloads"),o(".")],-1)),e("div",De,[a.version?(p(),v("table",Te,[t[20]||(t[20]=e("thead",null,[e("tr",null,[e("th",null,"Date"),e("th",null,"Version"),e("th",null,"Download")])],-1)),e("tbody",null,[e("tr",null,[e("td",null,f(_.value),1),e("td",null,f(a.version),1),e("td",null,[e("a",{href:a.download_url,target:"_blank",rel:"noopener",class:"download-table-link"},[o(f(a.name||"ZIP")+" ",1),t[19]||(t[19]=e("i",{class:"fas fa-external-link-alt"},null,-1))],8,Ae)])])])])):a.loading?(p(),v("p",Ne,"Loading…")):a.error?(p(),v("p",Ie,f(a.error),1)):ne("",!0)])]),e("div",{class:"settings-actions"},[e("button",{type:"button",class:"neu-btn neu-btn-secondary",onClick:z},[...t[24]||(t[24]=[e("i",{class:"fas fa-undo"},null,-1),o(" Reset to Defaults ",-1)])]),e("button",{type:"button",class:"neu-btn neu-btn-primary",onClick:X},[...t[25]||(t[25]=[e("i",{class:"fas fa-save"},null,-1),o(" Save Settings ",-1)])])])])])])}}},Fe=K(Pe,[["__scopeId","data-v-6ba27906"]]);export{Fe as default};
