import{_ as H,c as d,d as c,e,C as j,n as m,t as b,D as x,q as B,m as p,F as V,r as F,i as A,u as le,z as se,w as ie,o as oe,y as ne,k as N,f as re,j as R,l as J,v as K,E as W,s as ue,p as de,B as u,h as g}from"./index-B40IuYg0.js";const z=70,Z=120,ce={__name:"PullRefresh",emits:["refresh"],setup(o,{emit:r}){const f=r,M=p(null),v=p(!1),l=p(!1),i=p(0),y=p(0),$=B(()=>l.value?z*.6:Math.min(y.value*.5,Z*.5)),Q=B(()=>l.value?0:Math.min(y.value*.4,Z*.4)-40),L=B(()=>l.value?1:Math.min(y.value/z,1)),O=B(()=>y.value>=z);function q(){return window.scrollY<=0}function I(C){!q()||l.value||(i.value=C.touches[0].clientY,v.value=!0)}function E(C){if(!v.value||l.value)return;const h=C.touches[0].clientY-i.value;h>0?y.value=h:(v.value=!1,y.value=0)}function U(){v.value&&(O.value?(l.value=!0,y.value=0,f("refresh",k)):y.value=0,v.value=!1)}function k(){l.value=!1,y.value=0}return(C,h)=>(d(),c("div",{class:"pull-refresh-wrapper",ref_key:"wrapper",ref:M,onTouchstartPassive:I,onTouchmovePassive:E,onTouchendPassive:U},[e("div",{class:m(["pull-indicator",{active:v.value,refreshing:l.value}]),style:j({transform:`translateY(${Q.value}px)`,opacity:L.value})},[e("i",{class:m(l.value?"fas fa-spinner fa-spin":"fas fa-arrow-down"),style:j({transform:O.value?"rotate(180deg)":""})},null,6),e("span",null,b(l.value?"Refreshing...":O.value?"Release to refresh":"Pull to refresh"),1)],6),e("div",{class:"pull-content",style:j({transform:`translateY(${$.value}px)`})},[x(C.$slots,"default",{},void 0)],4)],544))}},ve=H(ce,[["__scopeId","data-v-d1c2085f"]]),fe={class:"sub-menu-filter-glass"},me={class:"sub-menu-filter-row"},be=["value"],ye=["value"],pe=["value"],he={key:0,class:"sub-menu-filter-search"},ge=["value","placeholder","aria-label"],ke=["value","aria-label"],we=["value"],$e=["value"],Ce=["value"],Te={key:4,class:"sub-menu-filter-view"},Ae={__name:"SubMenuFilter",props:{modelValue:{type:[String,Number],default:""},filters:{type:Array,default:()=>[]},allValue:{type:[String,Number],default:""},filterAllLabel:{type:String,default:"All"},showSearch:{type:Boolean,default:!1},searchPlaceholder:{type:String,default:"Search…"},searchQuery:{type:String,default:""},sortOptions:{type:Array,default:()=>[]},sortLabel:{type:String,default:"Sort"},sortBy:{type:String,default:""},showViewToggle:{type:Boolean,default:!1},viewMode:{type:String,default:"list"},actionLabel:{type:String,default:""},actionIcon:{type:String,default:""},showFavoritesToggle:{type:Boolean,default:!1},favoritesOnly:{type:Boolean,default:!1},albums:{type:Array,default:()=>[]},selectedAlbum:{type:String,default:""}},emits:["update:modelValue","update:searchQuery","update:sortBy","update:viewMode","update:favoritesOnly","update:selectedAlbum","action"],setup(o,{emit:r}){const f=o,M=B(()=>f.showSearch||f.sortOptions&&f.sortOptions.length||f.showViewToggle||f.actionLabel||f.actionIcon&&!f.actionLabel);return(v,l)=>(d(),c("div",{class:m(["sub-menu-filter",{"has-toolbar":M.value}])},[e("div",fe,[e("div",me,[e("select",{value:o.modelValue,class:"sub-menu-filter-sort main-filter","aria-label":"Filter by Artist",onChange:l[0]||(l[0]=i=>v.$emit("update:modelValue",i.target.value))},[e("option",{value:o.allValue},b(o.filterAllLabel||"All Artists"),9,ye),(d(!0),c(V,null,F(o.filters,i=>(d(),c("option",{key:String(i.value),value:i.value},b(i.label),9,pe))),128))],40,be)]),o.showSearch?(d(),c("div",he,[l[10]||(l[10]=e("i",{class:"fas fa-search","aria-hidden":"true"},null,-1)),e("input",{value:o.searchQuery,type:"text",class:"sub-menu-filter-search-input",placeholder:o.searchPlaceholder,"aria-label":o.searchPlaceholder,onInput:l[1]||(l[1]=i=>v.$emit("update:searchQuery",i.target.value))},null,40,ge),o.searchQuery?(d(),c("button",{key:0,type:"button",class:"sub-menu-filter-search-clear","aria-label":"Clear search",onClick:l[2]||(l[2]=i=>v.$emit("update:searchQuery",""))},[...l[9]||(l[9]=[e("i",{class:"fas fa-times","aria-hidden":"true"},null,-1)])])):A("",!0)])):A("",!0),o.sortOptions&&o.sortOptions.length?(d(),c("select",{key:1,value:o.sortBy,class:"sub-menu-filter-sort","aria-label":o.sortLabel,onChange:l[3]||(l[3]=i=>v.$emit("update:sortBy",i.target.value))},[(d(!0),c(V,null,F(o.sortOptions,i=>(d(),c("option",{key:i.value,value:i.value},b(i.label),9,we))),128))],40,ke)):A("",!0),o.albums&&o.albums.length?(d(),c("select",{key:2,value:o.selectedAlbum,class:"sub-menu-filter-sort","aria-label":"Filter by Album",onChange:l[4]||(l[4]=i=>v.$emit("update:selectedAlbum",i.target.value))},[l[11]||(l[11]=e("option",{value:""},"All Albums",-1)),(d(!0),c(V,null,F(o.albums,i=>(d(),c("option",{key:i.value,value:i.value},b(i.label),9,Ce))),128))],40,$e)):A("",!0),o.showFavoritesToggle?(d(),c("button",{key:3,type:"button",class:m(["sub-menu-filter-view-btn",{active:o.favoritesOnly}]),title:"Show Favorites Only","aria-label":"Top Favorites Only",onClick:l[5]||(l[5]=i=>v.$emit("update:favoritesOnly",!o.favoritesOnly))},[e("i",{class:m(o.favoritesOnly?"fas fa-heart":"far fa-heart"),"aria-hidden":"true"},null,2)],2)):A("",!0),o.showViewToggle?(d(),c("div",Te,[e("button",{type:"button",class:m(["sub-menu-filter-view-btn",{active:o.viewMode==="grid"}]),"aria-label":"Grid view",onClick:l[6]||(l[6]=i=>v.$emit("update:viewMode","grid"))},[...l[12]||(l[12]=[e("i",{class:"fas fa-th","aria-hidden":"true"},null,-1)])],2),e("button",{type:"button",class:m(["sub-menu-filter-view-btn",{active:o.viewMode==="list"}]),"aria-label":"List view",onClick:l[7]||(l[7]=i=>v.$emit("update:viewMode","list"))},[...l[13]||(l[13]=[e("i",{class:"fas fa-list","aria-hidden":"true"},null,-1)])],2)])):A("",!0),x(v.$slots,"toolbar-right",{},void 0),o.actionLabel||v.$slots.action?(d(),c("button",{key:5,type:"button",class:"sub-menu-filter-action",onClick:l[8]||(l[8]=i=>v.$emit("action"))},[x(v.$slots,"action",{},()=>[o.actionIcon?(d(),c("i",{key:0,class:m(o.actionIcon),"aria-hidden":"true"},null,2)):A("",!0),e("span",null,b(o.actionLabel),1)])])):A("",!0)])],2))}},Se=H(Ae,[["__scopeId","data-v-c783a18a"]]),_e={class:"music-container"},Pe={class:"music-library-section"},Be={class:"music-list"},Me={class:"music-table-wrap"},Le={class:"music-table"},Oe=["onClick"],Ve={class:"col-art"},Fe={class:"music-table-art-wrap"},qe=["src","alt"],De=["aria-label","onClick"],Qe={class:"col-title-artist"},Ne={class:"music-track-meta"},Re={class:"title-text"},Ie={class:"music-track-artist"},Ee={class:"col-duration"},Ue={class:"col-plays"},Ye={class:"col-action"},je=["onClick"],ze=["aria-pressed","onClick"],xe={class:"music-mobile-list"},He=["onClick"],Ge={class:"music-mobile-art"},Xe=["src","alt"],Je=["aria-label","onClick"],Ke={class:"music-mobile-meta"},We={class:"music-mobile-title"},Ze={class:"music-mobile-artist"},et={class:"music-mobile-right"},tt={class:"music-mobile-duration"},at={class:"music-mobile-actions"},lt=["title","aria-label","onClick"],st=["onClick"],it=["aria-pressed","onClick"],ot={class:"music-grid"},nt=["onClick"],rt=["src","alt"],ut={class:"track-overlay"},dt=["onClick"],ct=["onClick"],vt=["title","onClick"],ft={class:"track-title"},mt={class:"track-artist"},bt={class:"track-duration"},yt={key:0,class:"music-grid"},pt={key:1,class:"empty-state"},ht={__name:"MusicView",setup(o){ue();const r=le(),f=se();function M(s){f.toggle({type:"track",id:s.id,title:s.title,cover_art:s.cover_art})}function v(s){const t=s&&(s.cover_art||s.artwork);return typeof t=="string"&&t.trim()?t:"/static/img/default-cover.jpg"}const l=p([]),i=p(!0),y=p(""),$=p(""),Q=p(!1),L=p(""),O=p("plays"),q=p("list");ie($,()=>{L.value=""});const I=B(()=>{const s=new Map;let t=l.value;$.value&&(t=t.filter(n=>n.artist===$.value));for(const n of t)n.album&&s.set(n.album,{value:n.album,label:n.album});return Array.from(s.values()).sort((n,a)=>n.label.localeCompare(a.label))}),E=B(()=>{const s=new Map;for(const t of l.value)t.artist&&(s.has(t.artist)||s.set(t.artist,{value:t.artist,label:t.artist,image:t.cover_art||t.artwork||null}));return Array.from(s.values()).sort((t,n)=>(t.label||"").localeCompare(n.label||""))}),U=[{value:"title",label:"Title"},{value:"artist",label:"Artist"},{value:"plays",label:"Plays"},{value:"added_date",label:"Date Added"}],k=B(()=>{let s=[...l.value];if(y.value){const t=y.value.toLowerCase();s=s.filter(n=>(n.title||"").toLowerCase().includes(t)||(n.artist||"").toLowerCase().includes(t)||(n.album||"").toLowerCase().includes(t))}return $.value&&(s=s.filter(t=>t.artist===$.value)),L.value&&(s=s.filter(t=>t.album===L.value)),Q.value&&(s=s.filter(t=>f.isBookmarked({id:t.id}))),s.sort((t,n)=>{switch(O.value){case"title":return(t.title||"").localeCompare(n.title||"");case"artist":return(t.artist||"").localeCompare(n.artist||"");case"added_date":return new Date(n.added_date||0)-new Date(t.added_date||0);case"plays":return(n.play_count||0)-(t.play_count||0);default:return 0}}),s});function C(s){if(!s&&s!==0)return"0:00";const t=Math.floor(Number(s)/60),n=Math.floor(Number(s)%60);return`${t}:${n.toString().padStart(2,"0")}`}function h(s){var a;const t=k.value,n=t[s];if(n){if(((a=r.currentTrack)==null?void 0:a.id)===n.id&&r.isPlaying){r.pause();return}r.setQueue(t,s)}}function Y(s){r.addToQueue({type:"track",id:s.id,title:s.title,artist:s.artist,cover_art:s.cover_art,duration_seconds:s.duration_seconds})}function ee(){if(k.value.length===0)return;const s=Math.floor(Math.random()*k.value.length);h(s)}async function te(){i.value=!0;try{const s=await W("/api/music?t="+Date.now());l.value=s.tracks||[]}catch{l.value=[]}i.value=!1}async function ae(s){try{const t=await W("/api/music?t="+Date.now());l.value=t.tracks||[]}catch{}s()}return oe(te),(s,t)=>{const n=de("router-link");return d(),ne(ve,{onRefresh:ae},{default:N(()=>[e("div",_e,[t[19]||(t[19]=e("section",{class:"podcasts-hero"},[e("div",{class:"podcasts-hero-inner"},[e("h1",null,[e("i",{class:"fas fa-music","aria-hidden":"true"}),re(" Music Library ")]),e("p",null,"Explore")])],-1)),e("section",Pe,[R(Se,{modelValue:$.value,"onUpdate:modelValue":t[0]||(t[0]=a=>$.value=a),filters:E.value,"all-value":"","filter-all-label":"All Artists","show-search":!0,"search-placeholder":"Search music…","search-query":y.value,"onUpdate:searchQuery":t[1]||(t[1]=a=>y.value=a),"sort-options":U,"sort-label":"Sort","sort-by":O.value,"onUpdate:sortBy":t[2]||(t[2]=a=>O.value=a),"show-view-toggle":!0,"view-mode":q.value,"onUpdate:viewMode":t[3]||(t[3]=a=>q.value=a),albums:I.value,"selected-album":L.value,"onUpdate:selectedAlbum":t[4]||(t[4]=a=>L.value=a),"show-favorites-toggle":!0,"favorites-only":Q.value,"onUpdate:favoritesOnly":t[5]||(t[5]=a=>Q.value=a),onAction:ee},{action:N(()=>[...t[11]||(t[11]=[e("i",{class:"fas fa-random","aria-hidden":"true"},null,-1)])]),_:1},8,["modelValue","filters","search-query","sort-by","view-mode","albums","selected-album","favorites-only"])]),J(e("div",Be,[e("div",Me,[e("table",Le,[t[14]||(t[14]=e("thead",null,[e("tr",null,[e("th",{class:"col-art"},"Album"),e("th",{class:"col-title-artist"},"Track"),e("th",{class:"col-duration"},"Duration"),e("th",{class:"col-plays col-plays-header"},"Plays"),e("th",{class:"col-action","aria-label":"Actions"})])],-1)),e("tbody",null,[(d(!0),c(V,null,F(k.value,(a,T)=>{var S,_,w;return d(),c("tr",{key:a.id,class:m(["music-table-row",{playing:((S=u(r).currentTrack)==null?void 0:S.id)===a.id}]),onClick:P=>h(T)},[e("td",Ve,[e("div",Fe,[e("img",{class:"music-table-art",src:v(a),alt:a.title,loading:"lazy",onError:t[6]||(t[6]=P=>P.target.src="/static/img/default-cover.jpg")},null,40,qe),e("button",{type:"button",class:"music-table-art-play","aria-label":((_=u(r).currentTrack)==null?void 0:_.id)===a.id&&u(r).isPlaying?"Pause":"Play",onClick:g(P=>h(T),["stop"])},[e("i",{class:m(((w=u(r).currentTrack)==null?void 0:w.id)===a.id&&u(r).isPlaying?"fas fa-pause":"fas fa-play"),"aria-hidden":"true"},null,2)],8,De)])]),e("td",Qe,[e("div",Ne,[R(n,{to:`/music/${a.id}`,class:"title-link",onClick:t[7]||(t[7]=g(()=>{},["stop"]))},{default:N(()=>[e("span",Re,b(a.title),1)]),_:2},1032,["to"]),e("span",Ie,b(a.artist),1)])]),e("td",Ee,b(C(a.duration_seconds)),1),e("td",Ue,b(a.play_count||0),1),e("td",Ye,[e("button",{type:"button",class:"episode-btn queue-btn",title:"Add to queue","aria-label":"Add to queue",onClick:g(P=>Y(a),["stop"])},[...t[12]||(t[12]=[e("i",{class:"fas fa-plus","aria-hidden":"true"},null,-1),e("span",{class:"sr-only"},"Add to queue",-1)])],8,je),e("button",{type:"button",class:m(["episode-btn bm-btn",{bookmarked:u(f).isBookmarked({id:a.id})}]),"aria-pressed":u(f).isBookmarked({id:a.id}),title:"Save",onClick:g(P=>M(a),["stop"])},[e("i",{class:m(u(f).isBookmarked({id:a.id})?"fas fa-bookmark":"far fa-bookmark"),"aria-hidden":"true"},null,2),t[13]||(t[13]=e("span",{class:"sr-only"},"Save",-1))],10,ze)])],10,Oe)}),128))])])]),e("div",xe,[(d(!0),c(V,null,F(k.value,(a,T)=>{var S,_,w,P,G,X;return d(),c("div",{key:"mobile-"+a.id,class:m(["music-mobile-row",{playing:((S=u(r).currentTrack)==null?void 0:S.id)===a.id}]),onClick:D=>h(T)},[e("div",Ge,[e("img",{class:"music-mobile-art-img",src:v(a),alt:a.title,loading:"lazy",onError:t[8]||(t[8]=D=>D.target.src="/static/img/default-cover.jpg")},null,40,Xe),e("button",{type:"button",class:"music-mobile-art-play","aria-label":((_=u(r).currentTrack)==null?void 0:_.id)===a.id&&u(r).isPlaying?"Pause":"Play",onClick:g(D=>h(T),["stop"])},[e("i",{class:m(((w=u(r).currentTrack)==null?void 0:w.id)===a.id&&u(r).isPlaying?"fas fa-pause":"fas fa-play"),"aria-hidden":"true"},null,2)],8,Je)]),e("div",Ke,[R(n,{to:`/music/${a.id}`,class:"music-mobile-title-link",onClick:t[9]||(t[9]=g(()=>{},["stop"]))},{default:N(()=>[e("span",We,b(a.title),1)]),_:2},1032,["to"]),e("span",Ze,b(a.artist),1)]),e("div",et,[e("div",tt,b(C(a.duration_seconds)),1),e("div",at,[e("button",{type:"button",class:"episode-btn music-mobile-btn music-mobile-play-btn",title:((P=u(r).currentTrack)==null?void 0:P.id)===a.id&&u(r).isPlaying?"Pause":"Play","aria-label":((G=u(r).currentTrack)==null?void 0:G.id)===a.id&&u(r).isPlaying?"Pause":"Play",onClick:g(D=>h(T),["stop"])},[e("i",{class:m(((X=u(r).currentTrack)==null?void 0:X.id)===a.id&&u(r).isPlaying?"fas fa-pause":"fas fa-play"),"aria-hidden":"true"},null,2)],8,lt),e("button",{type:"button",class:"episode-btn queue-btn music-mobile-btn",title:"Add to queue","aria-label":"Add to queue",onClick:g(D=>Y(a),["stop"])},[...t[15]||(t[15]=[e("i",{class:"fas fa-plus","aria-hidden":"true"},null,-1)])],8,st),e("button",{type:"button",class:m(["episode-btn bm-btn music-mobile-btn",{bookmarked:u(f).isBookmarked({id:a.id})}]),"aria-pressed":u(f).isBookmarked({id:a.id}),title:"Save",onClick:g(D=>M(a),["stop"])},[e("i",{class:m(u(f).isBookmarked({id:a.id})?"fas fa-bookmark":"far fa-bookmark"),"aria-hidden":"true"},null,2)],10,it)])])],10,He)}),128))])],512),[[K,q.value==="list"&&!i.value&&k.value.length>0]]),J(e("div",ot,[(d(!0),c(V,null,F(k.value,(a,T)=>{var S,_;return d(),c("div",{key:a.id,class:m(["track-card",{playing:((S=u(r).currentTrack)==null?void 0:S.id)===a.id}])},[e("div",{class:"track-cover",onClick:w=>h(T)},[e("img",{src:v(a),alt:a.title,loading:"lazy",onError:t[10]||(t[10]=w=>w.target.src="/static/img/default-cover.jpg")},null,40,rt),e("div",ut,[e("button",{type:"button",class:"play-btn",onClick:g(w=>h(T),["stop"])},[e("i",{class:m(((_=u(r).currentTrack)==null?void 0:_.id)===a.id&&u(r).isPlaying?"fas fa-pause":"fas fa-play")},null,2)],8,dt),e("button",{type:"button",class:"track-overlay-btn add-to-playlist-btn",title:"Add to queue",onClick:g(w=>Y(a),["stop"])},[...t[16]||(t[16]=[e("i",{class:"fas fa-plus"},null,-1)])],8,ct),e("button",{type:"button",class:"track-overlay-btn bm-btn",title:u(f).isBookmarked({id:a.id})?"Unsave":"Save",onClick:g(w=>M(a),["stop"])},[e("i",{class:m(u(f).isBookmarked({id:a.id})?"fas fa-bookmark":"far fa-bookmark"),"aria-hidden":"true"},null,2)],8,vt)])],8,nt),R(n,{to:`/music/${a.id}`,class:"track-info",style:{"text-decoration":"none",color:"inherit"}},{default:N(()=>[e("div",ft,b(a.title),1),e("div",mt,b(a.artist),1),e("div",bt,b(C(a.duration_seconds)),1)]),_:2},1032,["to"])],2)}),128))],512),[[K,q.value==="grid"&&!i.value&&k.value.length>0]]),i.value?(d(),c("div",yt,[(d(),c(V,null,F(8,a=>e("div",{key:a,class:"track-card"},[...t[17]||(t[17]=[e("div",{class:"track-cover skeleton"},null,-1),e("div",{class:"track-info"},[e("div",{class:"skeleton",style:{height:"14px",width:"60%","margin-bottom":"6px"}}),e("div",{class:"skeleton",style:{height:"12px",width:"40%","margin-bottom":"4px"}}),e("div",{class:"skeleton",style:{height:"10px",width:"36px"}})],-1)])])),64))])):!i.value&&k.value.length===0?(d(),c("div",pt,[...t[18]||(t[18]=[e("i",{class:"fas fa-music"},null,-1),e("h3",null,"No music found",-1),e("p",null,"Try adjusting your filters or search terms",-1)])])):A("",!0)])]),_:1})}}},kt=H(ht,[["__scopeId","data-v-eb421584"]]);export{kt as default};
