import{_ as De,u as Pe,o as Ve,a as Y,b as Ne,r as Le,c as u,d as g,e,F as D,f as P,w as W,g as w,h as se,i as A,t as f,j as K,k as O,l as H,m as h,n as We,p as qe,q as Oe,s as U,v as ze,x as Te,y as G,z as be,A as Se,B as Be}from"./index-dNq3sVO6.js";let _e=null;function Ae(){if(!_e&&typeof window<"u"){const r=window.AudioContext||window.webkitAudioContext;r&&(_e=new r)}return _e}function Fe(){if(typeof window>"u")return;const r=Ae();if(!r)return;r.state==="suspended"&&r.resume().catch(()=>{});const m=r.currentTime,i=r.createOscillator(),_=r.createGain();i.type="triangle",i.frequency.setValueAtTime(800,m),i.frequency.exponentialRampToValueAtTime(1200,m+.05),_.gain.setValueAtTime(0,m),_.gain.linearRampToValueAtTime(.05,m+.01),_.gain.exponentialRampToValueAtTime(.001,m+.05),i.connect(_),_.connect(r.destination),i.start(m),i.stop(m+.05)}function Qe(){if(typeof window>"u")return;const r=Ae();if(!r)return;r.state==="suspended"&&r.resume().catch(()=>{});const m=r.currentTime,i=r.createOscillator(),_=r.createGain();i.type="square",i.frequency.setValueAtTime(400,m),i.frequency.exponentialRampToValueAtTime(600,m+.1),_.gain.setValueAtTime(0,m),_.gain.linearRampToValueAtTime(.08,m+.01),_.gain.exponentialRampToValueAtTime(.001,m+.1),i.connect(_),_.connect(r.destination),i.start(m),i.stop(m+.1)}function Ge(){return{playHoverSound:Fe,playClickSound:Qe}}const ae={mounted(r,m){const i={max:15,perspective:1e3,scale:1.05,speed:1e3,...m.value};r.style.transformStyle="preserve-3d",r.style.transform=`perspective(${i.perspective}px)`;const _=j=>{const S=r.getBoundingClientRect(),E=j.clientX-S.left,le=j.clientY-S.top,Z=S.width/2,p=S.height/2,C=(le-p)/p*-i.max,N=(E-Z)/Z*i.max;(i.target?r.querySelectorAll(i.target):[r]).forEach(y=>{y.style.transition="none",y.style.transform=`
                    perspective(${i.perspective}px)
                    rotateX(${C}deg)
                    rotateY(${N}deg)
                    scale3d(${i.scale}, ${i.scale}, ${i.scale})
                 `})},z=()=>{(i.target?r.querySelectorAll(i.target):[r]).forEach(S=>{S.style.transition=`transform ${i.speed}ms cubic-bezier(.03,.98,.52,.99)`,S.style.transform=`
                    perspective(${i.perspective}px)
                    rotateX(0deg)
                    rotateY(0deg)
                    scale3d(1, 1, 1)
                `})};r.addEventListener("mousemove",_),r.addEventListener("mouseleave",z),r._tiltCleanup=()=>{r.removeEventListener("mousemove",_),r.removeEventListener("mouseleave",z)}},unmounted(r){r._tiltCleanup&&r._tiltCleanup()}},Xe={key:0,class:"explore-widgets-container"},Je={class:"explore-widget recent-widget"},Ue={class:"widget-grid"},He={key:0,class:"empty-placeholder"},Ke={class:"card-image"},et=["src","alt"],tt={class:"card-title"},st={class:"explore-widget saves-widget"},at={class:"widget-grid"},lt={key:0,class:"empty-placeholder"},nt={class:"card-image"},it=["src","alt"],ot={class:"card-title"},rt={class:"explore-widget video-widget"},ct={class:"widget-grid"},dt={class:"card-image"},ut=["src","alt"],vt={class:"card-title"},ht={class:"explore-widget podcast-widget"},pt={class:"widget-grid"},mt={class:"card-image"},ft=["src","alt"],gt={class:"card-title"},wt={class:"explore-widget music-widget"},yt={class:"widget-grid"},kt={class:"card-image"},bt=["src","alt"],_t={class:"card-title"},Ct={class:"explore-widget artist-widget"},xt={class:"widget-grid"},$t={class:"card-image circle"},Mt=["src","alt"],Tt={class:"card-title"},St={__name:"ExploreWidgets",setup(r){const m=h(!0),i=h([]),_=h([]),z=h([]),j=h([]),S=h([]),E=h([]),le=Pe(),{playHoverSound:Z,playClickSound:p}=Ge();typeof window<"u"&&window.matchMedia("(hover: hover)").matches;function C(y,n){return!y||y.length===0?[]:[...y].sort(()=>.5-Math.random()).slice(0,n)}function N(){try{const y=localStorage.getItem("ahoy.recentlyPlayed.v1");y&&(E.value=JSON.parse(y).slice(0,6))}catch(y){console.error("Failed to load recently played",y)}}function I(){const y=Object.values(le.bookmarks.value||{});S.value=y.reverse().slice(0,6)}return Ve(async()=>{try{const[y,n,T,a]=await Promise.all([Y("/api/podcasts").catch(()=>({shows:[]})),Y("/api/shows").catch(()=>({shows:[]})),Y("/api/music").catch(()=>({tracks:[],albums:[]})),Y("/api/artists").catch(()=>({artists:[]}))]);i.value=C(y.shows||[],6),_.value=C(n.shows||[],6);const ce=T.tracks||[],ne=new Map,de=[];for(const v of ce)v.album&&v.album!=="Single"&&!ne.has(v.album)?ne.set(v.album,{id:v.album,title:v.album,cover_art:v.cover_art||v.artwork,artist:v.artist,type:"album"}):de.push({id:v.id,title:v.title,cover_art:v.cover_art||v.artwork,artist:v.artist,type:"track"});let V=Array.from(ne.values());if(V.length<3){const v=3-V.length,X=C(de,v);V=[...V,...X]}if(V.length<3){const v=3-V.length,X=new Set(V.map(x=>x.id||x.title)),he=ce.filter(x=>!X.has(x.id)&&!X.has(x.title)),L=C(he,v).map(x=>({id:x.id,title:x.title,cover_art:x.cover_art||x.artwork,artist:x.artist,type:"track"}));V=[...V,...L]}z.value=V.slice(0,6);const ve=(a.artists||[]).map(v=>({...v,slug:v.slug||v.id||(v.name||"").toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")}));j.value=C(ve,6),N(),I(),window.addEventListener("recentlyPlayed:updated",v=>{v.detail&&v.detail.recent&&(E.value=v.detail.recent.slice(0,6))}),window.addEventListener("bookmarks:changed",I)}catch(y){console.error("Error loading explore widgets",y)}finally{m.value=!1}}),Ne(()=>{window.removeEventListener("recentlyPlayed:updated",N),window.removeEventListener("bookmarks:changed",I)}),(y,n)=>{const T=Le("router-link");return m.value?H("",!0):(u(),g("section",Xe,[e("div",Je,[n[1]||(n[1]=e("div",{class:"widget-header"},[e("div",{class:"header-icon"},[e("i",{class:"fas fa-history"})]),e("div",{class:"header-text"},[e("h3",null,"Recently Played"),e("p",null,"Jump back in")])],-1)),e("div",Ue,[E.value.length===0?(u(),g("div",He," No history yet ")):(u(!0),g(D,{key:1},P(E.value,a=>W((u(),se(T,{key:a.key||a.id,to:`/${a.type==="show"?"shows":"music"}/${a.id}`,class:"widget-card",onMouseenter:w(Z),onClick:w(p)},{default:A(()=>[e("div",Ke,[e("img",{src:a.artwork||a.cover_art||"/static/img/default-cover.jpg",alt:a.title,loading:"lazy"},null,8,et),n[0]||(n[0]=e("div",{class:"play-icon"},[e("i",{class:"fas fa-play"})],-1))]),e("div",tt,f(a.title),1)]),_:2},1032,["to","onMouseenter","onClick"])),[[w(ae),{target:".card-image img",scale:1.1,speed:600,max:10}]])),128))]),n[2]||(n[2]=e("div",{class:"widget-cta cta-indigo",style:{cursor:"default"}}," Your History ",-1))]),e("div",st,[n[4]||(n[4]=e("div",{class:"widget-header"},[e("div",{class:"header-icon"},[e("i",{class:"fas fa-bookmark"})]),e("div",{class:"header-text"},[e("h3",null,"My Saves"),e("p",null,"Your Favorites")])],-1)),e("div",at,[S.value.length===0?(u(),g("div",lt," Nothing### Video Widget Unification - Verified that Videos now appear square (1:1), matching the Podcasts and Music sections. - Verified that the grid items align perfectly across different widgets. ### Backend API Test ")):(u(!0),g(D,{key:1},P(S.value,a=>W((u(),se(T,{key:a.id||a.slug,to:a.type==="artist"?`/artists/${a.slug}`:`/${a.type==="show"?"shows":"music"}/${a.id}`,class:"widget-card",onMouseenter:w(Z),onClick:w(p)},{default:A(()=>[e("div",nt,[e("img",{src:a.cover_art||"/static/img/default-cover.jpg",alt:a.title,loading:"lazy"},null,8,it)]),e("div",ot,f(a.title||a.name),1)]),_:2},1032,["to","onMouseenter","onClick"])),[[w(ae),{target:".card-image img",scale:1.1,speed:600,max:10}]])),128))]),K(T,{to:"/profile",class:"widget-cta cta-gold",onClick:w(p)},{default:A(()=>[...n[3]||(n[3]=[O(" View All Saves ",-1)])]),_:1},8,["onClick"])]),e("div",rt,[n[7]||(n[7]=e("div",{class:"widget-header"},[e("div",{class:"header-icon"},[e("i",{class:"fas fa-video"})]),e("div",{class:"header-text"},[e("h3",null,"Videos"),e("p",null,"Watch latest content")])],-1)),e("div",ct,[(u(!0),g(D,null,P(_.value,a=>W((u(),se(T,{key:a.id,to:`/videos?play=${a.id}`,class:"widget-card video-card",onMouseenter:w(Z),onClick:w(p)},{default:A(()=>[e("div",dt,[e("img",{src:a.thumbnail||"/static/img/default-cover.jpg",alt:a.title,loading:"lazy"},null,8,ut),n[5]||(n[5]=e("div",{class:"play-icon"},[e("i",{class:"fas fa-play"})],-1))]),e("div",vt,f(a.title),1)]),_:2},1032,["to","onMouseenter","onClick"])),[[w(ae),{target:".card-image img",scale:1.1,speed:600,max:10}]])),128))]),K(T,{to:"/videos",class:"widget-cta cta-red",onClick:w(p)},{default:A(()=>[...n[6]||(n[6]=[O(" Watch Now ",-1)])]),_:1},8,["onClick"])]),e("div",ht,[n[9]||(n[9]=e("div",{class:"widget-header"},[e("div",{class:"header-icon"},[e("i",{class:"fas fa-podcast"})]),e("div",{class:"header-text"},[e("h3",null,"Podcasts"),e("p",null,"Fresh episodes & shows")])],-1)),e("div",pt,[(u(!0),g(D,null,P(i.value,a=>W((u(),se(T,{key:a.slug,to:`/podcasts/${a.slug}`,class:"widget-card",onMouseenter:w(Z),onClick:w(p)},{default:A(()=>[e("div",mt,[e("img",{src:a.artwork||"/static/img/default-cover.jpg",alt:a.title,loading:"lazy"},null,8,ft)]),e("div",gt,f(a.title),1)]),_:2},1032,["to","onMouseenter","onClick"])),[[w(ae),{target:".card-image img",scale:1.1,speed:600,max:10}]])),128))]),K(T,{to:"/podcasts",class:"widget-cta cta-purple",onClick:w(p)},{default:A(()=>[...n[8]||(n[8]=[O(" Explore Podcasts ",-1)])]),_:1},8,["onClick"])]),e("div",wt,[n[11]||(n[11]=e("div",{class:"widget-header"},[e("div",{class:"header-icon"},[e("i",{class:"fas fa-music"})]),e("div",{class:"header-text"},[e("h3",null,"Music"),e("p",null,"Albums & Singles")])],-1)),e("div",yt,[(u(!0),g(D,null,P(z.value,a=>W((u(),se(T,{key:a.id||a.title,to:a.type==="album"?{path:"/music",query:{q:a.title}}:`/music/${a.id}`,class:"widget-card",onMouseenter:w(Z),onClick:w(p)},{default:A(()=>[e("div",kt,[e("img",{src:a.cover_art||"/static/img/default-cover.jpg",alt:a.title,loading:"lazy"},null,8,bt)]),e("div",_t,f(a.title),1)]),_:2},1032,["to","onMouseenter","onClick"])),[[w(ae),{target:".card-image img",scale:1.1,speed:600,max:10}]])),128))]),K(T,{to:"/music",class:"widget-cta cta-blue",onClick:w(p)},{default:A(()=>[...n[10]||(n[10]=[O(" Music Library ",-1)])]),_:1},8,["onClick"])]),e("div",Ct,[n[13]||(n[13]=e("div",{class:"widget-header"},[e("div",{class:"header-icon"},[e("i",{class:"fas fa-users"})]),e("div",{class:"header-text"},[e("h3",null,"Artists"),e("p",null,"Meet the creators")])],-1)),e("div",xt,[(u(!0),g(D,null,P(j.value,a=>W((u(),se(T,{key:a.slug,to:`/artists/${a.slug}`,class:"widget-card artist-card-shape",onMouseenter:w(Z),onClick:w(p)},{default:A(()=>[e("div",$t,[e("img",{src:a.image||"/static/img/default-avatar.png",alt:a.name,loading:"lazy"},null,8,Mt)]),e("div",Tt,f(a.name),1)]),_:2},1032,["to","onMouseenter","onClick"])),[[w(ae),{target:".card-image img",scale:1.1,speed:600,max:10}]])),128))]),K(T,{to:"/artists",class:"widget-cta cta-green",onClick:w(p)},{default:A(()=>[...n[12]||(n[12]=[O(" Discover Artists ",-1)])]),_:1},8,["onClick"])])]))}}},Vt=De(St,[["__scopeId","data-v-b328dadb"]]),Nt={class:"home-page"},Lt={class:"podcasts-hero"},At={key:0,class:"search-results-container"},Zt={class:"search-results-header"},Rt={class:"results-count"},Yt={class:"search-actions"},jt=["title"],Et={class:"search-results-list"},It=["href","onClick"],Dt={class:"result-image"},Pt=["src","alt"],Wt={class:"result-type-badge"},qt={class:"result-info"},Ot={class:"result-title"},zt={class:"result-subtitle"},Bt={class:"live-dashboard"},Ft={class:"dashboard-grid"},Qt={class:"dash-preview"},Gt=["src"],Xt={class:"dash-overlay"},Jt={class:"dash-badges"},Ut={class:"channel-badge"},Ht={key:0,class:"channel-nav"},Kt={class:"dash-content"},es={class:"dash-actions"},ts={class:"dashboard-sidebar"},ss={class:"dash-thumb"},as=["src"],ls={class:"dash-info"},ns={class:"radio-next-list"},is={class:"track-title"},os={class:"track-artist"},rs={key:0,class:"tv-channel-strip"},cs={class:"tv-channel-strip-list"},ds=["onClick"],us={class:"tv-channel-strip-meta"},vs={class:"tv-channel-strip-name"},hs={class:"tv-channel-strip-now"},ps={key:0,class:"tv-channel-strip-next"},ms={class:"whats-new-section"},fs={class:"whats-new-container"},gs={class:"whats-new-header"},ws={key:0,href:"/whats-new",class:"view-all-link"},ys={class:"whats-new-loading"},ks={class:"whats-new-updates"},bs=["href"],_s={class:"whats-new-content"},Cs={class:"whats-new-date"},xs={class:"whats-new-empty"},Ms={__name:"HomeView",setup(r){const m=Be(),i=We(),_=["https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExeGlreWRqaHZxc295NHNvZWs4MWJoeTIwdXk1NnNuN2syOTE4Z3JleSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/14hS1ZEmSfKdTW/giphy.gif","https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExdnI2M2VxZmhkeTM1bHVoZmV0NmdmYzVjeWt3eHc1eGZtOWk4N3c0YyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/AS9LIFttYzkc0/giphy.gif","https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExYjB3cjhjNXEwMXhrcTFvYnF4Zm5xamduNm8ycjB4ZnJneDhyb2IzNiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/wSYE7n6pk9dqRXzitR/giphy.gif","https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExMWVkeG1sY3hvYTlwMjl0bWZrbTI3bXlqOGQ2cmYyZXVmZ2RuZWIwcCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/xWC0BCZtkDxE869erD/giphy.gif","https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExdjJ4Mml1ajMzNGh1ODVrN3J3cnVtbjZkeXZnN29wNmQ2aHhncTJ0OCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/l1J9BYe5eZccC4Nck/giphy.gif","https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExOWZnNnhxbjgzM3B1NXdzOWJwZjJnM3hveTJwNnE1bjZrb3ZicXU3bSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3oGRFs7yHPDlB8JYsg/giphy.gif"],z=h(""),j=h(!1),S=h(50),E=h(50);function le(s){if(!j.value)return;const t=s.currentTarget.getBoundingClientRect(),c=s.clientX-t.left,o=s.clientY-t.top,$=c/t.width*100,d=o/t.height*100;S.value=40+$/100*20,E.value=40+d/100*20}function Z(){j.value=!1,S.value=50,E.value=50}const p=h(""),C=h([]),N=h(!1),I=h(!1),y=h(null);let n={tracks:[],albums:[],shows:[],podcasts:[],artists:[]};const T=Se(()=>N.value?C.value:C.value.slice(0,6));async function a(){try{const[s,t,c,o]=await Promise.all([Y("/api/music").catch(()=>({tracks:[],albums:[]})),Y("/api/shows").catch(()=>({shows:[]})),Y("/api/podcasts").catch(()=>({shows:[]})),Y("/api/artists").catch(()=>({artists:[]}))]);n.tracks=(s.tracks||[]).map(d=>({...d,type:"track"}));const $=new Map;for(const d of s.tracks||[])d.album&&d.album!=="Single"&&!$.has(d.album)&&$.set(d.album,{id:d.album,title:d.album,name:d.album,artist:d.artist,cover_art:d.cover_art||d.artwork,type:"album"});n.albums=Array.from($.values()),n.shows=(t.shows||[]).map(d=>({...d,type:"video"})),n.podcasts=(c.shows||[]).map(d=>({...d,type:"podcast"})),n.artists=(o.artists||[]).map(d=>({...d,type:"artist"}))}catch(s){console.error("Error loading searchable data",s)}}function ce(s){var o,$,d,M,R,ie,oe,re,l,Q,ke,Me;if(!s||s.trim().length<2){C.value=[],I.value=!1;return}I.value=!0;const t=s.toLowerCase().trim(),c=[];for(const b of n.tracks)((o=b.title)!=null&&o.toLowerCase().includes(t)||($=b.artist)!=null&&$.toLowerCase().includes(t)||(d=b.album)!=null&&d.toLowerCase().includes(t))&&c.push(b);for(const b of n.albums)((M=b.title)!=null&&M.toLowerCase().includes(t)||(R=b.artist)!=null&&R.toLowerCase().includes(t))&&c.push(b);for(const b of n.shows)((ie=b.title)!=null&&ie.toLowerCase().includes(t)||(oe=b.artist)!=null&&oe.toLowerCase().includes(t)||(re=b.host)!=null&&re.toLowerCase().includes(t))&&c.push(b);for(const b of n.podcasts)((l=b.title)!=null&&l.toLowerCase().includes(t)||(Q=b.host)!=null&&Q.toLowerCase().includes(t)||(ke=b.description)!=null&&ke.toLowerCase().includes(t))&&c.push(b);for(const b of n.artists)(Me=b.name)!=null&&Me.toLowerCase().includes(t)&&c.push(b);C.value=c.slice(0,50)}function ne(){y.value&&clearTimeout(y.value),y.value=setTimeout(()=>{ce(p.value)},300)}function de(){p.value.trim()&&m.push({path:"/search",query:{q:p.value}})}function V(){p.value="",C.value=[],N.value=!1,I.value=!1}function ve(){p.value.trim()&&(m.push({path:"/search",query:{q:p.value}}),V())}function v(){if(p.value.trim())try{const s=JSON.parse(localStorage.getItem("ahoy.savedSearches")||"[]"),t={query:p.value,timestamp:new Date().toISOString(),resultsCount:C.value.length};s.find(o=>o.query===p.value)||(s.unshift(t),localStorage.setItem("ahoy.savedSearches",JSON.stringify(s.slice(0,20))),alert(`Search saved: "${p.value}"`))}catch(s){console.error("Failed to save search",s)}}function X(s){switch(s.type){case"track":return`/music/${s.id}`;case"album":return`/music?q=${encodeURIComponent(s.title)}`;case"video":return`/videos?play=${s.id}`;case"podcast":return`/podcasts/${s.slug||s.id}`;case"artist":return`/artists/${s.slug||s.id}`;default:return"#"}}function he(s){m.push(X(s)),V()}const L=h([]),x=h(0),k=h(null),B=h(null),ue=h({}),pe=h({});let me=null;const Ze={misc:"Channel 01 — Misc",films:"Channel 02 — Short Films","music-videos":"Channel 03 — Music Videos","live-shows":"Channel 04 — Live Shows"};function Ce(s,t){return Ze[s.id]||`Channel ${String(t+1).padStart(2,"0")} — ${s.name||"Unknown"}`}function xe(){var o,$;const s=new Date().getHours(),t={},c={};for(let d=0;d<L.value.length;d++){const M=L.value[d];if((o=M==null?void 0:M.items)!=null&&o.length){const R=s%M.items.length;t[M.id]=M.items[R],c[M.id]=M.items.length>R+1?M.items[R+1]:M.items[0]}}if(ue.value=t,pe.value=c,($=B.value)!=null&&$.id){const d=B.value.id;t[d]&&(k.value=t[d])}}function fe(s){var c;if(!L.value.length)return;x.value=(s+L.value.length)%L.value.length;const t=L.value[x.value];B.value={...t,name:Ce(t,x.value)},ue.value[t.id]?k.value=ue.value[t.id]:(c=t.items)!=null&&c.length?k.value=t.items[0]:k.value={id:"placeholder",title:"No content available",thumbnail:"/static/img/default-cover.jpg",host:t.name}}function $e(s){L.value.length&&fe(x.value+(s==="next"?1:-1))}function ge(s){!(s!=null&&s.id)||s.id==="placeholder"||s.id==="error"||m.push({path:"/videos",query:{play:s.id}})}const J=h([]),we=h([]),ee=h([]),q=h(null),ye=Se(()=>{if(!q.value||!i.currentTrack)return!1;const s=String(q.value.id??""),t=String(i.currentTrack.id??"");return s===t&&i.isPlaying});function Re(){const s=[...J.value];s.sort(()=>.5-Math.random()),we.value=s.map(t=>({...t,type:"track"})),ee.value=we.value.slice(0,20)}function Ye(){if(ye.value){i.pause();return}if(q.value){i.resume();return}const s=we.value[0]||ee.value[0];s&&(q.value=s,i.setQueue(J.value,J.value.findIndex(t=>t.id===s.id)))}const F=h([]),te=h(!0);function je(s){if(!s)return"";try{return new Date(s).toLocaleDateString(void 0,{year:"numeric",month:"short"})}catch{return s}}function Ee(s){if(s.year&&s.month&&s.section){const t=`/whats-new/${s.year}/${s.month}/${s.section}`;return s.slug?`${t}#update-${s.slug}`:t}return s.link?s.link:"/whats-new"}function Ie(s){var c;const t=(s==null?void 0:s.channels)??((c=s==null?void 0:s.data)==null?void 0:c.channels)??[];return Array.isArray(t)?t.map(o=>({...o,id:(o==null?void 0:o.id)??"misc",name:(o==null?void 0:o.name)??"Channel",items:Array.isArray(o==null?void 0:o.items)?o.items:[]})):[]}return Ve(async()=>{z.value=_[Math.floor(Math.random()*_.length)],a();try{let s=null;try{s=await(await fetch("/api/live-tv/channels?_="+Date.now())).json()}catch{s=await Y("/api/live-tv/channels").catch(()=>null)}const t=s?Ie(s):[];if(L.value=t,t.length){const c=t.find(o=>o.id==="misc")||t[0];x.value=t.findIndex(o=>o.id===c.id),xe(),fe(x.value)}else k.value={id:"placeholder",title:"Loading Live TV...",thumbnail:"/static/img/default-cover.jpg",host:"Ahoy TV"},B.value={id:"misc",name:"Channel 01 — Misc"};me=setInterval(xe,60*1e3)}catch{k.value={id:"error",title:"Live TV",thumbnail:"/static/img/default-cover.jpg",host:"Ahoy TV"},B.value={id:"misc",name:"Channel 01 — Misc"}}try{const t=((await Y("/api/music").catch(()=>({tracks:[]}))).tracks||[]).filter(o=>o.audio_url||o.preview_url),c=new Set;J.value=t.filter(o=>c.has(o.id)?!1:(c.add(o.id),!0)),Re()}catch{}i.currentTrack&&J.value.length&&J.value.some(t=>{var c;return String(t.id)===String((c=i.currentTrack)==null?void 0:c.id)})&&(q.value=i.currentTrack),te.value=!0;try{const t=(await Y("/api/whats-new").catch(()=>({updates:[]}))).updates;if(Array.isArray(t))F.value=t.slice(0,4);else if(t&&typeof t=="object"){const c=[];for(const o of Object.keys(t).sort().reverse())for(const $ of Object.keys(t[o]||{}).sort().reverse())for(const d of Object.keys(t[o][$]||{})){const M=(t[o][$][d].items||[]).map(R=>({...R,year:o,month:$,section:d}));c.push(...M)}F.value=c.slice(0,4)}else F.value=[]}catch{F.value=[]}finally{te.value=!1}}),Ne(()=>{me&&clearInterval(me)}),qe(()=>i.currentTrack,s=>{if(!s)return;J.value.some(c=>String(c.id)===String(s.id))&&(q.value=s)},{deep:!0}),(s,t)=>{var o,$,d,M,R,ie,oe,re;const c=Le("router-link");return u(),g("div",Nt,[e("section",Lt,[e("div",{class:"podcasts-hero-inner",style:Oe({backgroundImage:`url(${z.value})`,backgroundPosition:`${S.value}% ${E.value}%`}),onMouseenter:t[2]||(t[2]=l=>j.value=!0),onMouseleave:Z,onMousemove:le},[t[13]||(t[13]=e("h1",null,[e("i",{class:"fas fa-home","aria-hidden":"true"}),O(" Home")],-1)),t[14]||(t[14]=e("p",null,"Explore",-1)),e("div",{class:U(["hero-search-wrapper",{"has-results":I.value&&C.value.length>0,expanded:N.value}])},[W(e("input",{type:"text",class:"hero-search-input",placeholder:"Search artists, tracks, or shows...","onUpdate:modelValue":t[0]||(t[0]=l=>p.value=l),onInput:ne,onKeydown:Te(de,["enter"])},null,544),[[ze,p.value]]),I.value&&C.value.length>0?(u(),g("div",At,[e("div",Zt,[e("span",Rt,f(C.value.length)+" "+f(C.value.length===1?"result":"results"),1),e("div",Yt,[e("button",{type:"button",class:U(["search-action-btn",{active:N.value}]),onClick:t[1]||(t[1]=l=>N.value=!N.value),title:N.value?"Collapse":"Expand"},[e("i",{class:U(N.value?"fas fa-compress-alt":"fas fa-expand-alt")},null,2)],10,jt),e("button",{type:"button",class:"search-action-btn",onClick:ve,title:"Open in Search Page"},[...t[9]||(t[9]=[e("i",{class:"fas fa-external-link-alt"},null,-1)])]),e("button",{type:"button",class:"search-action-btn",onClick:v,title:"Save Search"},[...t[10]||(t[10]=[e("i",{class:"fas fa-bookmark"},null,-1)])]),e("button",{type:"button",class:"search-action-btn close-btn",onClick:V,title:"Clear"},[...t[11]||(t[11]=[e("i",{class:"fas fa-times"},null,-1)])])])]),e("div",Et,[(u(!0),g(D,null,P(T.value,l=>(u(),g("a",{key:l.id,href:X(l),class:"search-result-item",onClick:G(Q=>he(l),["prevent"])},[e("div",Dt,[e("img",{src:l.image||l.cover_art||l.artwork||l.thumbnail||"/static/img/default-cover.jpg",alt:l.title||l.name,loading:"lazy"},null,8,Pt),e("div",Wt,f(l.type),1)]),e("div",qt,[e("div",Ot,f(l.title||l.name),1),e("div",zt,f(l.artist||l.host||l.description||""),1)]),t[12]||(t[12]=e("div",{class:"result-arrow"},[e("i",{class:"fas fa-chevron-right"})],-1))],8,It))),128))])])):H("",!0)],2)],36)]),e("section",Bt,[e("div",Ft,[e("div",{class:"dashboard-main",role:"button",tabindex:"0",onClick:t[7]||(t[7]=l=>k.value&&k.value.id!=="placeholder"&&k.value.id!=="error"?ge(k.value):null),onKeydown:t[8]||(t[8]=Te(G(l=>k.value&&k.value.id!=="placeholder"&&k.value.id!=="error"?ge(k.value):null,["prevent"]),["enter"]))},[e("div",Qt,[e("img",{src:((o=k.value)==null?void 0:o.thumbnail)||"/static/img/default-cover.jpg",alt:"Live TV",class:"dash-bg"},null,8,Gt),e("div",Xt,[e("div",Jt,[t[15]||(t[15]=e("span",{class:"live-badge"},"LIVE TV",-1)),e("span",Ut,f((($=B.value)==null?void 0:$.name)||"Channel 01 — Misc"),1)]),L.value.length>1?(u(),g("div",Ht,[e("button",{type:"button",class:"channel-nav-btn","aria-label":"Previous channel",onClick:t[3]||(t[3]=G(l=>$e("prev"),["stop"]))},[...t[16]||(t[16]=[e("i",{class:"fas fa-chevron-left"},null,-1)])]),e("button",{type:"button",class:"channel-nav-btn","aria-label":"Next channel",onClick:t[4]||(t[4]=G(l=>$e("next"),["stop"]))},[...t[17]||(t[17]=[e("i",{class:"fas fa-chevron-right"},null,-1)])])])):H("",!0),e("div",Kt,[e("h2",null,f(((d=k.value)==null?void 0:d.title)||"Loading..."),1),e("p",null,f(((M=k.value)==null?void 0:M.artist)||((R=k.value)==null?void 0:R.host)||""),1),e("div",es,[k.value&&k.value.id!=="placeholder"&&k.value.id!=="error"?(u(),g("button",{key:0,type:"button",class:"dash-play-btn",onClick:t[5]||(t[5]=G(l=>ge(k.value),["stop"]))},[...t[18]||(t[18]=[e("i",{class:"fas fa-play"},null,-1),O(" Watch Now ",-1)])])):H("",!0),K(c,{to:"/live-tv",class:"dash-guide-btn",onClick:t[6]||(t[6]=G(()=>{},["stop"]))},{default:A(()=>[...t[19]||(t[19]=[e("i",{class:"fas fa-tv"},null,-1),O(" View All Channels ",-1)])]),_:1})])])])])],32),e("div",ts,[t[23]||(t[23]=e("div",{class:"sidebar-header"},[e("h3",null,"Live Radio")],-1)),e("div",{class:U(["dash-item radio-item",{active:ye.value}])},[e("div",ss,[e("img",{src:((ie=q.value||ee.value[0])==null?void 0:ie.cover_art)||"https://ahoy.ooo/images/Ahoy-Indie-Media-DEFAULT-COVER-A-8.jpg",alt:"Radio"},null,8,as),t[20]||(t[20]=e("div",{class:"dash-icon"},[e("i",{class:"fas fa-broadcast-tower"})],-1))]),e("div",ls,[t[21]||(t[21]=e("div",{class:"dash-label"},"On Air Now",-1)),e("h4",null,f(((oe=q.value||ee.value[0])==null?void 0:oe.title)||"Loading..."),1),e("p",null,f(((re=q.value||ee.value[0])==null?void 0:re.artist)||""),1)]),e("button",{type:"button",class:"dash-action-btn","aria-label":"Play/Pause radio",onClick:G(Ye,["stop"])},[e("i",{class:U(ye.value?"fas fa-pause":"fas fa-play")},null,2)])],2),e("div",ns,[t[22]||(t[22]=e("div",{class:"list-label"},"Up Next",-1)),(u(!0),g(D,null,P(ee.value.slice(0,3),l=>(u(),g("div",{key:l.id,class:"mini-track"},[e("span",is,f(l.title),1),e("span",os,f(l.artist),1)]))),128))])])]),L.value.length>1?(u(),g("div",rs,[t[25]||(t[25]=e("div",{class:"tv-channel-strip-header"},[e("div",{class:"tv-channel-strip-title"},"Live TV Channels"),e("div",{class:"tv-channel-strip-subtitle"},"Tap a channel to switch")],-1)),e("div",cs,[(u(!0),g(D,null,P(L.value,(l,Q)=>(u(),g("button",{key:l.id,type:"button",class:U(["tv-channel-strip-item",{active:B.value&&B.value.id===l.id}]),onClick:G(ke=>fe(Q),["stop"])},[e("div",us,[e("span",vs,f(Ce(l,Q)),1),t[24]||(t[24]=e("span",{class:"tv-channel-strip-live"},"LIVE",-1))]),e("div",hs,f((ue.value[l.id]||{}).title||"No content available"),1),pe.value[l.id]?(u(),g("div",ps," Up next: "+f((pe.value[l.id]||{}).title||""),1)):H("",!0)],10,ds))),128))])])):H("",!0)]),K(Vt),e("section",ms,[e("div",fs,[e("div",gs,[t[27]||(t[27]=e("h2",null,"What's New at Ahoy",-1)),!te.value&&F.value.length>0?(u(),g("a",ws,[...t[26]||(t[26]=[O(" View All ",-1),e("i",{class:"fas fa-arrow-right"},null,-1)])])):H("",!0)]),W(e("div",ys,[...t[28]||(t[28]=[e("span",null,"Loading updates...",-1)])],512),[[be,te.value]]),W(e("div",ks,[(u(!0),g(D,null,P(F.value,(l,Q)=>(u(),g("a",{key:l.id||l.title||Q,href:Ee(l),class:U(["whats-new-item clickable","type-"+(l.type||"update")])},[e("div",_s,[e("h3",null,f(l.title),1),e("p",null,f(l.description),1),e("span",Cs,f(je(l.date,l.type)),1)]),t[29]||(t[29]=e("div",{class:"whats-new-arrow"},[e("i",{class:"fas fa-chevron-right"})],-1))],10,bs))),128))],512),[[be,!te.value&&F.value.length>0]]),W(e("div",xs,[...t[30]||(t[30]=[e("p",null,"No updates available at this time.",-1),e("a",{href:"/whats-new",class:"view-archive-link"},"View Archive",-1)])],512),[[be,!te.value&&F.value.length===0]])])])])}}};export{Ms as default};
