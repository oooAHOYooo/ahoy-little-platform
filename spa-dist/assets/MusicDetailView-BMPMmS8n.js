import{n as D,u as F,o as j,a as z,c as l,d as c,e as s,t as n,l as f,s as u,k as p,g as d,F as H,f as I,G as Q,m as S,H as R,A as T,I as E,J as G,K as J,y as P}from"./index-DcQ9GdWE.js";const K={class:"music-detail-view"},L={key:0,class:"music-container"},q={class:"podcast-show-hero"},O=["src","alt"],U={class:"podcast-show-hero-meta"},W={class:"podcast-show-hero-title"},X={key:0,class:"podcast-show-hero-desc"},Y={key:1,class:"episode-subtitle"},Z={class:"podcast-show-hero-actions"},ss={key:0,class:"podcasts-section"},ts={class:"podcasts-section-header"},as={class:"episode-list"},es=["onClick"],os=["src","alt"],is={class:"episode-meta"},ls={class:"episode-title"},cs={class:"episode-show"},ns={class:"episode-actions"},rs=["onClick"],ds=["onClick"],us={key:1,class:"music-container"},hs={__name:"MusicDetailView",setup(ps){const x=R(),i=D(),v=F(),{shareTrack:B}=J(),_=E(),A=G();function m(e){A.open(e)}const t=S(null),r=S([]),h=T(()=>t.value?r.value.filter(e=>e.artist===t.value.artist&&e.id!==t.value.id):[]),k=T(()=>{var e,a;return((e=i.currentTrack)==null?void 0:e.id)===((a=t.value)==null?void 0:a.id)&&i.isPlaying});function M(e){if(!e)return"";const a=Math.floor(e/60),o=Math.floor(e%60);return`${a}:${o.toString().padStart(2,"0")}`}function $(){k.value?i.pause():(i.play(t.value),i.setQueue(r.value,r.value.findIndex(e=>e.id===t.value.id)))}function V(){_.onBookmark(),v.toggle({...t.value,_type:"track"})}function N(){_.light(),B(t.value)}function y(e){i.setQueue(h.value,e)}return j(async()=>{const e=await z("/api/music").catch(()=>({tracks:[]}));r.value=e.tracks||[];const a=x.params.id;t.value=r.value.find(o=>String(o.id)===String(a))||null}),(e,a)=>(l(),c("div",K,[t.value?(l(),c("div",L,[s("section",q,[s("img",{class:"podcast-show-hero-art",src:t.value.cover_art||"/static/img/default-cover.jpg",alt:t.value.title},null,8,O),s("div",U,[a[3]||(a[3]=s("div",{class:"podcast-show-hero-kicker"},"Track",-1)),s("h1",W,n(t.value.title),1),t.value.artist?(l(),c("p",X,n(t.value.artist),1)):f("",!0),t.value.duration_seconds?(l(),c("p",Y,n(M(t.value.duration_seconds)),1)):f("",!0),s("div",Z,[s("button",{class:"podcast-cta",onClick:$},[s("i",{class:u(k.value?"fas fa-pause":"fas fa-play")},null,2),p(" "+n(k.value?"Pause":"Play"),1)]),s("button",{class:"podcast-cta secondary",onClick:V},[s("i",{class:u(d(v).isBookmarked(t.value)?"fas fa-bookmark":"far fa-bookmark")},null,2),p(" "+n(d(v).isBookmarked(t.value)?"Saved":"Save"),1)]),s("button",{class:"podcast-cta secondary",onClick:a[0]||(a[0]=o=>m(t.value))},[...a[1]||(a[1]=[s("i",{class:"fas fa-plus"},null,-1),p(" Add to playlist ",-1)])]),s("button",{class:"podcast-cta secondary",onClick:N},[...a[2]||(a[2]=[s("i",{class:"fas fa-share-alt"},null,-1),p(" Share ",-1)])])])])]),h.value.length?(l(),c("section",ss,[s("div",ts,[s("h2",null,"More from "+n(t.value.artist),1)]),s("div",as,[(l(!0),c(H,null,I(h.value,(o,g)=>{var w,b;return l(),c("article",{key:o.id,class:u(["episode-row",{playing:((w=d(i).currentTrack)==null?void 0:w.id)===o.id}]),onClick:C=>y(g)},[s("img",{class:"episode-art",src:o.cover_art||"/static/img/default-cover.jpg",alt:o.title,loading:"lazy"},null,8,os),s("div",is,[s("div",ls,n(o.title),1),s("div",cs,n(o.artist),1)]),s("div",ns,[s("button",{class:"episode-btn",title:"Add to playlist",onClick:P(C=>m(o),["stop"])},[...a[4]||(a[4]=[s("i",{class:"fas fa-plus"},null,-1)])],8,rs),s("button",{class:"episode-btn",onClick:P(C=>y(g),["stop"])},[s("i",{class:u(((b=d(i).currentTrack)==null?void 0:b.id)===o.id&&d(i).isPlaying?"fas fa-pause":"fas fa-play")},null,2)],8,ds)])],10,es)}),128))])])):f("",!0)])):(l(),c("div",us,[...a[5]||(a[5]=[Q('<section class="podcast-show-hero"><div class="podcast-show-hero-art skeleton" style="aspect-ratio:1;width:100%;"></div><div class="podcast-show-hero-meta"><div class="skeleton" style="height:14px;width:40%;margin-bottom:8px;"></div><div class="skeleton" style="height:24px;width:70%;margin-bottom:8px;"></div><div class="skeleton" style="height:14px;width:50%;"></div></div></section>',1)])]))]))}};export{hs as default};
