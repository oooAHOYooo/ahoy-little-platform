import{_ as C,o as S,G as _,c as n,d as l,e as s,B as i,t as p,f as o,j as u,k as c,L as B,m as k,p as E,s as L}from"./index-BHVn4BJX.js";const x={class:"account-page"},A={key:0,class:"account-card"},V={class:"account-profile"},F={class:"account-name"},I={class:"account-email"},N={class:"account-section"},T={class:"wallet-balance"},j={class:"wallet-amount"},O={class:"account-wallet-actions"},D=["disabled"],G={key:0,class:"fas fa-spinner fa-spin"},J={key:1,class:"fas fa-wallet"},M={class:"account-section"},P={key:1,class:"account-guest"},R={__name:"AccountView",setup(U){const v=L(),a=B(),f=k(null),d=k(!1);S(async()=>{if(a.isLoggedIn.value)try{const r=await _("/payments/wallet");f.value=r.balance??0}catch{f.value=0}});async function b(){if(!a.isLoggedIn.value){v.push("/login");return}const r=10;d.value=!0;try{const t=await _("/payments/wallet/fund",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:r})});if(t.checkout_url){window.location.href=t.checkout_url;return}window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:t.error||"Could not start checkout",type:"error"}}))}catch(t){window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:t.message||"Failed to add funds",type:"error"}}))}finally{d.value=!1}}async function h(){await a.logout(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Signed out",type:"success"}})),v.push("/")}return(r,t)=>{var m,y,w,g;const e=E("router-link");return n(),l("div",x,[t[13]||(t[13]=s("div",{class:"unified-header"},[s("div",{class:"header-content"},[s("h1",null,"Account")])],-1)),i(a).isLoggedIn.value?(n(),l("div",A,[s("div",V,[t[0]||(t[0]=s("div",{class:"account-avatar"},[s("i",{class:"fas fa-user-circle"})],-1)),s("div",F,p(((m=i(a).user.value)==null?void 0:m.display_name)||((y=i(a).user.value)==null?void 0:y.username)||((w=i(a).user.value)==null?void 0:w.email)),1),s("div",I,p((g=i(a).user.value)==null?void 0:g.email),1)]),s("section",N,[t[4]||(t[4]=s("h2",{class:"account-section-title"},"Wallet",-1)),s("div",T,[t[1]||(t[1]=s("span",{class:"wallet-label"},"Balance",-1)),s("span",j,"$"+p((f.value??0).toFixed(2)),1)]),t[5]||(t[5]=s("p",{class:"wallet-note"},"Use your wallet for boosts and merch checkout.",-1)),s("div",O,[s("button",{type:"button",class:"account-btn primary",disabled:d.value,onClick:b},[d.value?(n(),l("i",G)):(n(),l("i",J)),t[2]||(t[2]=o(" Add funds ",-1))],8,D),u(e,{to:"/wallet",class:"account-btn secondary"},{default:c(()=>[...t[3]||(t[3]=[o("Transaction history",-1)])]),_:1})])]),s("section",M,[t[9]||(t[9]=s("h2",{class:"account-section-title"},"Links",-1)),u(e,{to:"/tip-artist",class:"account-link"},{default:c(()=>[...t[6]||(t[6]=[s("i",{class:"fas fa-heart"},null,-1),o(" Boost artists ",-1)])]),_:1}),u(e,{to:"/my-saves",class:"account-link"},{default:c(()=>[...t[7]||(t[7]=[s("i",{class:"fas fa-bookmark"},null,-1),o(" Saved ",-1)])]),_:1}),u(e,{to:"/settings",class:"account-link"},{default:c(()=>[...t[8]||(t[8]=[s("i",{class:"fas fa-cog"},null,-1),o(" Settings ",-1)])]),_:1})]),s("button",{type:"button",class:"account-btn logout",onClick:h},[...t[10]||(t[10]=[s("i",{class:"fas fa-sign-out-alt"},null,-1),o(" Sign out ",-1)])])])):(n(),l("div",P,[t[12]||(t[12]=s("p",null,"Sign in to see your account, wallet, and saved items.",-1)),u(e,{to:"/login",class:"account-btn primary"},{default:c(()=>[...t[11]||(t[11]=[o("Sign in",-1)])]),_:1})]))])}}},$=C(R,[["__scopeId","data-v-57d93d4d"]]);export{$ as default};
