import{u as Q,z,o as E,a as F,c as i,d as l,e as t,f as $,n as p,F as v,r as h,l as D,A as I,i as k,m,q as b,s as U,p as O,t as c,j as T,k as x,B as u,h as y}from"./index-BHVn4BJX.js";const L={class:"podcasts-page"},R={class:"podcasts-section podcasts-featured-section"},G={class:"podcasts-section-header podcasts-featured-header"},H={class:"podcast-filter-chips"},J=["onClick"],K={class:"podcast-shows-dropdown-mobile"},W=["value"],X={class:"podcast-shows podcast-shows-preview podcast-shows-desktop"},Y=["onClick"],Z=["src","alt"],ss={class:"podcast-show-title"},ts={key:0,class:"podcast-show-desc"},es={key:1,class:"podcast-show-updated"},os={class:"podcasts-section"},as={class:"episode-list"},is=["onClick"],ls=["src","alt"],ns={class:"episode-meta"},ds={class:"episode-title"},rs={class:"episode-subtitle"},cs={class:"episode-show"},us={class:"episode-time"},ps={key:0,class:"episode-dot"},ks={key:1,class:"episode-date"},vs={key:0,class:"episode-desc"},hs={class:"episode-actions"},_s=["onClick"],fs=["onClick"],ys=["onClick"],gs={key:0,class:"podcasts-section"},ws={class:"podcast-shows podcast-shows-preview"},Cs={__name:"PodcastsView",setup(ms){const B=U(),n=Q(),P=z(),g=m([]),w=m(!0),r=m("all"),_=b(()=>(g.value||[]).slice(0,4)),C=b(()=>{const o=new Set(_.value.map(a=>a.slug)),e=[];for(const a of g.value||[])if(o.has(a.slug))for(const s of a.episodes||[])e.push({key:`${a.slug}:${s.id}`,showSlug:a.slug,showTitle:a.title||a.slug,id:s.id,title:s.title||"Untitled",description:s.description||"",date:s.date||"",duration:s.duration||V(s.duration_seconds),duration_seconds:s.duration_seconds||0,artwork:s.artwork||s.cover_art||a.artwork||"/static/img/default-cover.jpg",audio_url:s.audio_url||s.url||"",type:"podcast",artist:a.title||a.slug,cover_art:s.artwork||s.cover_art||a.artwork||"/static/img/default-cover.jpg"});return e.sort((a,s)=>String(s.date||"").localeCompare(String(a.date||""))),e}),S=b(()=>r.value==="all"?C.value:C.value.filter(o=>o.showSlug===r.value));function V(o){if(!o)return"";const e=Math.floor(o/60),a=Math.floor(o%60);return`${e}:${a.toString().padStart(2,"0")}`}function f(o){return{id:o.id,key:o.key,title:o.title,artist:o.showTitle,cover_art:o.artwork,audio_url:o.audio_url,type:"podcast"}}function j(o){const e=[...S.value].sort((d,N)=>(d.title||"").localeCompare(N.title||"",void 0,{sensitivity:"base"})),a=e.map(d=>f(d)),s=e.findIndex(d=>d.key===o.key);n.setQueue(a,s>=0?s:0)}function q(o){n.addToQueue(f(o))}function A(o){P.toggle({type:"podcast-episode",id:o.key,title:o.title,artwork:o.artwork,_type:"podcast-episode"})}function M(o){B.push(`/podcasts/${o}`)}return E(async()=>{w.value=!0;const o=await F("/api/podcasts").catch(()=>({shows:[]}));g.value=o.shows||[],w.value=!1}),(o,e)=>{const a=O("router-link");return i(),l("div",L,[e[13]||(e[13]=t("section",{class:"podcasts-hero"},[t("div",{class:"podcasts-hero-inner"},[t("h1",null,[t("i",{class:"fas fa-podcast","aria-hidden":"true"}),$(" Podcasts ")]),t("p",null,"Fresh episodes and shows from independent creators.")])],-1)),t("section",R,[t("div",G,[e[3]||(e[3]=t("div",null,[t("h2",null,"Shows"),t("p",{class:"podcasts-section-subtitle"},"Pick a show to filter the latest episodes.")],-1)),t("div",H,[t("button",{type:"button",class:p(["podcast-filter-chip",{active:r.value==="all"}]),onClick:e[0]||(e[0]=s=>r.value="all")}," All ",2),(i(!0),l(v,null,h(_.value,s=>(i(),l("button",{key:s.slug,type:"button",class:p(["podcast-filter-chip",{active:r.value===s.slug}]),onClick:d=>r.value=s.slug},c(s.title),11,J))),128))])]),t("div",K,[D(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>r.value=s),class:"podcast-show-select"},[e[4]||(e[4]=t("option",{value:"all"},"All Shows",-1)),(i(!0),l(v,null,h(_.value,s=>(i(),l("option",{key:s.slug,value:s.slug},c(s.title),9,W))),128))],512),[[I,r.value]])]),t("div",X,[(i(!0),l(v,null,h(_.value,s=>(i(),l("div",{key:s.slug,class:p(["podcast-show-preview-card",{active:r.value===s.slug}])},[t("button",{type:"button",class:"podcast-show-card podcast-show-card--filter",onClick:d=>r.value=s.slug},[t("img",{src:s.artwork||"/static/img/default-cover.jpg",alt:s.title,class:"podcast-show-art",loading:"lazy"},null,8,Z),t("div",ss,c(s.title),1),s.description?(i(),l("div",ts,c(s.description),1)):k("",!0),s.last_updated?(i(),l("div",es," Updated "+c(s.last_updated),1)):k("",!0)],8,Y),T(a,{to:`/podcasts/${s.slug}`,class:"podcast-show-open"},{default:x(()=>[...e[5]||(e[5]=[$(" Open show ",-1),t("i",{class:"fas fa-arrow-right","aria-hidden":"true"},null,-1)])]),_:1},8,["to"])],2))),128))])]),t("section",os,[e[11]||(e[11]=t("div",{class:"podcasts-section-header"},[t("h2",null,"New Episodes")],-1)),t("div",as,[(i(!0),l(v,null,h(S.value,s=>(i(),l("article",{key:s.key,class:p(["episode-row",{playing:u(n).currentTrack&&(u(n).currentTrack.id===s.id||u(n).currentTrack.key===s.key)}]),onClick:d=>M(s.showSlug)},[t("img",{class:"episode-art",src:s.artwork||"/static/img/default-cover.jpg",alt:s.title,loading:"lazy"},null,8,ls),t("div",ns,[t("div",ds,c(s.title),1),t("div",rs,[t("span",cs,c(s.showTitle),1),e[6]||(e[6]=t("span",{class:"episode-dot"},"•",-1)),t("span",us,c(s.duration),1),s.date?(i(),l("span",ps,"•")):k("",!0),s.date?(i(),l("span",ks,c(s.date),1)):k("",!0)]),s.description?(i(),l("div",vs,c(s.description),1)):k("",!0)]),t("div",hs,[t("button",{type:"button",class:"episode-btn",title:"Play",onClick:y(d=>j(s),["stop"])},[t("i",{class:p(u(n).currentTrack&&(u(n).currentTrack.id===s.id||u(n).currentTrack.key===s.key)&&u(n).isPlaying?"fas fa-pause":"fas fa-play"),"aria-hidden":"true"},null,2),e[7]||(e[7]=t("span",{class:"sr-only"},"Play",-1))],8,_s),t("button",{type:"button",class:p(["episode-btn queue-btn",{"in-queue":u(n).isInQueue(f(s))}]),title:"Add to queue",onClick:y(d=>q(s),["stop"])},[t("i",{class:p(u(n).isInQueue(f(s))?"fas fa-check":"fas fa-plus"),"aria-hidden":"true"},null,2),e[8]||(e[8]=t("span",{class:"sr-only"},"Add to queue",-1))],10,fs),t("button",{type:"button",class:"episode-btn bm-btn",title:"Bookmark",onClick:y(d=>A(s),["stop"])},[...e[9]||(e[9]=[t("i",{class:"fas fa-bookmark","aria-hidden":"true"},null,-1),t("span",{class:"sr-only"},"Bookmark",-1)])],8,ys),T(a,{to:`/podcasts/${s.showSlug}`,class:"episode-open",onClick:e[2]||(e[2]=y(()=>{},["stop"]))},{default:x(()=>[...e[10]||(e[10]=[t("i",{class:"fas fa-external-link-alt","aria-hidden":"true"},null,-1),t("span",{class:"sr-only"},"Open",-1)])]),_:1},8,["to"])])],10,is))),128))])]),w.value?(i(),l("section",gs,[t("div",ws,[(i(),l(v,null,h(4,s=>t("div",{key:s,class:"podcast-show-preview-card"},[...e[12]||(e[12]=[t("div",{class:"podcast-show-art skeleton",style:{"aspect-ratio":"1",width:"100%"}},null,-1),t("div",{class:"skeleton",style:{height:"14px",width:"80%","margin-top":"8px"}},null,-1)])])),64))])])):k("",!0)])}}};export{Cs as default};
