import{_ as L}from"./ahoy_logo--Z4AShNu.js";import{_ as x,o as B,E as m,c as i,d as u,e as s,g as r,t as w,k as a,j as o,i as l,l as V,G as D,O as F,m as v,r as N,B as T}from"./index-J1hCH1Lh.js";const I={class:"account-page"},O={key:0,class:"account-card"},P={class:"account-profile"},W={class:"account-name"},$={class:"account-email"},j={class:"account-section"},U={class:"wallet-balance"},Y={class:"wallet-amount"},z={class:"account-wallet-actions"},G=["disabled"],J={key:0,class:"fas fa-spinner fa-spin"},M={key:1,class:"fas fa-wallet"},R={class:"account-section"},q={class:"account-danger-zone"},H={key:1,class:"delete-confirm-box neu-card-inset"},K={class:"delete-actions"},Q=["disabled"],X={key:0,class:"fas fa-spinner fa-spin"},Z=["disabled"],tt={key:1,class:"account-guest"},st={class:"account-section"},at={class:"account-guest-cta"},et={__name:"AccountView",setup(nt){const p=T(),e=F(),g=v(null),f=v(!1),y=v(!1),d=v(!1);B(async()=>{if(e.isLoggedIn.value)try{const c=await m("/payments/wallet");g.value=c.balance??0}catch{g.value=0}});async function C(){if(!e.isLoggedIn.value){p.push("/login");return}const c=10;f.value=!0;try{const t=await m("/payments/wallet/fund",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:c})});if(t.checkout_url){window.location.href=t.checkout_url;return}window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:t.error||"Could not start checkout",type:"error"}}))}catch(t){window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:t.message||"Failed to add funds",type:"error"}}))}finally{f.value=!1}}async function E(){await e.logout(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Signed out",type:"success"}})),p.push("/")}async function S(){d.value=!0;try{const c=await m("/api/auth/delete-account",{method:"POST"});c.success?(window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Account deleted",type:"success"}})),p.push("/"),await e.logout()):window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:c.error||"Deletion failed",type:"error"}}))}catch{window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Failed to delete account",type:"error"}}))}finally{d.value=!1}}return(c,t)=>{var k,b,h,_;const n=N("router-link");return i(),u("div",I,[t[23]||(t[23]=s("section",{class:"podcasts-hero account-page-header"},[s("div",{class:"podcasts-hero-inner account-hero-inner"},[s("img",{src:L,alt:"Ahoy",class:"account-hero-logo"}),s("div",null,[s("h1",null,"Account"),s("p",null,"Wallet & profile")])])],-1)),r(e).isLoggedIn.value?(i(),u("div",O,[s("div",P,[t[2]||(t[2]=s("div",{class:"account-avatar"},[s("i",{class:"fas fa-user-circle"})],-1)),s("div",W,w(((k=r(e).user.value)==null?void 0:k.display_name)||((b=r(e).user.value)==null?void 0:b.username)||((h=r(e).user.value)==null?void 0:h.email)),1),s("div",$,w((_=r(e).user.value)==null?void 0:_.email),1)]),s("section",j,[t[6]||(t[6]=s("h2",{class:"account-section-title"},"Wallet",-1)),s("div",U,[t[3]||(t[3]=s("span",{class:"wallet-label"},"Balance",-1)),s("span",Y,"$"+w((g.value??0).toFixed(2)),1)]),t[7]||(t[7]=s("p",{class:"wallet-note"},"Use your wallet for boosts and merch checkout.",-1)),s("div",z,[s("button",{type:"button",class:"account-btn primary",disabled:f.value,onClick:C},[f.value?(i(),u("i",J)):(i(),u("i",M)),t[4]||(t[4]=a(" Add funds ",-1))],8,G),o(n,{to:"/wallet",class:"account-btn secondary"},{default:l(()=>[...t[5]||(t[5]=[a("Transaction history",-1)])]),_:1})])]),s("section",R,[t[11]||(t[11]=s("h2",{class:"account-section-title"},"Links",-1)),o(n,{to:"/tip-artist",class:"account-link"},{default:l(()=>[...t[8]||(t[8]=[s("i",{class:"fas fa-heart"},null,-1),a(" Boost artists ",-1)])]),_:1}),o(n,{to:"/my-saves",class:"account-link"},{default:l(()=>[...t[9]||(t[9]=[s("i",{class:"fas fa-bookmark"},null,-1),a(" Saved ",-1)])]),_:1}),o(n,{to:"/settings",class:"account-link"},{default:l(()=>[...t[10]||(t[10]=[s("i",{class:"fas fa-cog"},null,-1),a(" Settings ",-1)])]),_:1})]),s("button",{type:"button",class:"account-btn logout",onClick:E},[...t[12]||(t[12]=[s("i",{class:"fas fa-sign-out-alt"},null,-1),a(" Sign out ",-1)])]),s("div",q,[y.value?(i(),u("div",H,[t[14]||(t[14]=s("p",null,"Delete your account and all saved data? This cannot be undone.",-1)),s("div",K,[s("button",{class:"account-btn danger",disabled:d.value,onClick:S},[d.value?(i(),u("i",X)):V("",!0),t[13]||(t[13]=a(" Yes, delete everything ",-1))],8,Q),s("button",{class:"account-btn secondary",disabled:d.value,onClick:t[1]||(t[1]=A=>y.value=!1)}," Cancel ",8,Z)])])):(i(),u("button",{key:0,type:"button",class:"account-btn danger-link",onClick:t[0]||(t[0]=A=>y.value=!0)}," Delete account "))])])):(i(),u("div",tt,[t[22]||(t[22]=D('<div class="account-guest-profile" data-v-d8fcec10><div class="account-avatar" data-v-d8fcec10><i class="fas fa-user-circle" data-v-d8fcec10></i></div><h2 class="account-guest-title" data-v-d8fcec10>Profile</h2><p class="account-guest-sub" data-v-d8fcec10>You&#39;re browsing as a guest. Save to this device and explore — create an account to sync everywhere.</p></div>',1)),s("section",st,[t[19]||(t[19]=s("h2",{class:"account-section-title"},"Features",-1)),o(n,{to:"/my-saves",class:"account-link"},{default:l(()=>[...t[15]||(t[15]=[s("i",{class:"fas fa-bookmark"},null,-1),s("span",null,[s("strong",null,"Saved"),a(" — Bookmarks and recently played")],-1)])]),_:1}),o(n,{to:"/playlists",class:"account-link"},{default:l(()=>[...t[16]||(t[16]=[s("i",{class:"fas fa-list-ul"},null,-1),s("span",null,[s("strong",null,"Playlists"),a(" — Create and manage (sign in to save)")],-1)])]),_:1}),o(n,{to:"/settings",class:"account-link"},{default:l(()=>[...t[17]||(t[17]=[s("i",{class:"fas fa-cog"},null,-1),s("span",null,[s("strong",null,"Settings"),a(" — Audio and preferences")],-1)])]),_:1}),o(n,{to:"/wallet",class:"account-link"},{default:l(()=>[...t[18]||(t[18]=[s("i",{class:"fas fa-wallet"},null,-1),s("span",null,[s("strong",null,"Wallet"),a(" — Add funds for boosts and merch (sign in)")],-1)])]),_:1})]),s("div",at,[t[21]||(t[21]=s("p",null,"Log in or create a free account to sync your saves across devices and unlock wallet, playlists, and more.",-1)),o(n,{to:"/login",class:"account-btn primary"},{default:l(()=>[...t[20]||(t[20]=[a("Log In / Sign Up",-1)])]),_:1})])]))])}}},ct=x(et,[["__scopeId","data-v-d8fcec10"]]);export{ct as default};
