import{_ as j,u as z,o as G,E as b,b as U,c as m,d as g,e,G as H,f as a,B as L,F as q,t as p,j as f,k as v,h as M,C as K,i as W,S as D,N as Z,p as $,m as C,s as Q}from"./index-B9CI7FIP.js";const ee={class:"settings-page"},te={class:"settings-container"},se={class:"settings-content"},ne={class:"settings-section neu-card"},oe={class:"settings-profile"},ae={class:"settings-value"},le={class:"settings-links"},ie={key:1,class:"settings-guest"},re={class:"settings-section neu-card"},de={class:"settings-grid"},ue={class:"setting-item"},ce={class:"dial-container"},me={class:"dial-value"},ge={class:"settings-section neu-card experimental-section"},pe={class:"experimental-grid"},fe={class:"downloads-table-wrap"},ve={key:0,class:"downloads-table"},he=["href"],be={key:1,class:"downloads-table-loading"},ye={key:2,class:"downloads-table-error"},k="ahoySettings",Se={__name:"SettingsView",setup(we){const A=Q(),u=Z(),y=z(),N=C(null),l=D({masterVolume:75}),o=D({version:"",date:"",download_url:"",name:"",loading:!0,error:""}),_=C("");function I(){const s=new Date;_.value=s.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}let S=!1,w=null,r=null,d=null;function T(){u.isLoggedIn.value?b("/api/user/profile",{credentials:"include"}).then(s=>{var t;(t=s==null?void 0:s.preferences)!=null&&t.audioSettings&&(l.masterVolume=Math.max(0,Math.min(100,s.preferences.audioSettings.masterVolume??75))),x()}).catch(()=>x()):x()}function x(){var s;try{const t=localStorage.getItem(k);if(t){const n=JSON.parse(t);((s=n.audioSettings)==null?void 0:s.masterVolume)!=null&&(l.masterVolume=Math.max(0,Math.min(100,n.audioSettings.masterVolume)))}}catch{}h()}function O(){const s={audioSettings:{...l}};localStorage.setItem(k,JSON.stringify(s)),u.isLoggedIn.value&&b("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({preferences:{audioSettings:l}})}).catch(()=>{}),h(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Settings saved!",type:"success"}}))}function P(){l.masterVolume=75;const s={audioSettings:{...l}};localStorage.setItem(k,JSON.stringify(s)),u.isLoggedIn.value&&b("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({preferences:{audioSettings:l}})}).catch(()=>{}),h(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Settings reset to defaults",type:"info"}}))}function h(){var t;const s=l.masterVolume/100;document.querySelectorAll("audio").forEach(n=>{n.volume=s});try{const n=(t=y.getAudioElement)==null?void 0:t.call(y);n&&(n.volume=s)}catch{}}function E(s,t){S=!0,w=t;const n=s.currentTarget;r=c=>B(c,n),d=()=>V(),document.addEventListener("mousemove",r),document.addEventListener("mouseup",d),document.addEventListener("touchmove",r,{passive:!1}),document.addEventListener("touchend",d)}function B(s,t){if(!S||!t)return;const n=s.touches?s.touches[0].clientX:s.clientX,c=s.touches?s.touches[0].clientY:s.clientY,i=t.getBoundingClientRect(),J=i.left+i.width/2,R=i.top+i.height/2,Y=(Math.atan2(c-R,n-J)*(180/Math.PI)+90+360)%360,X=Math.max(0,Math.min(100,Y/1.8));w==="masterVolume"&&(l.masterVolume=X),h()}function V(){S=!1,w=null,r&&(document.removeEventListener("mousemove",r),document.removeEventListener("touchmove",r)),d&&(document.removeEventListener("mouseup",d),document.removeEventListener("touchend",d)),r=null,d=null}async function F(){await u.logout(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Signed out",type:"success"}})),A.push("/")}return G(()=>{T(),I(),b("/api/downloads/latest",{credentials:"include"}).then(s=>{o.version=(s==null?void 0:s.version)??"",o.date=(s==null?void 0:s.date)??"",o.download_url=(s==null?void 0:s.download_url)??"",o.name=(s==null?void 0:s.name)??"",o.loading=!1}).catch(()=>{o.error="No macOS release available",o.loading=!1})}),U(()=>{V()}),(s,t)=>{var c;const n=$("router-link");return m(),g("div",ee,[e("div",te,[t[22]||(t[22]=H('<section class="podcasts-hero settings-page-header" data-v-ce58babc><div class="podcasts-hero-inner" data-v-ce58babc><h1 data-v-ce58babc><i class="fas fa-cog" aria-hidden="true" data-v-ce58babc></i> Settings </h1><p data-v-ce58babc>Customize your Ahoy experience.</p></div></section><div class="settings-header desktop-only" data-v-ce58babc><div class="settings-header-icon" data-v-ce58babc><i class="fas fa-cog" data-v-ce58babc></i></div><h1 data-v-ce58babc>Settings</h1><p data-v-ce58babc>Customize your Ahoy experience</p></div>',2)),e("div",se,[e("div",ne,[t[8]||(t[8]=e("h2",null,[e("i",{class:"fas fa-user"}),a(" Account")],-1)),L(u).isLoggedIn.value?(m(),g(q,{key:0},[e("div",oe,[t[2]||(t[2]=e("span",{class:"settings-label"},"Logged in as",-1)),e("span",ae,p((c=L(u).user.value)==null?void 0:c.email),1)]),e("div",le,[f(n,{to:"/account",class:"settings-link"},{default:v(()=>[...t[3]||(t[3]=[e("i",{class:"fas fa-user-circle"},null,-1),a(" Account & wallet ",-1)])]),_:1}),f(n,{to:"/my-saves",class:"settings-link"},{default:v(()=>[...t[4]||(t[4]=[e("i",{class:"fas fa-bookmark"},null,-1),a(" Saved ",-1)])]),_:1})]),e("button",{type:"button",class:"neu-btn neu-btn-secondary logout-btn",onClick:F},[...t[5]||(t[5]=[e("i",{class:"fas fa-sign-out-alt"},null,-1),a(" Sign out ",-1)])])],64)):(m(),g("div",ie,[t[7]||(t[7]=e("p",null,"Sign in to manage your preferences.",-1)),f(n,{to:"/login",class:"neu-btn neu-btn-primary"},{default:v(()=>[...t[6]||(t[6]=[a("Sign in",-1)])]),_:1})]))]),e("div",re,[t[11]||(t[11]=e("h2",null,[e("i",{class:"fas fa-volume-up"}),a(" Audio")],-1)),e("div",de,[e("div",ue,[t[10]||(t[10]=e("label",null,"Master Volume",-1)),e("div",ce,[e("div",{ref_key:"dialEl",ref:N,class:"neu-dial",style:K({transform:`rotate(${l.masterVolume*1.8-90}deg)`}),onMousedown:t[0]||(t[0]=M(i=>E(i,"masterVolume"),["prevent"])),onTouchstart:t[1]||(t[1]=M(i=>E(i,"masterVolume"),["prevent"]))},[...t[9]||(t[9]=[e("div",{class:"dial-handle"},null,-1)])],36),e("span",me,p(Math.round(l.masterVolume)),1)])])])]),e("div",ge,[t[17]||(t[17]=e("h2",null,[e("i",{class:"fas fa-flask"}),a(" Experimental")],-1)),t[18]||(t[18]=e("p",{class:"experimental-disclaimer"},"These features are still in development and may change or be removed.",-1)),e("div",pe,[f(n,{to:"/focus",class:"experimental-card neu-card-inset"},{default:v(()=>[...t[12]||(t[12]=[e("div",{class:"experimental-card-icon"},[e("i",{class:"fas fa-headphones"})],-1),e("div",{class:"experimental-card-info"},[e("h3",null,"Focus Mode"),e("p",null,"Ambient audio for deep focus and relaxation")],-1),e("i",{class:"fas fa-chevron-right experimental-card-arrow"},null,-1)])]),_:1}),f(n,{to:"/mp3-player",class:"experimental-card neu-card-inset"},{default:v(()=>[...t[13]||(t[13]=[e("div",{class:"experimental-card-icon"},[e("i",{class:"fas fa-compact-disc"})],-1),e("div",{class:"experimental-card-info"},[e("h3",null,"MP3 Player"),e("p",null,"Import and play MP3s from your computer — Winamp style")],-1),e("i",{class:"fas fa-chevron-right experimental-card-arrow"},null,-1)])]),_:1}),f(n,{to:"/download",class:"experimental-card neu-card-inset"},{default:v(()=>[...t[14]||(t[14]=[e("div",{class:"experimental-card-icon"},[e("i",{class:"fas fa-download"})],-1),e("div",{class:"experimental-card-info"},[e("h3",null,"Download"),e("p",null,"Get Ahoy on web, Android, iOS, or desktop")],-1),e("i",{class:"fas fa-chevron-right experimental-card-arrow"},null,-1)])]),_:1})]),t[19]||(t[19]=e("p",{class:"downloads-table-intro"},[a("Latest macOS desktop build — also at "),e("a",{href:"/downloads",target:"_blank",rel:"noopener"},"app.ahoy.ooo/downloads"),a(".")],-1)),e("div",fe,[o.version?(m(),g("table",ve,[t[16]||(t[16]=e("thead",null,[e("tr",null,[e("th",null,"Date"),e("th",null,"Version"),e("th",null,"Download")])],-1)),e("tbody",null,[e("tr",null,[e("td",null,p(_.value),1),e("td",null,p(o.version),1),e("td",null,[e("a",{href:o.download_url,target:"_blank",rel:"noopener",class:"download-table-link"},[a(p(o.name||"ZIP")+" ",1),t[15]||(t[15]=e("i",{class:"fas fa-external-link-alt"},null,-1))],8,he)])])])])):o.loading?(m(),g("p",be,"Loading…")):o.error?(m(),g("p",ye,p(o.error),1)):W("",!0)])]),e("div",{class:"settings-actions"},[e("button",{type:"button",class:"neu-btn neu-btn-secondary",onClick:P},[...t[20]||(t[20]=[e("i",{class:"fas fa-undo"},null,-1),a(" Reset to Defaults ",-1)])]),e("button",{type:"button",class:"neu-btn neu-btn-primary",onClick:O},[...t[21]||(t[21]=[e("i",{class:"fas fa-save"},null,-1),a(" Save Settings ",-1)])])])])])])}}},_e=j(Se,[["__scopeId","data-v-ce58babc"]]);export{_e as default};
