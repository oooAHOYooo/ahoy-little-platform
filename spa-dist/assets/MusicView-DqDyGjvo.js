import{_ as O,c as u,d,e as t,C as F,n,t as m,D as K,q as $,m as v,u as W,z as Z,o as tt,y as et,k as Q,f as z,r as R,F as L,l as T,A as I,x as st,v as j,i as at,E as U,p as lt,B as r,h as P,j as G,G as ot}from"./index-Dc5YEzPe.js";const q=70,H=120,it={__name:"PullRefresh",emits:["refresh"],setup(X,{emit:l}){const N=l,w=v(null),y=v(!1),c=v(!1),_=v(0),o=v(0),b=$(()=>c.value?q*.6:Math.min(o.value*.5,H*.5)),p=$(()=>c.value?0:Math.min(o.value*.4,H*.4)-40),x=$(()=>c.value?1:Math.min(o.value/q,1)),f=$(()=>o.value>=q);function V(){return window.scrollY<=0}function h(g){!V()||c.value||(_.value=g.touches[0].clientY,y.value=!0)}function Y(g){if(!y.value||c.value)return;const A=g.touches[0].clientY-_.value;A>0?o.value=A:(y.value=!1,o.value=0)}function k(){y.value&&(f.value?(c.value=!0,o.value=0,N("refresh",E)):o.value=0,y.value=!1)}function E(){c.value=!1,o.value=0}return(g,A)=>(u(),d("div",{class:"pull-refresh-wrapper",ref_key:"wrapper",ref:w,onTouchstartPassive:h,onTouchmovePassive:Y,onTouchendPassive:k},[t("div",{class:n(["pull-indicator",{active:y.value,refreshing:c.value}]),style:F({transform:`translateY(${p.value}px)`,opacity:x.value})},[t("i",{class:n(c.value?"fas fa-spinner fa-spin":"fas fa-arrow-down"),style:F({transform:f.value?"rotate(180deg)":""})},null,6),t("span",null,m(c.value?"Refreshing...":f.value?"Release to refresh":"Pull to refresh"),1)],6),t("div",{class:"pull-content",style:F({transform:`translateY(${b.value}px)`})},[K(g.$slots,"default",{},void 0)],4)],544))}},nt=O(it,[["__scopeId","data-v-d1c2085f"]]),rt={class:"music-container"},ut={class:"podcasts-section podcasts-featured-section"},ct={class:"podcasts-section-header podcasts-featured-header"},dt={class:"podcast-filter-chips"},vt=["onClick"],pt={class:"podcast-shows-dropdown-mobile"},ft=["value"],ht={class:"music-header-toolbar"},mt={class:"search-bar music-toolbar-search"},yt={class:"view-options"},_t={class:"music-list"},bt={class:"music-table-wrap"},kt={class:"music-table"},gt=["onClick"],wt={class:"col-cover"},Ct=["src","alt"],Tt={class:"col-play"},Pt=["aria-label","onClick"],$t={class:"col-title"},xt={class:"col-artist"},At={class:"col-duration"},Mt={class:"col-plays"},St={class:"col-action"},Bt=["onClick"],Dt=["aria-pressed","onClick"],Rt={class:"music-grid"},Lt=["onClick"],Vt=["src","alt"],Yt={class:"track-overlay"},Nt=["onClick"],Et=["onClick"],Ft={class:"track-title"},Qt={class:"track-artist"},jt={class:"track-duration"},qt={key:0,class:"music-grid"},zt={key:1,class:"empty-state"},It={__name:"MusicView",setup(X){const l=W(),N=ot(),w=Z();function y(a){w.toggle({type:"track",id:a.id,title:a.title,cover_art:a.cover_art})}function c(a){N.open(a)}const _=v([]),o=v(!0),b=v(""),p=v(""),x=v("plays"),f=v("list"),V=$(()=>{const a=new Set;for(const e of _.value)e.artist&&a.add(e.artist);return Array.from(a).sort()}),h=$(()=>{let a=[..._.value];if(b.value){const e=b.value.toLowerCase();a=a.filter(i=>(i.title||"").toLowerCase().includes(e)||(i.artist||"").toLowerCase().includes(e)||(i.album||"").toLowerCase().includes(e))}return p.value&&(a=a.filter(e=>e.artist===p.value)),a.sort((e,i)=>{switch(x.value){case"title":return(e.title||"").localeCompare(i.title||"");case"artist":return(e.artist||"").localeCompare(i.artist||"");case"added_date":return new Date(i.added_date||0)-new Date(e.added_date||0);case"plays":return(i.play_count||0)-(e.play_count||0);default:return 0}}),a});function Y(a){if(!a&&a!==0)return"0:00";const e=Math.floor(Number(a)/60),i=Math.floor(Number(a)%60);return`${e}:${i.toString().padStart(2,"0")}`}function k(a){var s;const e=h.value,i=e[a];if(i){if(((s=l.currentTrack)==null?void 0:s.id)===i.id&&l.isPlaying){l.pause();return}l.setQueue(e,a)}}function E(a){l.addToQueue({type:"track",id:a.id,title:a.title,artist:a.artist,cover_art:a.cover_art,duration_seconds:a.duration_seconds})}function g(){if(h.value.length===0)return;const a=Math.floor(Math.random()*h.value.length);k(a)}async function A(){o.value=!0;try{const a=await U("/api/music?t="+Date.now());_.value=a.tracks||[]}catch{_.value=[]}o.value=!1}async function J(a){try{const e=await U("/api/music?t="+Date.now());_.value=e.tracks||[]}catch{}a()}return tt(A),(a,e)=>{const i=lt("router-link");return u(),et(nt,{onRefresh:J},{default:Q(()=>[t("div",rt,[e[21]||(e[21]=t("section",{class:"podcasts-hero"},[t("div",{class:"podcasts-hero-inner"},[t("h1",null,[t("i",{class:"fas fa-music","aria-hidden":"true"}),z(" Music Library ")]),t("p",null,"Explore")])],-1)),t("section",ut,[t("div",ct,[e[9]||(e[9]=t("div",null,[t("h2",null,"Tracks"),t("p",{class:"podcasts-section-subtitle"},"Filter by artist or search. Sort and switch between list and grid.")],-1)),t("div",dt,[t("button",{type:"button",class:n(["podcast-filter-chip",{active:!p.value}]),onClick:e[0]||(e[0]=s=>p.value="")}," All ",2),(u(!0),d(L,null,R(V.value.slice(0,14),s=>(u(),d("button",{key:s,type:"button",class:n(["podcast-filter-chip",{active:p.value===s}]),onClick:C=>p.value=s},m(s),11,vt))),128))])]),t("div",pt,[T(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>p.value=s),class:"podcast-show-select","aria-label":"Filter by artist"},[e[10]||(e[10]=t("option",{value:""},"All Artists",-1)),(u(!0),d(L,null,R(V.value,s=>(u(),d("option",{key:s,value:s},m(s),9,ft))),128))],512),[[I,p.value]])]),t("div",ht,[t("div",mt,[e[12]||(e[12]=t("i",{class:"fas fa-search","aria-hidden":"true"},null,-1)),T(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>b.value=s),type:"text",class:"search-input",placeholder:"Search music...","aria-label":"Search music"},null,512),[[st,b.value]]),T(t("button",{type:"button",class:"search-clear","aria-label":"Clear search",onClick:e[3]||(e[3]=s=>b.value="")},[...e[11]||(e[11]=[t("i",{class:"fas fa-times","aria-hidden":"true"},null,-1)])],512),[[j,b.value]])]),T(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>x.value=s),class:"music-toolbar-sort","aria-label":"Sort music"},[...e[13]||(e[13]=[t("option",{value:"title"},"Title",-1),t("option",{value:"artist"},"Artist",-1),t("option",{value:"plays"},"Plays",-1),t("option",{value:"added_date"},"Date Added",-1)])],512),[[I,x.value]]),t("div",yt,[t("button",{type:"button",class:n(["view-btn",{active:f.value==="grid"}]),"aria-label":"Grid view",onClick:e[5]||(e[5]=s=>f.value="grid")},[...e[14]||(e[14]=[t("i",{class:"fas fa-th","aria-hidden":"true"},null,-1)])],2),t("button",{type:"button",class:n(["view-btn",{active:f.value==="list"}]),"aria-label":"List view",onClick:e[6]||(e[6]=s=>f.value="list")},[...e[15]||(e[15]=[t("i",{class:"fas fa-list","aria-hidden":"true"},null,-1)])],2)]),t("button",{type:"button",class:"episode-btn music-toolbar-play",title:"Play Random",onClick:g},[...e[16]||(e[16]=[t("i",{class:"fas fa-random","aria-hidden":"true"},null,-1),t("span",{class:"sr-only"},"Play Random",-1)])])])]),T(t("div",_t,[t("div",bt,[t("table",kt,[e[17]||(e[17]=t("thead",null,[t("tr",null,[t("th",{class:"col-cover"}),t("th",{class:"col-play"}),t("th",{class:"col-title"},"Title"),t("th",{class:"col-artist"},"Artist"),t("th",{class:"col-duration"},"Time"),t("th",{class:"col-plays"},"Plays"),t("th",{class:"col-action"},"Actions")])],-1)),t("tbody",null,[(u(!0),d(L,null,R(h.value,(s,C)=>{var M,S,B;return u(),d("tr",{key:s.id,class:n(["music-table-row",{playing:((M=r(l).currentTrack)==null?void 0:M.id)===s.id}]),onClick:D=>k(C)},[t("td",wt,[t("img",{class:"music-table-thumb",src:s.cover_art||"/static/img/default-cover.jpg",alt:s.title,loading:"lazy",onError:e[7]||(e[7]=D=>D.target.src="/static/img/default-cover.jpg")},null,40,Ct)]),t("td",Tt,[t("button",{type:"button",class:"play-btn","aria-label":((S=r(l).currentTrack)==null?void 0:S.id)===s.id&&r(l).isPlaying?"Pause":"Play",onClick:P(D=>k(C),["stop"])},[t("i",{class:n(((B=r(l).currentTrack)==null?void 0:B.id)===s.id&&r(l).isPlaying?"fas fa-pause":"fas fa-play")},null,2)],8,Pt)]),t("td",$t,[G(i,{to:`/music/${s.id}`,class:"title-text",onClick:e[8]||(e[8]=P(()=>{},["stop"]))},{default:Q(()=>[z(m(s.title),1)]),_:2},1032,["to"])]),t("td",xt,m(s.artist),1),t("td",At,m(Y(s.duration_seconds)),1),t("td",Mt,m(s.play_count||0),1),t("td",St,[t("button",{type:"button",class:n(["action-btn queue-btn",{"in-queue":r(l).isInQueue({id:s.id})}]),title:"Add to queue",onClick:P(D=>E(s),["stop"])},[t("i",{class:n(r(l).isInQueue({id:s.id})?"fas fa-check":"fas fa-plus")},null,2)],10,Bt),t("button",{type:"button",class:n(["action-btn bm-btn",{bookmarked:r(w).isBookmarked({id:s.id})}]),"aria-pressed":r(w).isBookmarked({id:s.id}),title:"Save",onClick:P(D=>y(s),["stop"])},[t("i",{class:n(r(w).isBookmarked({id:s.id})?"fas fa-bookmark":"far fa-bookmark")},null,2)],10,Dt)])],10,gt)}),128))])])])],512),[[j,f.value==="list"&&!o.value&&h.value.length>0]]),T(t("div",Rt,[(u(!0),d(L,null,R(h.value,(s,C)=>{var M,S;return u(),d("div",{key:s.id,class:n(["track-card",{playing:((M=r(l).currentTrack)==null?void 0:M.id)===s.id}])},[t("div",{class:"track-cover",onClick:B=>k(C)},[t("img",{src:s.cover_art||"/static/img/default-cover.jpg",alt:s.title,loading:"lazy"},null,8,Vt),t("div",Yt,[t("button",{type:"button",class:"play-btn",onClick:P(B=>k(C),["stop"])},[t("i",{class:n(((S=r(l).currentTrack)==null?void 0:S.id)===s.id&&r(l).isPlaying?"fas fa-pause":"fas fa-play")},null,2)],8,Nt),t("button",{type:"button",class:"track-overlay-btn add-to-playlist-btn",title:"Add to playlist",onClick:P(B=>c(s),["stop"])},[...e[18]||(e[18]=[t("i",{class:"fas fa-plus"},null,-1)])],8,Et)])],8,Lt),G(i,{to:`/music/${s.id}`,class:"track-info",style:{"text-decoration":"none",color:"inherit"}},{default:Q(()=>[t("div",Ft,m(s.title),1),t("div",Qt,m(s.artist),1),t("div",jt,m(Y(s.duration_seconds)),1)]),_:2},1032,["to"])],2)}),128))],512),[[j,f.value==="grid"&&!o.value&&h.value.length>0]]),o.value?(u(),d("div",qt,[(u(),d(L,null,R(8,s=>t("div",{key:s,class:"track-card"},[...e[19]||(e[19]=[t("div",{class:"track-cover skeleton"},null,-1),t("div",{class:"track-info"},[t("div",{class:"skeleton",style:{height:"14px",width:"60%","margin-bottom":"6px"}}),t("div",{class:"skeleton",style:{height:"12px",width:"40%","margin-bottom":"4px"}}),t("div",{class:"skeleton",style:{height:"10px",width:"36px"}})],-1)])])),64))])):!o.value&&h.value.length===0?(u(),d("div",zt,[...e[20]||(e[20]=[t("i",{class:"fas fa-music"},null,-1),t("h3",null,"No music found",-1),t("p",null,"Try adjusting your filters or search terms",-1)])])):at("",!0)])]),_:1})}}},Gt=O(It,[["__scopeId","data-v-5ceea4cc"]]);export{Gt as default};
