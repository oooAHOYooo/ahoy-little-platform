import{_ as V,u as x,w as F,o as I,a as L,c as d,d as c,e as t,f as $,n as m,B as p,t as r,i as v,C as w,F as j,r as q,m as b,q as h}from"./index-B9CI7FIP.js";const Q={class:"radio-page radio-page--v2"},z={class:"radio-hero"},D={class:"radio-hero-inner"},O={class:"radio-hero-grid"},U={class:"radio-hero-art"},X=["src"],G={class:"radio-hero-copy"},H={class:"radio-live"},J={class:"radio-hero-actions"},K={key:0,class:"radio-now"},W={class:"radio-track-card"},Y={class:"radio-track-main"},Z=["src"],tt={class:"radio-track-info"},st={class:"radio-track-title"},at={class:"radio-track-artist"},ot={class:"radio-track-meta"},et={key:0},it={key:1},nt={key:2},rt={class:"radio-track-actions"},lt={class:"radio-progress-wrap"},dt={class:"radio-progress-times"},ct={class:"radio-justplayed"},ut={class:"playing-list"},pt=["onClick"],vt={class:"item-details"},ht={key:0,class:"radio-empty-hint"},_t="https://ahoy.ooo/images/Ahoy-Indie-Media-DEFAULT-COVER-A-8.jpg",ft="Indie Rock Station",yt="Independent and alternative rock music, curated by music lovers.",kt={__name:"RadioView",setup(gt){const e=x(),_=b([]),u=b([]),f=_t,l=h(()=>e.currentTrack),C=h(()=>{const a=e.currentTrack;if(a!=null&&a.cover_art||a!=null&&a.artwork)return a.cover_art||a.artwork;const s=_.value[0];return(s==null?void 0:s.cover_art)||f}),y=h(()=>e.duration||0),S=h(()=>e.progress??0),g=h(()=>u.value.slice(0,8));function k(a){const s=Math.max(0,Math.floor(Number(a)||0)),o=Math.floor(s/60),n=s%60;return`${String(o).padStart(2,"0")}:${String(n).padStart(2,"0")}`}function T(a){const s=[...a];for(let o=s.length-1;o>0;o--){const n=Math.floor(Math.random()*(o+1));[s[o],s[n]]=[s[n],s[o]]}return s}function P(){const a=_.value.filter(i=>i.audio_url||i.preview_url),s=[],o=new Set;for(const i of a)o.has(i.id)||(o.add(i.id),s.push(i));const n=T(s);e.setQueue(n,0)}function A(){if(e.isPlaying){e.pause();return}if(e.currentTrack){e.play();return}_.value.length&&P()}function E(a){const s=e.currentTrack;s&&s.id!==a.id&&(u.value=[s,...u.value].slice(0,20)),e.play(a)}function M(a){const o=a.currentTarget.getBoundingClientRect(),n=Math.min(o.width,Math.max(0,a.clientX-o.left)),i=o.width?n/o.width*100:0;e.seek(i)}function N(a){e.addToQueue(a),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Added to queue"}}))}function R(){window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Boost coming soon"}}))}function B(a){return{backgroundImage:`linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.8)), url(${a.cover_art||a.artwork||f})`,backgroundSize:"cover",backgroundPosition:"center"}}return F(()=>e.currentTrack,(a,s)=>{s&&a&&s.id!==a.id&&(u.value=[s,...u.value].slice(0,20))}),I(async()=>{const o=((await L("/api/music").catch(()=>({tracks:[]}))).tracks||[]).filter(i=>i.audio_url||i.preview_url),n=new Set;_.value=o.filter(i=>n.has(i.id)?!1:(n.add(i.id),!0))}),(a,s)=>(d(),c("div",Q,[s[9]||(s[9]=t("section",{class:"podcasts-hero radio-page-header"},[t("div",{class:"podcasts-hero-inner"},[t("h1",null,[t("i",{class:"fas fa-broadcast-tower","aria-hidden":"true"}),$(" Radio ")]),t("p",null,"Live radio feed and indie discovery.")])],-1)),t("section",z,[t("div",D,[t("div",O,[t("div",U,[t("img",{src:C.value,alt:"Station artwork"},null,8,X)]),t("div",G,[t("div",H,[t("span",{class:m(["radio-live-dot",{"radio-live-dot--on":p(e).isPlaying}])},null,2),s[2]||(s[2]=t("span",null,"Live Now",-1))]),s[3]||(s[3]=t("div",{class:"radio-eq","aria-hidden":"true"},[t("span"),t("span"),t("span"),t("span"),t("span"),t("span"),t("span"),t("span")],-1)),t("h1",{class:"radio-hero-title desktop-only"},r(ft)),t("p",{class:"radio-hero-subtitle desktop-only"},r(yt)),t("div",J,[t("button",{type:"button",class:"radio-cta",onClick:A},[t("i",{class:m(["fas radio-cta-icon",p(e).isPlaying?"fa-pause":"fa-play"])},null,2),t("span",null,r(p(e).isPlaying?"Pause":"Listen Now"),1)])])])])])]),l.value?(d(),c("section",K,[s[6]||(s[6]=t("h3",{class:"radio-section-title"},"Currently Playing",-1)),t("div",W,[t("div",Y,[t("img",{class:"radio-track-cover",src:l.value.cover_art||l.value.artwork||p(f),alt:"cover"},null,8,Z),t("div",tt,[t("h4",st,r(l.value.title||"—"),1),t("div",at,r(l.value.artist||"—"),1),t("div",ot,[l.value.album?(d(),c("span",et,"Album: "+r(l.value.album),1)):v("",!0),l.value.year?(d(),c("span",it,r(l.value.year),1)):v("",!0),y.value?(d(),c("span",nt,r(k(y.value)),1)):v("",!0)])]),t("div",rt,[t("button",{type:"button",class:"radio-icon-btn",title:"Boost",onClick:s[0]||(s[0]=o=>R(l.value))},[...s[4]||(s[4]=[t("i",{class:"fas fa-bolt"},null,-1)])]),t("button",{type:"button",class:"radio-icon-btn",title:"Add to queue",onClick:s[1]||(s[1]=o=>N(l.value))},[...s[5]||(s[5]=[t("i",{class:"fas fa-plus"},null,-1)])])])]),t("div",lt,[t("div",dt,[t("span",null,r(k(p(e).currentTime)),1),t("span",null,r(k(y.value)),1)]),t("div",{class:"radio-progress-bar",onClick:M},[t("div",{class:"radio-progress-fill",style:w({width:S.value+"%"})},null,4)])])])])):v("",!0),t("section",ct,[s[8]||(s[8]=t("h3",{class:"radio-section-title"},"Previously Played",-1)),t("div",ut,[(d(!0),c(j,null,q(g.value,o=>(d(),c("div",{key:o.id,class:"playing-item",style:w(B(o)),onClick:n=>E(o)},[t("div",vt,[t("h4",null,r(o.title),1),t("p",null,r(o.artist),1)]),s[7]||(s[7]=t("div",{class:"play-indicator"},[t("i",{class:"fas fa-play"})],-1))],12,pt))),128))]),g.value.length?v("",!0):(d(),c("p",ht,"Tracks you play will appear here."))])]))}},wt=V(kt,[["__scopeId","data-v-1c9b9c3d"]]);export{wt as default};
