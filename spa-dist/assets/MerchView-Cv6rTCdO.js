import{o as A,a as B,c as n,d as o,e as t,f as u,l as S,x as U,A as E,F as y,r as k,m as i,q as V,n as b,i as C,t as m,h as z}from"./index-y87kZUkW.js";const N={class:"merch-shell"},D={class:"merch-controls"},L={class:"merch-search",role:"search"},P={class:"merch-pill"},R={key:0,class:"merch-grid"},j=["onMouseenter","onMouseleave"],H=["src","alt","title","onError"],T={key:0,class:"image-toggle-hint"},O={key:1,class:"sale-pending-badge"},Q={class:"merch-body"},Z={class:"merch-top"},G={class:"merch-title"},J={class:"merch-price"},K={class:"usd"},W={class:"merch-chips"},X={class:"merch-actions"},Y=["id"],ee=["onClick"],se={key:1,class:"merch-empty"},te={key:2,class:"merch-grid"},M="/static/img/default-cover.jpg",ne={__name:"MerchView",setup(ae){const h=i([]),v=i(new Set),f=i(!0),g=i(""),c=i("featured"),d=i({});function p(a){return String(a||"").toLowerCase()}function x(a){const s=p(a&&(a.kind||a.type||a.category));return!["theme","themes","subscription","subscriptions","membership","memberships"].includes(s)}const w=V(()=>{let a=Array.isArray(h.value)?[...h.value]:[];a=a.filter(e=>x(e));const s=p(g.value);return s&&(a=a.filter(e=>p(e.name||e.id).includes(s))),c.value==="low"?a.sort((e,l)=>(+e.price_usd||0)-(+l.price_usd||0)):c.value==="high"?a.sort((e,l)=>(+l.price_usd||0)-(+e.price_usd||0)):c.value==="az"&&a.sort((e,l)=>String(e.name||e.id||"").localeCompare(String(l.name||l.id||""))),a});function r(a){return!a||!a.id?!1:v.value.has(String(a.id))}function q(a){const s=p(a.name||a.id),e=+a.price_usd||0,l=[];return(s.includes("limited")||s.includes("drop"))&&l.push("Limited Drop"),s.includes("bundle")&&l.push("Bundle"),e>=50?l.push("Collector"):l.push("Supporter"),l.slice(0,2)}function F(a){if(r(a))return;const s=encodeURIComponent(a.id||""),e=encodeURIComponent(a.name||a.id||"Merch"),l=encodeURIComponent(a.price_usd??""),_=document.getElementById("qty_"+(a.id||"")),$=encodeURIComponent(_&&_.value?_.value:"1");window.location.assign(`/checkout?type=merch&item_id=${s}&qty=${$}&amount=${l}&title=${e}`)}function I(a,s){const e=a==null?void 0:a.target;if(!e||e.dataset.merchFallback)return;e.dataset.merchFallback="1",d.value[s==null?void 0:s.id]&&(s==null?void 0:s.image_url_back)&&e.src===(s==null?void 0:s.image_url_back)?e.src=(s==null?void 0:s.image_url)||M:e.src=M}return A(async()=>{f.value=!0;try{const a=await B("/api/merch");h.value=a.items||[],v.value=new Set((a.purchased_item_ids||[]).map(String))}catch{h.value=[],v.value=new Set}f.value=!1}),(a,s)=>(n(),o("div",N,[s[10]||(s[10]=t("section",{class:"podcasts-hero"},[t("div",{class:"podcasts-hero-inner"},[t("h1",null,[t("i",{class:"fas fa-shopping-bag","aria-hidden":"true"}),u(" Merch ")]),t("p",null,"Support Ahoy with limited drops and essentials.")])],-1)),s[11]||(s[11]=t("div",{class:"merch-hero desktop-only"},[t("h1",null,"Merch"),t("p",null,"Support Ahoy with limited drops and essentials. Fast checkout, easy quantities.")],-1)),t("div",D,[t("div",L,[s[2]||(s[2]=t("i",{class:"fas fa-search","aria-hidden":"true"},null,-1)),S(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>g.value=e),type:"search",placeholder:"Search merch…","aria-label":"Search merch"},null,512),[[U,g.value]])]),t("div",P,[s[4]||(s[4]=t("span",{style:{opacity:".7","font-size":"12px","letter-spacing":".08em","text-transform":"uppercase"}},"Sort",-1)),S(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>c.value=e),"aria-label":"Sort merch"},[...s[3]||(s[3]=[t("option",{value:"featured"},"Featured",-1),t("option",{value:"low"},"Price: Low",-1),t("option",{value:"high"},"Price: High",-1),t("option",{value:"az"},"Name: A–Z",-1)])],512),[[E,c.value]])])]),w.value.length?(n(),o("div",R,[(n(!0),o(y,null,k(w.value,e=>(n(),o("div",{key:e.id,class:b(["merch-card",{"sale-pending":r(e)}])},[t("div",{class:"merch-media",onMouseenter:l=>d.value[e.id]=!!e.image_url_back,onMouseleave:l=>d.value[e.id]=!1},[t("img",{src:d.value[e.id]&&e.image_url_back?e.image_url_back:e.image_url||"/static/img/default-cover.jpg",alt:e.name||e.id,loading:"lazy",decoding:"async",title:d.value[e.id]?"Back view":"Front view",onError:l=>I(l,e)},null,40,H),e.image_url_back?(n(),o("div",T,[...s[5]||(s[5]=[t("i",{class:"fas fa-sync-alt"},null,-1),t("span",null,"Hover to see back",-1)])])):C("",!0),r(e)?(n(),o("div",O,[...s[6]||(s[6]=[t("i",{class:"fas fa-clock","aria-hidden":"true"},null,-1),t("span",null,"Sale Pending",-1)])])):C("",!0)],40,j),t("div",Q,[t("div",Z,[t("h3",G,m(e.name||e.id),1),t("div",J,[t("div",K,m(e.price_usd!=null?"$"+(+e.price_usd).toFixed(2):"—"),1),s[7]||(s[7]=t("div",{class:"sub"},"USD",-1))])]),t("div",W,[(n(!0),o(y,null,k(q(e),l=>(n(),o("span",{key:l,class:"merch-chip"},m(l),1))),128))]),t("div",X,[t("input",{class:"qty",type:"number",min:"1",max:"1",value:"1",id:"qty_"+(e.id||""),disabled:"","aria-label":"Quantity",title:"One-of-a-kind item"},null,8,Y),t("a",{class:b(["merch-cta",{disabled:r(e)}]),href:"#",onClick:z(l=>r(e)?null:F(e),["prevent"])},[t("span",null,m(r(e)?"Sold":"Checkout"),1),t("i",{class:b(r(e)?"fas fa-lock":"fas fa-arrow-right"),"aria-hidden":"true"},null,2)],10,ee)])])],2))),128))])):f.value?(n(),o("div",te,[(n(),o(y,null,k(6,e=>t("div",{key:e,class:"merch-card"},[...s[9]||(s[9]=[t("div",{class:"merch-media skeleton",style:{"aspect-ratio":"4/3"}},null,-1),t("div",{class:"merch-body"},[t("div",{class:"skeleton",style:{height:"14px",width:"60%","margin-bottom":"6px"}}),t("div",{class:"skeleton",style:{height:"12px",width:"30%"}})],-1)])])),64))])):(n(),o("div",se,[...s[8]||(s[8]=[u(" No merch items found yet. Add images to ",-1),t("code",null,"static/merch/images/",-1),u(" and run ",-1),t("code",null,"python manifest.py merch",-1),u(" to generate ",-1),t("code",null,"data/merch.json",-1),u(". ",-1)])]))]))}};export{ne as default};
