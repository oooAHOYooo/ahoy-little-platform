import{_ as J,c as d,d as c,e as t,C as z,n as o,t as v,D as W,q as R,m as y,u as Z,z as tt,o as st,y as et,k as N,f as at,r as x,F as B,l as D,A as O,x as lt,v as F,i as it,E as G,s as ot,p as nt,B as l,h as p,j as U}from"./index-y87kZUkW.js";const Q=70,X=120,rt={__name:"PullRefresh",emits:["refresh"],setup(K,{emit:i}){const f=i,q=y(null),h=y(!1),r=y(!1),C=y(0),u=y(0),_=R(()=>r.value?Q*.6:Math.min(u.value*.5,X*.5)),L=R(()=>r.value?0:Math.min(u.value*.4,X*.4)-40),w=R(()=>r.value?1:Math.min(u.value/Q,1)),A=R(()=>u.value>=Q);function m(){return window.scrollY<=0}function V(S){!m()||r.value||(C.value=S.touches[0].clientY,h.value=!0)}function k(S){if(!h.value||r.value)return;const Y=S.touches[0].clientY-C.value;Y>0?u.value=Y:(h.value=!1,u.value=0)}function E(){h.value&&(A.value?(r.value=!0,u.value=0,f("refresh",j)):u.value=0,h.value=!1)}function j(){r.value=!1,u.value=0}return(S,Y)=>(d(),c("div",{class:"pull-refresh-wrapper",ref_key:"wrapper",ref:q,onTouchstartPassive:V,onTouchmovePassive:k,onTouchendPassive:E},[t("div",{class:o(["pull-indicator",{active:h.value,refreshing:r.value}]),style:z({transform:`translateY(${L.value}px)`,opacity:w.value})},[t("i",{class:o(r.value?"fas fa-spinner fa-spin":"fas fa-arrow-down"),style:z({transform:A.value?"rotate(180deg)":""})},null,6),t("span",null,v(r.value?"Refreshing...":A.value?"Release to refresh":"Pull to refresh"),1)],6),t("div",{class:"pull-content",style:z({transform:`translateY(${_.value}px)`})},[W(S.$slots,"default",{},void 0)],4)],544))}},ut=J(rt,[["__scopeId","data-v-d1c2085f"]]),dt={class:"music-container"},ct={class:"podcasts-section podcasts-featured-section"},vt={class:"podcasts-section-header podcasts-featured-header"},pt={class:"podcast-filter-chips"},ft=["onClick"],mt={class:"podcast-shows-dropdown-mobile"},bt=["value"],yt={class:"music-header-toolbar"},ht={class:"search-bar music-toolbar-search"},_t={class:"view-options"},kt={class:"music-list"},gt={class:"music-table-wrap"},Ct={class:"music-table"},wt=["onClick"],Tt={class:"col-art"},Pt={class:"music-table-art-wrap"},$t=["src","alt"],St=["aria-label","onClick"],At={class:"col-title-artist"},Mt={class:"music-track-meta"},xt={class:"title-text"},Bt={class:"music-track-artist"},Dt={class:"col-duration"},Rt={class:"col-plays"},qt={class:"col-action"},Lt=["onClick"],Vt=["aria-pressed","onClick"],Et={class:"music-mobile-list"},Yt=["onClick"],Nt={class:"music-mobile-art"},jt=["src","alt"],zt=["aria-label","onClick"],Ft={class:"music-mobile-meta"},Ut={class:"music-mobile-title"},Qt={class:"music-mobile-artist"},It={class:"music-mobile-right"},Ht={class:"music-mobile-duration"},Ot={class:"music-mobile-actions"},Gt=["title","aria-label","onClick"],Xt=["onClick"],Jt=["aria-pressed","onClick"],Kt={class:"music-grid"},Wt=["onClick"],Zt=["src","alt"],ts={class:"track-overlay"},ss=["onClick"],es=["onClick"],as=["title","onClick"],ls={class:"track-title"},is={class:"track-artist"},os={class:"track-duration"},ns={key:0,class:"music-grid"},rs={key:1,class:"empty-state"},us={__name:"MusicView",setup(K){ot();const i=Z(),f=tt();function q(a){f.toggle({type:"track",id:a.id,title:a.title,cover_art:a.cover_art})}function h(a){const s=a&&(a.cover_art||a.artwork);return typeof s=="string"&&s.trim()?s:"/static/img/default-cover.jpg"}const r=y([]),C=y(!0),u=y(""),_=y(""),L=y("plays"),w=y("list"),A=R(()=>{const a=new Set;for(const s of r.value)s.artist&&a.add(s.artist);return Array.from(a).sort()}),m=R(()=>{let a=[...r.value];if(u.value){const s=u.value.toLowerCase();a=a.filter(n=>(n.title||"").toLowerCase().includes(s)||(n.artist||"").toLowerCase().includes(s)||(n.album||"").toLowerCase().includes(s))}return _.value&&(a=a.filter(s=>s.artist===_.value)),a.sort((s,n)=>{switch(L.value){case"title":return(s.title||"").localeCompare(n.title||"");case"artist":return(s.artist||"").localeCompare(n.artist||"");case"added_date":return new Date(n.added_date||0)-new Date(s.added_date||0);case"plays":return(n.play_count||0)-(s.play_count||0);default:return 0}}),a});function V(a){if(!a&&a!==0)return"0:00";const s=Math.floor(Number(a)/60),n=Math.floor(Number(a)%60);return`${s}:${n.toString().padStart(2,"0")}`}function k(a){var e;const s=m.value,n=s[a];if(n){if(((e=i.currentTrack)==null?void 0:e.id)===n.id&&i.isPlaying){i.pause();return}i.setQueue(s,a)}}function E(a){i.addToQueue({type:"track",id:a.id,title:a.title,artist:a.artist,cover_art:a.cover_art,duration_seconds:a.duration_seconds})}function j(){if(m.value.length===0)return;const a=Math.floor(Math.random()*m.value.length);k(a)}async function S(){C.value=!0;try{const a=await G("/api/music?t="+Date.now());r.value=a.tracks||[]}catch{r.value=[]}C.value=!1}async function Y(a){try{const s=await G("/api/music?t="+Date.now());r.value=s.tracks||[]}catch{}a()}return st(S),(a,s)=>{const n=nt("router-link");return d(),et(ut,{onRefresh:Y},{default:N(()=>[t("div",dt,[s[27]||(s[27]=t("section",{class:"podcasts-hero"},[t("div",{class:"podcasts-hero-inner"},[t("h1",null,[t("i",{class:"fas fa-music","aria-hidden":"true"}),at(" Music Library ")]),t("p",null,"Explore")])],-1)),t("section",ct,[t("div",vt,[s[12]||(s[12]=t("div",null,[t("h2",null,"Tracks"),t("p",{class:"podcasts-section-subtitle"},"Filter by artist or search. Sort and switch between list and grid.")],-1)),t("div",pt,[t("button",{type:"button",class:o(["podcast-filter-chip",{active:!_.value}]),onClick:s[0]||(s[0]=e=>_.value="")}," All ",2),(d(!0),c(B,null,x(A.value.slice(0,14),e=>(d(),c("button",{key:e,type:"button",class:o(["podcast-filter-chip",{active:_.value===e}]),onClick:g=>_.value=e},v(e),11,ft))),128))])]),t("div",mt,[D(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>_.value=e),class:"podcast-show-select","aria-label":"Filter by artist"},[s[13]||(s[13]=t("option",{value:""},"All Artists",-1)),(d(!0),c(B,null,x(A.value,e=>(d(),c("option",{key:e,value:e},v(e),9,bt))),128))],512),[[O,_.value]])]),t("div",yt,[t("div",ht,[s[15]||(s[15]=t("i",{class:"fas fa-search","aria-hidden":"true"},null,-1)),D(t("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>u.value=e),type:"text",class:"search-input",placeholder:"Search music...","aria-label":"Search music"},null,512),[[lt,u.value]]),D(t("button",{type:"button",class:"search-clear","aria-label":"Clear search",onClick:s[3]||(s[3]=e=>u.value="")},[...s[14]||(s[14]=[t("i",{class:"fas fa-times","aria-hidden":"true"},null,-1)])],512),[[F,u.value]])]),D(t("select",{"onUpdate:modelValue":s[4]||(s[4]=e=>L.value=e),class:"music-toolbar-sort","aria-label":"Sort music"},[...s[16]||(s[16]=[t("option",{value:"title"},"Title",-1),t("option",{value:"artist"},"Artist",-1),t("option",{value:"plays"},"Plays",-1),t("option",{value:"added_date"},"Date Added",-1)])],512),[[O,L.value]]),t("div",_t,[t("button",{type:"button",class:o(["view-btn",{active:w.value==="grid"}]),"aria-label":"Grid view",onClick:s[5]||(s[5]=e=>w.value="grid")},[...s[17]||(s[17]=[t("i",{class:"fas fa-th","aria-hidden":"true"},null,-1)])],2),t("button",{type:"button",class:o(["view-btn",{active:w.value==="list"}]),"aria-label":"List view",onClick:s[6]||(s[6]=e=>w.value="list")},[...s[18]||(s[18]=[t("i",{class:"fas fa-list","aria-hidden":"true"},null,-1)])],2)]),t("button",{type:"button",class:"episode-btn music-toolbar-play",title:"Play Random",onClick:j},[...s[19]||(s[19]=[t("i",{class:"fas fa-random","aria-hidden":"true"},null,-1),t("span",{class:"sr-only"},"Play Random",-1)])])])]),D(t("div",kt,[t("div",gt,[t("table",Ct,[s[22]||(s[22]=t("thead",null,[t("tr",null,[t("th",{class:"col-art"},"Album"),t("th",{class:"col-title-artist"},"Track"),t("th",{class:"col-duration"},"Duration"),t("th",{class:"col-plays col-plays-header"},"Plays"),t("th",{class:"col-action","aria-label":"Actions"})])],-1)),t("tbody",null,[(d(!0),c(B,null,x(m.value,(e,g)=>{var T,P,b;return d(),c("tr",{key:e.id,class:o(["music-table-row",{playing:((T=l(i).currentTrack)==null?void 0:T.id)===e.id}]),onClick:$=>k(g)},[t("td",Tt,[t("div",Pt,[t("img",{class:"music-table-art",src:h(e),alt:e.title,loading:"lazy",onError:s[7]||(s[7]=$=>$.target.src="/static/img/default-cover.jpg")},null,40,$t),t("button",{type:"button",class:"music-table-art-play","aria-label":((P=l(i).currentTrack)==null?void 0:P.id)===e.id&&l(i).isPlaying?"Pause":"Play",onClick:p($=>k(g),["stop"])},[t("i",{class:o(((b=l(i).currentTrack)==null?void 0:b.id)===e.id&&l(i).isPlaying?"fas fa-pause":"fas fa-play"),"aria-hidden":"true"},null,2)],8,St)])]),t("td",At,[t("div",Mt,[U(n,{to:`/music/${e.id}`,class:"title-link",onClick:s[8]||(s[8]=p(()=>{},["stop"]))},{default:N(()=>[t("span",xt,v(e.title),1)]),_:2},1032,["to"]),t("span",Bt,v(e.artist),1)])]),t("td",Dt,v(V(e.duration_seconds)),1),t("td",Rt,v(e.play_count||0),1),t("td",qt,[t("button",{type:"button",class:"episode-btn queue-btn",title:"Add to queue","aria-label":"Add to queue",onClick:p($=>E(e),["stop"])},[...s[20]||(s[20]=[t("i",{class:"fas fa-plus","aria-hidden":"true"},null,-1),t("span",{class:"sr-only"},"Add to queue",-1)])],8,Lt),t("button",{type:"button",class:o(["episode-btn bm-btn",{bookmarked:l(f).isBookmarked({id:e.id})}]),"aria-pressed":l(f).isBookmarked({id:e.id}),title:"Save",onClick:p($=>q(e),["stop"])},[t("i",{class:o(l(f).isBookmarked({id:e.id})?"fas fa-bookmark":"far fa-bookmark"),"aria-hidden":"true"},null,2),s[21]||(s[21]=t("span",{class:"sr-only"},"Save",-1))],10,Vt)])],10,wt)}),128))])])]),t("div",Et,[(d(!0),c(B,null,x(m.value,(e,g)=>{var T,P,b,$,I,H;return d(),c("div",{key:"mobile-"+e.id,class:o(["music-mobile-row",{playing:((T=l(i).currentTrack)==null?void 0:T.id)===e.id}]),onClick:M=>k(g)},[t("div",Nt,[t("img",{class:"music-mobile-art-img",src:h(e),alt:e.title,loading:"lazy",onError:s[9]||(s[9]=M=>M.target.src="/static/img/default-cover.jpg")},null,40,jt),t("button",{type:"button",class:"music-mobile-art-play","aria-label":((P=l(i).currentTrack)==null?void 0:P.id)===e.id&&l(i).isPlaying?"Pause":"Play",onClick:p(M=>k(g),["stop"])},[t("i",{class:o(((b=l(i).currentTrack)==null?void 0:b.id)===e.id&&l(i).isPlaying?"fas fa-pause":"fas fa-play"),"aria-hidden":"true"},null,2)],8,zt)]),t("div",Ft,[U(n,{to:`/music/${e.id}`,class:"music-mobile-title-link",onClick:s[10]||(s[10]=p(()=>{},["stop"]))},{default:N(()=>[t("span",Ut,v(e.title),1)]),_:2},1032,["to"]),t("span",Qt,v(e.artist),1)]),t("div",It,[t("div",Ht,v(V(e.duration_seconds)),1),t("div",Ot,[t("button",{type:"button",class:"episode-btn music-mobile-btn music-mobile-play-btn",title:(($=l(i).currentTrack)==null?void 0:$.id)===e.id&&l(i).isPlaying?"Pause":"Play","aria-label":((I=l(i).currentTrack)==null?void 0:I.id)===e.id&&l(i).isPlaying?"Pause":"Play",onClick:p(M=>k(g),["stop"])},[t("i",{class:o(((H=l(i).currentTrack)==null?void 0:H.id)===e.id&&l(i).isPlaying?"fas fa-pause":"fas fa-play"),"aria-hidden":"true"},null,2)],8,Gt),t("button",{type:"button",class:"episode-btn queue-btn music-mobile-btn",title:"Add to queue","aria-label":"Add to queue",onClick:p(M=>E(e),["stop"])},[...s[23]||(s[23]=[t("i",{class:"fas fa-plus","aria-hidden":"true"},null,-1)])],8,Xt),t("button",{type:"button",class:o(["episode-btn bm-btn music-mobile-btn",{bookmarked:l(f).isBookmarked({id:e.id})}]),"aria-pressed":l(f).isBookmarked({id:e.id}),title:"Save",onClick:p(M=>q(e),["stop"])},[t("i",{class:o(l(f).isBookmarked({id:e.id})?"fas fa-bookmark":"far fa-bookmark"),"aria-hidden":"true"},null,2)],10,Jt)])])],10,Yt)}),128))])],512),[[F,w.value==="list"&&!C.value&&m.value.length>0]]),D(t("div",Kt,[(d(!0),c(B,null,x(m.value,(e,g)=>{var T,P;return d(),c("div",{key:e.id,class:o(["track-card",{playing:((T=l(i).currentTrack)==null?void 0:T.id)===e.id}])},[t("div",{class:"track-cover",onClick:b=>k(g)},[t("img",{src:h(e),alt:e.title,loading:"lazy",onError:s[11]||(s[11]=b=>b.target.src="/static/img/default-cover.jpg")},null,40,Zt),t("div",ts,[t("button",{type:"button",class:"play-btn",onClick:p(b=>k(g),["stop"])},[t("i",{class:o(((P=l(i).currentTrack)==null?void 0:P.id)===e.id&&l(i).isPlaying?"fas fa-pause":"fas fa-play")},null,2)],8,ss),t("button",{type:"button",class:"track-overlay-btn add-to-playlist-btn",title:"Add to queue",onClick:p(b=>E(e),["stop"])},[...s[24]||(s[24]=[t("i",{class:"fas fa-plus"},null,-1)])],8,es),t("button",{type:"button",class:"track-overlay-btn bm-btn",title:l(f).isBookmarked({id:e.id})?"Unsave":"Save",onClick:p(b=>q(e),["stop"])},[t("i",{class:o(l(f).isBookmarked({id:e.id})?"fas fa-bookmark":"far fa-bookmark"),"aria-hidden":"true"},null,2)],8,as)])],8,Wt),U(n,{to:`/music/${e.id}`,class:"track-info",style:{"text-decoration":"none",color:"inherit"}},{default:N(()=>[t("div",ls,v(e.title),1),t("div",is,v(e.artist),1),t("div",os,v(V(e.duration_seconds)),1)]),_:2},1032,["to"])],2)}),128))],512),[[F,w.value==="grid"&&!C.value&&m.value.length>0]]),C.value?(d(),c("div",ns,[(d(),c(B,null,x(8,e=>t("div",{key:e,class:"track-card"},[...s[25]||(s[25]=[t("div",{class:"track-cover skeleton"},null,-1),t("div",{class:"track-info"},[t("div",{class:"skeleton",style:{height:"14px",width:"60%","margin-bottom":"6px"}}),t("div",{class:"skeleton",style:{height:"12px",width:"40%","margin-bottom":"4px"}}),t("div",{class:"skeleton",style:{height:"10px",width:"36px"}})],-1)])])),64))])):!C.value&&m.value.length===0?(d(),c("div",rs,[...s[26]||(s[26]=[t("i",{class:"fas fa-music"},null,-1),t("h3",null,"No music found",-1),t("p",null,"Try adjusting your filters or search terms",-1)])])):it("",!0)])]),_:1})}}},cs=J(us,[["__scopeId","data-v-851d6bc9"]]);export{cs as default};
