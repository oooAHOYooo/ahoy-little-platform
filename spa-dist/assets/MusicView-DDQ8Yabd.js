import{_ as x,c as d,d as c,e,C as U,n as f,t as p,D as z,q as V,m as _,F as q,r as Q,i as B,f as Z,u as te,z as se,o as ae,y as le,k as O,j as Y,l as X,v as J,E as K,s as ie,p as oe,B as r,h as g}from"./index-B7urDTQW.js";const j=70,W=120,ne={__name:"PullRefresh",emits:["refresh"],setup(u,{emit:n}){const v=n,S=_(null),y=_(!1),m=_(!1),h=_(0),i=_(0),l=V(()=>m.value?j*.6:Math.min(i.value*.5,W*.5)),o=V(()=>m.value?0:Math.min(i.value*.4,W*.4)-40),C=V(()=>m.value?1:Math.min(i.value/j,1)),N=V(()=>i.value>=j);function F(){return window.scrollY<=0}function k(L){!F()||m.value||(h.value=L.touches[0].clientY,y.value=!0)}function R(L){if(!y.value||m.value)return;const I=L.touches[0].clientY-h.value;I>0?i.value=I:(y.value=!1,i.value=0)}function $(){y.value&&(N.value?(m.value=!0,i.value=0,v("refresh",E)):i.value=0,y.value=!1)}function E(){m.value=!1,i.value=0}return(L,I)=>(d(),c("div",{class:"pull-refresh-wrapper",ref_key:"wrapper",ref:S,onTouchstartPassive:k,onTouchmovePassive:R,onTouchendPassive:$},[e("div",{class:f(["pull-indicator",{active:y.value,refreshing:m.value}]),style:U({transform:`translateY(${o.value}px)`,opacity:C.value})},[e("i",{class:f(m.value?"fas fa-spinner fa-spin":"fas fa-arrow-down"),style:U({transform:N.value?"rotate(180deg)":""})},null,6),e("span",null,p(m.value?"Refreshing...":N.value?"Release to refresh":"Pull to refresh"),1)],6),e("div",{class:"pull-content",style:U({transform:`translateY(${l.value}px)`})},[z(L.$slots,"default",{},void 0)],4)],544))}},re=x(ne,[["__scopeId","data-v-d1c2085f"]]),ue={class:"sub-menu-filter-glass"},de={class:"sub-menu-filter-strip"},ce=["aria-pressed"],ve={key:0,class:"sub-menu-filter-chip-label"},fe=["aria-pressed","aria-label","onClick"],me=["src","alt"],be={key:1,class:"sub-menu-filter-chip-avatar sub-menu-filter-chip-avatar-placeholder"},pe={class:"sub-menu-filter-chip-label"},ye={key:0,class:"sub-menu-filter-search"},he=["value","placeholder","aria-label"],ge=["value","aria-label"],ke=["value"],we={key:2,class:"sub-menu-filter-view"},_e={__name:"SubMenuFilter",props:{modelValue:{type:[String,Number],default:""},filters:{type:Array,default:()=>[]},allValue:{type:[String,Number],default:""},filterAllLabel:{type:String,default:"All"},showSearch:{type:Boolean,default:!1},searchPlaceholder:{type:String,default:"Search…"},searchQuery:{type:String,default:""},sortOptions:{type:Array,default:()=>[]},sortLabel:{type:String,default:"Sort"},sortBy:{type:String,default:""},showViewToggle:{type:Boolean,default:!1},viewMode:{type:String,default:"list"},actionLabel:{type:String,default:""},actionIcon:{type:String,default:""}},emits:["update:modelValue","update:searchQuery","update:sortBy","update:viewMode","action"],setup(u,{emit:n}){const v=u,S=n,y=V({get:()=>v.modelValue,set:i=>S("update:modelValue",i)}),m=V(()=>v.showSearch||v.sortOptions&&v.sortOptions.length||v.showViewToggle||v.actionLabel||v.actionIcon&&!v.actionLabel);function h(i){S("update:modelValue",i)}return(i,l)=>(d(),c("div",{class:f(["sub-menu-filter",{"has-toolbar":m.value}])},[e("div",ue,[e("div",de,[e("button",{type:"button",class:f(["sub-menu-filter-chip",{active:y.value===u.allValue}]),"aria-pressed":y.value===u.allValue,onClick:l[0]||(l[0]=o=>h(u.allValue))},[u.filterAllLabel?(d(),c("span",ve,p(u.filterAllLabel),1)):z(i.$slots,"all-label",{key:1},()=>[l[8]||(l[8]=Z("All",-1))])],10,ce),(d(!0),c(q,null,Q(u.filters,o=>(d(),c("button",{key:String(o.value),type:"button",class:f(["sub-menu-filter-chip",{active:y.value===o.value}]),"aria-pressed":y.value===o.value,"aria-label":o.label,onClick:C=>h(o.value)},[o.image?(d(),c("img",{key:0,src:o.image,alt:o.label,class:"sub-menu-filter-chip-avatar",loading:"lazy",onError:l[1]||(l[1]=C=>C.target.style.display="none")},null,40,me)):(d(),c("span",be,p((o.label||"").charAt(0).toUpperCase()),1)),e("span",pe,p(o.label),1)],10,fe))),128))]),m.value?(d(),c(q,{key:0},[u.showSearch?(d(),c("div",ye,[l[10]||(l[10]=e("i",{class:"fas fa-search","aria-hidden":"true"},null,-1)),e("input",{value:u.searchQuery,type:"text",class:"sub-menu-filter-search-input",placeholder:u.searchPlaceholder,"aria-label":u.searchPlaceholder,onInput:l[2]||(l[2]=o=>i.$emit("update:searchQuery",o.target.value))},null,40,he),u.searchQuery?(d(),c("button",{key:0,type:"button",class:"sub-menu-filter-search-clear","aria-label":"Clear search",onClick:l[3]||(l[3]=o=>i.$emit("update:searchQuery",""))},[...l[9]||(l[9]=[e("i",{class:"fas fa-times","aria-hidden":"true"},null,-1)])])):B("",!0)])):B("",!0),u.sortOptions&&u.sortOptions.length?(d(),c("select",{key:1,value:u.sortBy,class:"sub-menu-filter-sort","aria-label":u.sortLabel,onChange:l[4]||(l[4]=o=>i.$emit("update:sortBy",o.target.value))},[(d(!0),c(q,null,Q(u.sortOptions,o=>(d(),c("option",{key:o.value,value:o.value},p(o.label),9,ke))),128))],40,ge)):B("",!0),u.showViewToggle?(d(),c("div",we,[e("button",{type:"button",class:f(["sub-menu-filter-view-btn",{active:u.viewMode==="grid"}]),"aria-label":"Grid view",onClick:l[5]||(l[5]=o=>i.$emit("update:viewMode","grid"))},[...l[11]||(l[11]=[e("i",{class:"fas fa-th","aria-hidden":"true"},null,-1)])],2),e("button",{type:"button",class:f(["sub-menu-filter-view-btn",{active:u.viewMode==="list"}]),"aria-label":"List view",onClick:l[6]||(l[6]=o=>i.$emit("update:viewMode","list"))},[...l[12]||(l[12]=[e("i",{class:"fas fa-list","aria-hidden":"true"},null,-1)])],2)])):B("",!0),z(i.$slots,"toolbar-right",{},void 0),u.actionLabel||i.$slots.action?(d(),c("button",{key:3,type:"button",class:"sub-menu-filter-action",onClick:l[7]||(l[7]=o=>i.$emit("action"))},[z(i.$slots,"action",{},()=>[u.actionIcon?(d(),c("i",{key:0,class:f(u.actionIcon),"aria-hidden":"true"},null,2)):B("",!0),e("span",null,p(u.actionLabel),1)])])):B("",!0)],64)):B("",!0)])],2))}},$e=x(_e,[["__scopeId","data-v-1ee4da21"]]),Ce={class:"music-container"},Te={class:"music-library-section"},Se={class:"music-list"},Pe={class:"music-table-wrap"},Ae={class:"music-table"},Me=["onClick"],Be={class:"col-art"},Ve={class:"music-table-art-wrap"},Le=["src","alt"],qe=["aria-label","onClick"],De={class:"col-title-artist"},Qe={class:"music-track-meta"},Ne={class:"title-text"},Re={class:"music-track-artist"},Ee={class:"col-duration"},Ie={class:"col-plays"},Oe={class:"col-action"},Ye=["onClick"],ze=["aria-pressed","onClick"],Fe={class:"music-mobile-list"},Ue=["onClick"],je={class:"music-mobile-art"},xe=["src","alt"],He=["aria-label","onClick"],Ge={class:"music-mobile-meta"},Xe={class:"music-mobile-title"},Je={class:"music-mobile-artist"},Ke={class:"music-mobile-right"},We={class:"music-mobile-duration"},Ze={class:"music-mobile-actions"},et=["title","aria-label","onClick"],tt=["onClick"],st=["aria-pressed","onClick"],at={class:"music-grid"},lt=["onClick"],it=["src","alt"],ot={class:"track-overlay"},nt=["onClick"],rt=["onClick"],ut=["title","onClick"],dt={class:"track-title"},ct={class:"track-artist"},vt={class:"track-duration"},ft={key:0,class:"music-grid"},mt={key:1,class:"empty-state"},bt={__name:"MusicView",setup(u){ie();const n=te(),v=se();function S(a){v.toggle({type:"track",id:a.id,title:a.title,cover_art:a.cover_art})}function y(a){const t=a&&(a.cover_art||a.artwork);return typeof t=="string"&&t.trim()?t:"/static/img/default-cover.jpg"}const m=_([]),h=_(!0),i=_(""),l=_(""),o=_("plays"),C=_("list"),N=V(()=>{const a=new Map;for(const t of m.value)t.artist&&(a.has(t.artist)||a.set(t.artist,{value:t.artist,label:t.artist,image:t.cover_art||t.artwork||null}));return Array.from(a.values()).sort((t,b)=>(t.label||"").localeCompare(b.label||""))}),F=[{value:"title",label:"Title"},{value:"artist",label:"Artist"},{value:"plays",label:"Plays"},{value:"added_date",label:"Date Added"}],k=V(()=>{let a=[...m.value];if(i.value){const t=i.value.toLowerCase();a=a.filter(b=>(b.title||"").toLowerCase().includes(t)||(b.artist||"").toLowerCase().includes(t)||(b.album||"").toLowerCase().includes(t))}return l.value&&(a=a.filter(t=>t.artist===l.value)),a.sort((t,b)=>{switch(o.value){case"title":return(t.title||"").localeCompare(b.title||"");case"artist":return(t.artist||"").localeCompare(b.artist||"");case"added_date":return new Date(b.added_date||0)-new Date(t.added_date||0);case"plays":return(b.play_count||0)-(t.play_count||0);default:return 0}}),a});function R(a){if(!a&&a!==0)return"0:00";const t=Math.floor(Number(a)/60),b=Math.floor(Number(a)%60);return`${t}:${b.toString().padStart(2,"0")}`}function $(a){var s;const t=k.value,b=t[a];if(b){if(((s=n.currentTrack)==null?void 0:s.id)===b.id&&n.isPlaying){n.pause();return}n.setQueue(t,a)}}function E(a){n.addToQueue({type:"track",id:a.id,title:a.title,artist:a.artist,cover_art:a.cover_art,duration_seconds:a.duration_seconds})}function L(){if(k.value.length===0)return;const a=Math.floor(Math.random()*k.value.length);$(a)}async function I(){h.value=!0;try{const a=await K("/api/music?t="+Date.now());m.value=a.tracks||[]}catch{m.value=[]}h.value=!1}async function ee(a){try{const t=await K("/api/music?t="+Date.now());m.value=t.tracks||[]}catch{}a()}return ae(I),(a,t)=>{const b=oe("router-link");return d(),le(re,{onRefresh:ee},{default:O(()=>[e("div",Ce,[t[17]||(t[17]=e("section",{class:"podcasts-hero"},[e("div",{class:"podcasts-hero-inner"},[e("h1",null,[e("i",{class:"fas fa-music","aria-hidden":"true"}),Z(" Music Library ")]),e("p",null,"Explore")])],-1)),e("section",Te,[Y($e,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=s=>l.value=s),filters:N.value,"all-value":"","filter-all-label":"All Artists","show-search":!0,"search-placeholder":"Search music…","search-query":i.value,"onUpdate:searchQuery":t[1]||(t[1]=s=>i.value=s),"sort-options":F,"sort-label":"Sort","sort-by":o.value,"onUpdate:sortBy":t[2]||(t[2]=s=>o.value=s),"show-view-toggle":!0,"view-mode":C.value,"onUpdate:viewMode":t[3]||(t[3]=s=>C.value=s),onAction:L},{action:O(()=>[...t[9]||(t[9]=[e("i",{class:"fas fa-random","aria-hidden":"true"},null,-1)])]),_:1},8,["modelValue","filters","search-query","sort-by","view-mode"])]),X(e("div",Se,[e("div",Pe,[e("table",Ae,[t[12]||(t[12]=e("thead",null,[e("tr",null,[e("th",{class:"col-art"},"Album"),e("th",{class:"col-title-artist"},"Track"),e("th",{class:"col-duration"},"Duration"),e("th",{class:"col-plays col-plays-header"},"Plays"),e("th",{class:"col-action","aria-label":"Actions"})])],-1)),e("tbody",null,[(d(!0),c(q,null,Q(k.value,(s,T)=>{var P,A,w;return d(),c("tr",{key:s.id,class:f(["music-table-row",{playing:((P=r(n).currentTrack)==null?void 0:P.id)===s.id}]),onClick:M=>$(T)},[e("td",Be,[e("div",Ve,[e("img",{class:"music-table-art",src:y(s),alt:s.title,loading:"lazy",onError:t[4]||(t[4]=M=>M.target.src="/static/img/default-cover.jpg")},null,40,Le),e("button",{type:"button",class:"music-table-art-play","aria-label":((A=r(n).currentTrack)==null?void 0:A.id)===s.id&&r(n).isPlaying?"Pause":"Play",onClick:g(M=>$(T),["stop"])},[e("i",{class:f(((w=r(n).currentTrack)==null?void 0:w.id)===s.id&&r(n).isPlaying?"fas fa-pause":"fas fa-play"),"aria-hidden":"true"},null,2)],8,qe)])]),e("td",De,[e("div",Qe,[Y(b,{to:`/music/${s.id}`,class:"title-link",onClick:t[5]||(t[5]=g(()=>{},["stop"]))},{default:O(()=>[e("span",Ne,p(s.title),1)]),_:2},1032,["to"]),e("span",Re,p(s.artist),1)])]),e("td",Ee,p(R(s.duration_seconds)),1),e("td",Ie,p(s.play_count||0),1),e("td",Oe,[e("button",{type:"button",class:"episode-btn queue-btn",title:"Add to queue","aria-label":"Add to queue",onClick:g(M=>E(s),["stop"])},[...t[10]||(t[10]=[e("i",{class:"fas fa-plus","aria-hidden":"true"},null,-1),e("span",{class:"sr-only"},"Add to queue",-1)])],8,Ye),e("button",{type:"button",class:f(["episode-btn bm-btn",{bookmarked:r(v).isBookmarked({id:s.id})}]),"aria-pressed":r(v).isBookmarked({id:s.id}),title:"Save",onClick:g(M=>S(s),["stop"])},[e("i",{class:f(r(v).isBookmarked({id:s.id})?"fas fa-bookmark":"far fa-bookmark"),"aria-hidden":"true"},null,2),t[11]||(t[11]=e("span",{class:"sr-only"},"Save",-1))],10,ze)])],10,Me)}),128))])])]),e("div",Fe,[(d(!0),c(q,null,Q(k.value,(s,T)=>{var P,A,w,M,H,G;return d(),c("div",{key:"mobile-"+s.id,class:f(["music-mobile-row",{playing:((P=r(n).currentTrack)==null?void 0:P.id)===s.id}]),onClick:D=>$(T)},[e("div",je,[e("img",{class:"music-mobile-art-img",src:y(s),alt:s.title,loading:"lazy",onError:t[6]||(t[6]=D=>D.target.src="/static/img/default-cover.jpg")},null,40,xe),e("button",{type:"button",class:"music-mobile-art-play","aria-label":((A=r(n).currentTrack)==null?void 0:A.id)===s.id&&r(n).isPlaying?"Pause":"Play",onClick:g(D=>$(T),["stop"])},[e("i",{class:f(((w=r(n).currentTrack)==null?void 0:w.id)===s.id&&r(n).isPlaying?"fas fa-pause":"fas fa-play"),"aria-hidden":"true"},null,2)],8,He)]),e("div",Ge,[Y(b,{to:`/music/${s.id}`,class:"music-mobile-title-link",onClick:t[7]||(t[7]=g(()=>{},["stop"]))},{default:O(()=>[e("span",Xe,p(s.title),1)]),_:2},1032,["to"]),e("span",Je,p(s.artist),1)]),e("div",Ke,[e("div",We,p(R(s.duration_seconds)),1),e("div",Ze,[e("button",{type:"button",class:"episode-btn music-mobile-btn music-mobile-play-btn",title:((M=r(n).currentTrack)==null?void 0:M.id)===s.id&&r(n).isPlaying?"Pause":"Play","aria-label":((H=r(n).currentTrack)==null?void 0:H.id)===s.id&&r(n).isPlaying?"Pause":"Play",onClick:g(D=>$(T),["stop"])},[e("i",{class:f(((G=r(n).currentTrack)==null?void 0:G.id)===s.id&&r(n).isPlaying?"fas fa-pause":"fas fa-play"),"aria-hidden":"true"},null,2)],8,et),e("button",{type:"button",class:"episode-btn queue-btn music-mobile-btn",title:"Add to queue","aria-label":"Add to queue",onClick:g(D=>E(s),["stop"])},[...t[13]||(t[13]=[e("i",{class:"fas fa-plus","aria-hidden":"true"},null,-1)])],8,tt),e("button",{type:"button",class:f(["episode-btn bm-btn music-mobile-btn",{bookmarked:r(v).isBookmarked({id:s.id})}]),"aria-pressed":r(v).isBookmarked({id:s.id}),title:"Save",onClick:g(D=>S(s),["stop"])},[e("i",{class:f(r(v).isBookmarked({id:s.id})?"fas fa-bookmark":"far fa-bookmark"),"aria-hidden":"true"},null,2)],10,st)])])],10,Ue)}),128))])],512),[[J,C.value==="list"&&!h.value&&k.value.length>0]]),X(e("div",at,[(d(!0),c(q,null,Q(k.value,(s,T)=>{var P,A;return d(),c("div",{key:s.id,class:f(["track-card",{playing:((P=r(n).currentTrack)==null?void 0:P.id)===s.id}])},[e("div",{class:"track-cover",onClick:w=>$(T)},[e("img",{src:y(s),alt:s.title,loading:"lazy",onError:t[8]||(t[8]=w=>w.target.src="/static/img/default-cover.jpg")},null,40,it),e("div",ot,[e("button",{type:"button",class:"play-btn",onClick:g(w=>$(T),["stop"])},[e("i",{class:f(((A=r(n).currentTrack)==null?void 0:A.id)===s.id&&r(n).isPlaying?"fas fa-pause":"fas fa-play")},null,2)],8,nt),e("button",{type:"button",class:"track-overlay-btn add-to-playlist-btn",title:"Add to queue",onClick:g(w=>E(s),["stop"])},[...t[14]||(t[14]=[e("i",{class:"fas fa-plus"},null,-1)])],8,rt),e("button",{type:"button",class:"track-overlay-btn bm-btn",title:r(v).isBookmarked({id:s.id})?"Unsave":"Save",onClick:g(w=>S(s),["stop"])},[e("i",{class:f(r(v).isBookmarked({id:s.id})?"fas fa-bookmark":"far fa-bookmark"),"aria-hidden":"true"},null,2)],8,ut)])],8,lt),Y(b,{to:`/music/${s.id}`,class:"track-info",style:{"text-decoration":"none",color:"inherit"}},{default:O(()=>[e("div",dt,p(s.title),1),e("div",ct,p(s.artist),1),e("div",vt,p(R(s.duration_seconds)),1)]),_:2},1032,["to"])],2)}),128))],512),[[J,C.value==="grid"&&!h.value&&k.value.length>0]]),h.value?(d(),c("div",ft,[(d(),c(q,null,Q(8,s=>e("div",{key:s,class:"track-card"},[...t[15]||(t[15]=[e("div",{class:"track-cover skeleton"},null,-1),e("div",{class:"track-info"},[e("div",{class:"skeleton",style:{height:"14px",width:"60%","margin-bottom":"6px"}}),e("div",{class:"skeleton",style:{height:"12px",width:"40%","margin-bottom":"4px"}}),e("div",{class:"skeleton",style:{height:"10px",width:"36px"}})],-1)])])),64))])):!h.value&&k.value.length===0?(d(),c("div",mt,[...t[16]||(t[16]=[e("i",{class:"fas fa-music"},null,-1),e("h3",null,"No music found",-1),e("p",null,"Try adjusting your filters or search terms",-1)])])):B("",!0)])]),_:1})}}},yt=x(bt,[["__scopeId","data-v-7caac0a9"]]);export{yt as default};
