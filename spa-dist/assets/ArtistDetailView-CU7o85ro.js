import{E as I,m as u,_ as et,n as at,u as ot,p as lt,o as nt,a as j,c as l,d as i,e as t,k as $,F,t as n,l as g,s as b,g as f,f as D,h as z,y as q,w as it,v as rt,N as ut,H as ct,A as w,I as dt,K as vt,r as pt,i as G,M as ft}from"./index-J1hCH1Lh.js";let E=null;function mt(){const v=u(null),S=u(!0),m=u(null);async function p(){if(v.value)return v.value;if(E)return v.value=await E,S.value=!1,v.value;try{const{publishable_key:r}=await I("/api/config/stripe");if(!r)throw new Error("Stripe publishable key not found");return window.Stripe||await new Promise((C,V)=>{const h=document.createElement("script");h.src="https://js.stripe.com/v3/",h.onload=C,h.onerror=V,document.head.appendChild(h)}),E=Promise.resolve(window.Stripe(r)),v.value=await E,v.value}catch(r){m.value=r.message,console.error("Stripe init error:",r)}finally{S.value=!1}}async function N(r,C){return I("/api/boost/stripe/create-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({artist_id:String(r),boost_amount:Number(C)})})}async function T(r){return I("/api/boost/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_intent_id:r})})}return{stripe:v,loading:S,error:m,initStripe:p,createPaymentIntent:N,confirmBoost:T}}const ht={class:"artist-page-container"},_t={key:0,class:"loading-state"},gt={class:"glass-panel artist-hero-panel"},yt={class:"panel-header no-icon"},kt={class:"header-text"},bt={class:"hero-body"},wt={class:"hero-avatar-wrapper"},St=["src","alt"],Ct={class:"hero-info"},xt={key:0,class:"hero-bio"},Bt={class:"hero-actions"},$t={key:0,class:"glass-panel music-panel"},Ft={class:"panel-header"},Tt={class:"header-text"},At={class:"track-list"},Mt=["onClick"],Pt={class:"track-art"},Dt=["src"],Et={class:"track-overlay"},Nt={class:"track-info"},Vt={class:"track-title"},It={class:"track-meta"},jt=["onClick"],zt={key:1,class:"glass-panel video-panel"},Ot={class:"panel-header no-icon"},Lt={class:"header-text"},Ht={class:"video-grid flush-left"},Jt={class:"video-thumb"},Kt=["src"],Qt={class:"video-title"},Rt={key:2,class:"glass-panel similar-artists-panel"},Ut={class:"panel-header no-icon"},qt={class:"header-text"},Gt={class:"artists-grid flush-left"},Wt={class:"artist-thumb"},Xt=["src"],Yt={class:"artist-name"},Zt={key:3,class:"glass-panel empty-panel"},ts={class:"glass-panel boost-modal"},ss={class:"boost-amount-selector"},es=["onClick"],as={class:"custom-amount"},os={class:"fee-breakdown"},ls={class:"fee-item"},ns={class:"fee-item"},is={class:"fee-item"},rs={class:"fee-item total"},us={key:0,class:"boost-error"},cs=["disabled"],ds={key:0,class:"fas fa-spinner fa-spin"},vs={key:1},ps={key:2,class:"loading-state"},fs={__name:"ArtistDetailView",setup(v){const S=ct(),m=at(),p=ot(),{shareArtist:N}=vt(),T=dt(),{initStripe:r,createPaymentIntent:C,confirmBoost:V}=mt(),h=u(!0),o=u(null),A=u([]),O=u([]),L=u([]),y=u(!1),c=u(10),M=u(!1),_=u(null);let k=null;const x=w(()=>o.value?O.value.filter(a=>a.artist===o.value.name||a.artist_id===o.value.id):[]),P=w(()=>o.value?L.value.filter(a=>a.host===o.value.name||a.host_id===o.value.id):[]),H=w(()=>!o.value||!A.value.length?[]:A.value.filter(a=>a.id!==o.value.id&&a.genre===o.value.genre).sort(()=>.5-Math.random())),J=w(()=>{const a=c.value||0;return Math.round((a*.029+.3)*100)/100}),K=w(()=>{const a=c.value||0;return Math.round(a*.075*100)/100}),Q=w(()=>{const a=c.value||0;return Math.round((a+J.value+K.value)*100)/100});function W(a){if(!a)return"";const s=Math.floor(a/60),d=Math.floor(a%60);return`${s}:${d.toString().padStart(2,"0")}`}function X(){T.onBookmark(),p.toggle({...o.value,_type:"artist"})}function Y(){T.light(),N(o.value)}function Z(a){m.setQueue(x.value,a)}async function tt(){if(c.value<1){_.value="Minimum boost is $1";return}M.value=!0,_.value=null;try{const a=await r(),{client_secret:s}=await C(o.value.id,c.value),{error:d,paymentIntent:e}=await a.confirmCardPayment(s,{payment_method:{card:k}});d?_.value=d.message:e.status==="succeeded"&&(await V(e.id),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:`Successfully boosted ${o.value.name}!`,type:"success"}})),y.value=!1)}catch(a){_.value=a.message||"Payment failed"}finally{M.value=!1}}return lt(y,async a=>{if(a){_.value=null;const s=await r();if(!s)return;k=s.elements().create("card",{style:{base:{color:"#ffffff",fontFamily:"Inter, sans-serif",fontSize:"16px","::placeholder":{color:"rgba(255,255,255,0.4)"}}}}),ft(()=>{document.getElementById("stripe-card-element")&&k.mount("#stripe-card-element")})}else k&&(k.destroy(),k=null)}),nt(async()=>{const a=S.params.slug;try{const[s,d,e]=await Promise.all([j("/api/artists").catch(()=>({artists:[]})),j("/api/music").catch(()=>({tracks:[]})),j("/api/shows").catch(()=>({shows:[]}))]);A.value=s.artists||[],O.value=d.tracks||[],L.value=e.shows||[],o.value=A.value.find(B=>B.slug===a||String(B.id)===String(a))||null}catch(s){console.error(s)}finally{h.value=!1}}),(a,s)=>{const d=pt("router-link");return l(),i("div",ht,[h.value?(l(),i("div",_t,[...s[4]||(s[4]=[t("div",{class:"glass-panel text-center"},[t("i",{class:"fas fa-spinner fa-spin"}),$(" Loading Artist... ")],-1)])])):o.value?(l(),i(F,{key:1},[t("section",gt,[t("div",yt,[t("div",kt,[t("h1",null,n(o.value.name),1),t("p",null,n(o.value.genre||"Artist"),1)])]),t("div",bt,[t("div",wt,[t("img",{src:o.value.image||"/static/img/default-avatar.png",alt:o.value.name,class:"hero-avatar"},null,8,St)]),t("div",Ct,[o.value.bio?(l(),i("div",xt,n(o.value.bio),1)):g("",!0),t("div",Bt,[t("button",{class:b(["action-btn btn-follow",{active:f(p).isBookmarked(o.value)}]),onClick:X},[t("i",{class:b(f(p).isBookmarked(o.value)?"fas fa-check-circle":"fas fa-plus-circle")},null,2),$(" "+n(f(p).isBookmarked(o.value)?"Following":"Follow"),1)],2),t("button",{class:"action-btn btn-boost",onClick:s[0]||(s[0]=e=>y.value=!0)},[...s[5]||(s[5]=[t("i",{class:"fas fa-rocket"},null,-1),$(" Boost ",-1)])]),t("button",{class:"action-btn btn-share",onClick:Y},[...s[6]||(s[6]=[t("i",{class:"fas fa-share-nodes"},null,-1),$(" Share ",-1)])])])])])]),x.value.length?(l(),i("section",$t,[t("div",Ft,[s[8]||(s[8]=t("div",{class:"header-icon icon-green"},[t("i",{class:"fas fa-music"})],-1)),t("div",Tt,[s[7]||(s[7]=t("h2",null,"Music",-1)),t("p",null,n(x.value.length)+" Tracks",1)])]),t("div",At,[(l(!0),i(F,null,D(x.value,(e,B)=>{var R,U;return l(),i("div",{key:e.id,class:b(["track-row",{playing:((R=f(m).currentTrack)==null?void 0:R.id)===e.id}]),onClick:st=>Z(B)},[t("div",Pt,[t("img",{src:e.cover_art||"/static/img/default-cover.jpg",loading:"lazy"},null,8,Dt),t("div",Et,[t("i",{class:b(((U=f(m).currentTrack)==null?void 0:U.id)===e.id&&f(m).isPlaying?"fas fa-pause":"fas fa-play")},null,2)])]),t("div",Nt,[t("div",Vt,n(e.title),1),t("div",It,n(W(e.duration_seconds)),1)]),t("button",{class:"track-action",onClick:q(st=>f(p).toggle({...e,_type:"track"}),["stop"])},[t("i",{class:b(f(p).isBookmarked(e)?"fas fa-bookmark":"far fa-bookmark")},null,2)],8,jt)],10,Mt)}),128))])])):g("",!0),P.value.length?(l(),i("section",zt,[t("div",Ot,[t("div",Lt,[s[9]||(s[9]=t("h2",null,"Videos",-1)),t("p",null,n(P.value.length)+" Videos",1)])]),t("div",Ht,[(l(!0),i(F,null,D(P.value,e=>(l(),z(d,{key:e.id,to:`/videos?play=${e.id}`,class:"video-card"},{default:G(()=>[t("div",Jt,[t("img",{src:e.thumbnail||"/static/img/default-cover.jpg",loading:"lazy"},null,8,Kt),s[10]||(s[10]=t("div",{class:"play-overlay"},[t("i",{class:"fas fa-play"})],-1))]),t("div",Qt,n(e.title),1)]),_:2},1032,["to"]))),128))])])):g("",!0),H.value.length?(l(),i("section",Rt,[t("div",Ut,[t("div",qt,[s[11]||(s[11]=t("h2",null,"Similar Artists",-1)),t("p",null,"Discover more like "+n(o.value.name),1)])]),t("div",Gt,[(l(!0),i(F,null,D(H.value.slice(0,4),e=>(l(),z(d,{key:e.id,to:`/artists/${e.slug||e.id}`,class:"artist-card-mini"},{default:G(()=>[t("div",Wt,[t("img",{src:e.image||"/static/img/default-avatar.png",loading:"lazy"},null,8,Xt)]),t("div",Yt,n(e.name),1)]),_:2},1032,["to"]))),128))])])):g("",!0),!x.value.length&&!P.value.length?(l(),i("section",Zt,[...s[12]||(s[12]=[t("i",{class:"fas fa-ghost"},null,-1),t("p",null,"No content found for this artist yet.",-1)])])):g("",!0),(l(),z(ut,{to:"body"},[y.value?(l(),i("div",{key:0,class:"modal-overlay",onClick:s[3]||(s[3]=q(e=>y.value=!1,["self"]))},[t("div",ts,[t("button",{class:"close-modal",onClick:s[1]||(s[1]=e=>y.value=!1)},"Ã—"),t("h2",null,"Boost "+n(o.value.name),1),s[18]||(s[18]=t("p",null,"Support this artist directly with a contribution.",-1)),t("div",ss,[(l(),i(F,null,D([5,10,20,50],e=>t("button",{key:e,onClick:B=>c.value=e,class:b({active:c.value===e})}," $"+n(e),11,es)),64)),t("div",as,[s[13]||(s[13]=t("span",null,"$",-1)),it(t("input",{type:"number","onUpdate:modelValue":s[2]||(s[2]=e=>c.value=e),min:"1",step:"1"},null,512),[[rt,c.value,void 0,{number:!0}]])])]),t("div",os,[t("div",ls,[s[14]||(s[14]=t("span",null,"Boost Amount:",-1)),t("span",null,"$"+n((c.value||0).toFixed(2)),1)]),t("div",ns,[s[15]||(s[15]=t("span",null,"Stripe Fee (2.9% + $0.30):",-1)),t("span",null,"$"+n(J.value.toFixed(2)),1)]),t("div",is,[s[16]||(s[16]=t("span",null,"Platform Fee (7.5%):",-1)),t("span",null,"$"+n(K.value.toFixed(2)),1)]),t("div",rs,[s[17]||(s[17]=t("span",null,"Total Charged:",-1)),t("span",null,"$"+n(Q.value.toFixed(2)),1)])]),s[19]||(s[19]=t("div",{id:"stripe-card-element",class:"stripe-element"},null,-1)),_.value?(l(),i("div",us,n(_.value),1)):g("",!0),t("button",{class:"action-btn btn-boost-submit",disabled:M.value,onClick:tt},[M.value?(l(),i("i",ds)):(l(),i("span",vs,"Confirm $"+n(Q.value.toFixed(2))+" Boost",1))],8,cs),s[20]||(s[20]=t("p",{class:"boost-note"},"Securely processed by Stripe. Boost amount goes directly to the artist.",-1))])])):g("",!0)]))],64)):(l(),i("div",ps,[...s[21]||(s[21]=[t("div",{class:"glass-panel text-center"},[t("i",{class:"fas fa-exclamation-triangle"}),$(" Artist not found ")],-1)])]))])}}},hs=et(fs,[["__scopeId","data-v-bf05824d"]]);export{hs as default};
