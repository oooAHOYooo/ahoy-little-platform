import{_ as J,z as K,u as H,o as q,b as G,c as l,d as r,e as t,t as o,n as k,l as R,v as B,F as g,r as h,j as E,k as T,f as D,q as _,m as w,p as U,h as C,i as X,B as M,L as Y}from"./index-C-wMUvYW.js";const Q={class:"my-saves-container saved-page"},W={class:"saves-profile-hero"},Z={class:"saves-profile-content"},ss={class:"saves-profile-info"},ts={class:"saves-username"},as={class:"saves-stats"},es={class:"saves-stat"},os={class:"saves-stat-number"},ns={class:"saves-stat"},ls={class:"saves-stat-number"},rs={class:"saves-tabs-glass"},is={class:"saves-tab-count"},vs={class:"saves-tab-count"},us={class:"saves-content-glass"},cs={key:0,class:"saves-bookmarks-tab"},ds={class:"saves-filter-pills"},ps=["onClick"],ks={class:"saves-grid"},ys=["onClick"],fs={class:"saves-card-art"},_s=["src","alt"],bs={class:"saves-card-overlay"},gs=["onClick"],hs=["onClick"],ws={class:"saves-type-badge"},Cs={class:"saves-card-info"},ms={key:0,class:"saves-date"},Ss={key:1,class:"saves-empty-glass"},$s={class:"saves-content-glass"},Rs={key:0,class:"saves-recent-list"},Bs=["onClick"],Es={class:"saves-recent-art"},Ts=["src","alt"],Ds={class:"saves-recent-info"},Ms={class:"saves-recent-time"},Ps={class:"saves-recent-actions"},Ns=["title","onClick"],As={key:1,class:"saves-empty-glass"},P="ahoy.recentlyPlayed.v1",Is=50,Ls={__name:"SavedView",setup(Vs){const p=K(),y=H(),m=Y(),c=w("saved"),d=w("all"),v=w([]),u=_(()=>Object.values(p.bookmarks.value)),N=_(()=>{var s,n,e;return u.value.length>=3?"My Collection":((s=m.user.value)==null?void 0:s.display_name)||((e=(n=m.user.value)==null?void 0:n.email)==null?void 0:e.split("@")[0])||"Saved"}),A=_(()=>[...new Set(u.value.map(s=>s.type||"track").filter(Boolean))]),I=_(()=>d.value==="all"?u.value:u.value.filter(a=>(a.type||"track")===d.value));function L(a){return a.id??a.slug??`${a.type}:${a.title}`}function V(a){return a.key??`${a.type||"track"}:${a.id}:${a.played_at||0}`}function x(a){return a?new Date(a).toLocaleDateString():""}function O(a){if(!a)return"";const s=new Date(a),e=new Date-s,i=Math.floor(e/6e4),S=Math.floor(e/36e5),$=Math.floor(e/864e5);return i<1?"Just now":i<60?`${i}m ago`:S<24?`${S}h ago`:$<7?`${$}d ago`:s.toLocaleDateString()}function f(){try{const a=localStorage.getItem(P);v.value=a?JSON.parse(a):[]}catch{v.value=[]}}function j(a){if(!(!a||a.id==null&&a.slug==null))try{const s={id:a.id??a.slug,type:a.type||"track",title:a.title||a.name,artist:a.artist||a.host||"",artwork:a.artwork||a.cover_art||a.thumbnail,audio_url:a.audio_url||a.url,url:a.url||a.audio_url,key:`${a.type||"track"}:${a.id??a.slug}`,played_at:new Date().toISOString()};let n=v.value.filter(e=>e.key!==s.key);n.unshift(s),n=n.slice(0,Is),v.value=n,localStorage.setItem(P,JSON.stringify(n))}catch(s){console.warn("trackRecentPlay failed",s)}}function b(a){var s;j(a),((s=y.currentTrack)==null?void 0:s.id)===a.id&&y.isPlaying?y.pause():y.play(a)}function z(a){p.remove(a),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Removed from bookmarks",type:"success"}}))}function F(a){p.toggle(a),f()}return q(()=>{f(),window.addEventListener("recentlyPlayed:updated",f)}),G(()=>{window.removeEventListener("recentlyPlayed:updated",f)}),(a,s)=>{const n=U("router-link");return l(),r("div",Q,[t("div",W,[s[6]||(s[6]=t("div",{class:"saves-profile-glow"},null,-1)),t("div",Z,[s[5]||(s[5]=t("div",{class:"saves-avatar-wrapper"},[t("div",{class:"saves-avatar-guest"},[t("i",{class:"fas fa-bookmark"})])],-1)),t("div",ss,[t("h1",ts,o(N.value),1),t("div",as,[t("div",es,[t("span",os,o(u.value.length),1),s[3]||(s[3]=t("span",{class:"saves-stat-label"},"Bookmarks",-1))]),t("div",ns,[t("span",ls,o(v.value.length),1),s[4]||(s[4]=t("span",{class:"saves-stat-label"},"Recently Played",-1))])])])])]),t("div",rs,[t("button",{type:"button",class:k([{active:c.value==="saved"},"saves-tab-btn"]),onClick:s[0]||(s[0]=e=>c.value="saved")},[s[7]||(s[7]=t("i",{class:"fas fa-bookmark"},null,-1)),s[8]||(s[8]=t("span",null,"Bookmarks",-1)),t("span",is,o(u.value.length),1)],2),t("button",{type:"button",class:k([{active:c.value==="recent"},"saves-tab-btn"]),onClick:s[1]||(s[1]=e=>c.value="recent")},[s[9]||(s[9]=t("i",{class:"fas fa-history"},null,-1)),s[10]||(s[10]=t("span",null,"Recently Played",-1)),t("span",vs,o(v.value.length),1)],2)]),R(t("div",us,[u.value.length?(l(),r("div",cs,[t("div",ds,[t("button",{type:"button",class:k([{active:d.value==="all"},"saves-pill"]),onClick:s[2]||(s[2]=e=>d.value="all")}," All ",2),(l(!0),r(g,null,h(A.value,e=>(l(),r("button",{key:e,type:"button",class:k([{active:d.value===e},"saves-pill"]),onClick:i=>d.value=e},o(e==="track"?"Tracks":e==="show"?"Shows":e==="artist"?"Artists":e),11,ps))),128))]),t("div",ks,[(l(!0),r(g,null,h(I.value,e=>(l(),r("div",{key:L(e),class:"saves-card",onClick:i=>b(e)},[t("div",fs,[t("img",{src:e.cover_art||e.thumbnail||e.artwork||"/static/img/default-cover.jpg",alt:e.title||e.name,loading:"lazy"},null,8,_s),t("div",bs,[t("button",{type:"button",class:"saves-play-btn",onClick:C(i=>b(e),["stop"])},[...s[11]||(s[11]=[t("i",{class:"fas fa-play"},null,-1)])],8,gs)]),t("button",{type:"button",class:"saves-remove-btn",title:"Remove bookmark",onClick:C(i=>z(e),["stop"])},[...s[12]||(s[12]=[t("i",{class:"fas fa-bookmark"},null,-1)])],8,hs),t("span",ws,o(e.type||"track"),1)]),t("div",Cs,[t("h3",null,o(e.title||e.name||"—"),1),t("p",null,o(e.artist||e.host||""),1),e.added_at?(l(),r("span",ms,o(x(e.added_at)),1)):X("",!0)])],8,ys))),128))])])):(l(),r("div",Ss,[s[14]||(s[14]=t("div",{class:"saves-empty-icon"},[t("i",{class:"fas fa-bookmark"})],-1)),s[15]||(s[15]=t("h3",null,"No bookmarks yet",-1)),s[16]||(s[16]=t("p",null,"Tap the bookmark icon on any track, show, or artist to save it here for easy access.",-1)),E(n,{to:"/shows",class:"saves-cta-btn"},{default:T(()=>[...s[13]||(s[13]=[D("Discover Shows",-1)])]),_:1})]))],512),[[B,c.value==="saved"]]),R(t("div",$s,[v.value.length?(l(),r("div",Rs,[(l(!0),r(g,null,h(v.value,e=>(l(),r("div",{key:V(e),class:"saves-recent-item",onClick:i=>b(e)},[t("div",Es,[t("img",{src:e.artwork||e.cover_art||e.thumbnail||"/static/img/default-cover.jpg",alt:e.title||e.name,loading:"lazy"},null,8,Ts),s[17]||(s[17]=t("div",{class:"saves-recent-play"},[t("i",{class:"fas fa-play"})],-1))]),t("div",Ds,[t("h3",null,o(e.title||e.name||"—"),1),t("p",null,o(e.artist||e.host||""),1),t("span",Ms,o(O(e.played_at)),1)]),t("div",Ps,[t("button",{type:"button",class:k(["saves-action-btn",{bookmarked:M(p).isBookmarked(e)}]),title:M(p).isBookmarked(e)?"Remove bookmark":"Add bookmark",onClick:C(i=>F(e),["stop"])},[...s[18]||(s[18]=[t("i",{class:"fas fa-bookmark"},null,-1)])],10,Ns)])],8,Bs))),128))])):(l(),r("div",As,[s[20]||(s[20]=t("div",{class:"saves-empty-icon"},[t("i",{class:"fas fa-history"})],-1)),s[21]||(s[21]=t("h3",null,"No recent plays",-1)),s[22]||(s[22]=t("p",null,"Content you listen to will appear here so you can easily find it again.",-1)),E(n,{to:"/music",class:"saves-cta-btn"},{default:T(()=>[...s[19]||(s[19]=[D("Browse Music",-1)])]),_:1})]))],512),[[B,c.value==="recent"]])])}}},Os=J(Ls,[["__scopeId","data-v-2d483823"]]);export{Os as default};
