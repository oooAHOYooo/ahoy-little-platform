import{_ as q,z as H,u as J,o as G,b as U,c as n,d as l,B as m,e as t,f as y,j as w,k as C,i as R,t as o,n as k,l as E,v as N,F as $,r as S,N as Y,p as Q,q as b,m as B,s as W,h as T}from"./index-DuL8nq5a.js";const X={class:"my-saves-container saved-page"},Z={key:0,class:"saves-guest-banner"},ss={class:"saves-profile-hero"},ts={class:"saves-profile-content"},es={class:"saves-profile-info"},as={class:"saves-username"},os={class:"saves-stats"},ns={class:"saves-stat"},ls={class:"saves-stat-number"},rs={class:"saves-stat"},is={class:"saves-stat-number"},vs={class:"saves-tabs-glass"},ds={class:"saves-tab-count"},us={class:"saves-tab-count"},cs={class:"saves-content-glass"},ps={key:0,class:"saves-bookmarks-tab"},ys={class:"saves-filter-pills"},ks=["onClick"],fs={class:"saves-grid"},_s=["onClick"],bs={class:"saves-card-art"},gs=["src","alt"],hs={class:"saves-card-overlay"},ms=["onClick"],ws=["onClick"],Cs={class:"saves-type-badge"},$s={class:"saves-card-info"},Ss={key:0,class:"saves-date"},Bs={key:1,class:"saves-empty-glass"},Ts={class:"saves-content-glass"},Ds={key:0,class:"saves-recent-list"},Ms=["onClick"],Ps={class:"saves-recent-art"},Rs=["src","alt"],Es={class:"saves-recent-info"},Ns={class:"saves-recent-meta"},Ls={class:"saves-recent-type"},Vs={class:"saves-recent-time"},xs={class:"saves-recent-actions"},As=["title","onClick"],js={key:1,class:"saves-empty-glass"},zs="ahoy.recentlyPlayed.v1",Is={__name:"SavedView",setup(Fs){const D=W(),p=H(),f=J(),g=Y(),d=B("saved"),u=B("all"),c=B([]),v=b(()=>Object.values(p.bookmarks.value)),L=b(()=>{var s,r,e;return v.value.length>=3?"My Collection":((s=g.user.value)==null?void 0:s.display_name)||((e=(r=g.user.value)==null?void 0:r.email)==null?void 0:e.split("@")[0])||"Saved"}),V=b(()=>[...new Set(v.value.map(s=>s.type||"track").filter(Boolean))]),x=b(()=>u.value==="all"?v.value:v.value.filter(a=>(a.type||"track")===u.value));function A(a){return a.id??a.slug??`${a.type}:${a.title}`}function j(a){return a.key??`${a.type||"track"}:${a.id}:${a.played_at||0}`}function z(a){return a?new Date(a).toLocaleDateString():""}function I(a){const s=a||"track";return s==="live_tv"?"Live TV":s==="show"?"Video":s==="podcast"||s==="episode"?"Podcast":"Music"}function F(a){if(!a)return"";const s=new Date(a),e=new Date-s,i=Math.floor(e/6e4),M=Math.floor(e/36e5),P=Math.floor(e/864e5);return i<1?"Just now":i<60?`${i}m ago`:M<24?`${M}h ago`:P<7?`${P}d ago`:s.toLocaleDateString()}function _(){try{const a=localStorage.getItem(zs);c.value=a?JSON.parse(a):[]}catch{c.value=[]}}function h(a){var r;const s=a.type||"track";if(s==="show"){D.push({path:"/shows",query:{play:a.id}});return}if(s==="live_tv"){D.push("/live-tv");return}((r=f.currentTrack)==null?void 0:r.id)===a.id&&f.isPlaying?f.pause():f.play(a)}function K(a){p.remove(a),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Removed from bookmarks",type:"success"}}))}function O(a){p.toggle(a),_()}return G(()=>{_(),window.addEventListener("recentlyPlayed:updated",_)}),U(()=>{window.removeEventListener("recentlyPlayed:updated",_)}),(a,s)=>{const r=Q("router-link");return n(),l("div",X,[m(g).isLoggedIn.value?R("",!0):(n(),l("div",Z,[t("p",null,[s[4]||(s[4]=y("Bookmarks and recently played are stored on this device. ",-1)),w(r,{to:"/login?signup=1"},{default:C(()=>[...s[3]||(s[3]=[y("Create an account",-1)])]),_:1}),s[5]||(s[5]=y(" to sync across devices.",-1))])])),t("div",ss,[s[9]||(s[9]=t("div",{class:"saves-profile-glow"},null,-1)),t("div",ts,[s[8]||(s[8]=t("div",{class:"saves-avatar-wrapper"},[t("div",{class:"saves-avatar-guest"},[t("i",{class:"fas fa-bookmark"})])],-1)),t("div",es,[t("h1",as,o(L.value),1),t("div",os,[t("div",ns,[t("span",ls,o(v.value.length),1),s[6]||(s[6]=t("span",{class:"saves-stat-label"},"Bookmarks",-1))]),t("div",rs,[t("span",is,o(c.value.length),1),s[7]||(s[7]=t("span",{class:"saves-stat-label"},"Recently Played",-1))])])])])]),t("div",vs,[t("button",{type:"button",class:k([{active:d.value==="saved"},"saves-tab-btn"]),onClick:s[0]||(s[0]=e=>d.value="saved")},[s[10]||(s[10]=t("i",{class:"fas fa-bookmark"},null,-1)),s[11]||(s[11]=t("span",null,"Bookmarks",-1)),t("span",ds,o(v.value.length),1)],2),t("button",{type:"button",class:k([{active:d.value==="recent"},"saves-tab-btn"]),onClick:s[1]||(s[1]=e=>d.value="recent")},[s[12]||(s[12]=t("i",{class:"fas fa-history"},null,-1)),s[13]||(s[13]=t("span",null,"Recently Played",-1)),t("span",us,o(c.value.length),1)],2)]),E(t("div",cs,[v.value.length?(n(),l("div",ps,[t("div",ys,[t("button",{type:"button",class:k([{active:u.value==="all"},"saves-pill"]),onClick:s[2]||(s[2]=e=>u.value="all")}," All ",2),(n(!0),l($,null,S(V.value,e=>(n(),l("button",{key:e,type:"button",class:k([{active:u.value===e},"saves-pill"]),onClick:i=>u.value=e},o(e==="track"?"Tracks":e==="show"?"Shows":e==="artist"?"Artists":e),11,ks))),128))]),t("div",fs,[(n(!0),l($,null,S(x.value,e=>(n(),l("div",{key:A(e),class:"saves-card",onClick:i=>h(e)},[t("div",bs,[t("img",{src:e.cover_art||e.thumbnail||e.artwork||"/static/img/default-cover.jpg",alt:e.title||e.name,loading:"lazy"},null,8,gs),t("div",hs,[t("button",{type:"button",class:"saves-play-btn",onClick:T(i=>h(e),["stop"])},[...s[14]||(s[14]=[t("i",{class:"fas fa-play"},null,-1)])],8,ms)]),t("button",{type:"button",class:"saves-remove-btn",title:"Remove bookmark",onClick:T(i=>K(e),["stop"])},[...s[15]||(s[15]=[t("i",{class:"fas fa-bookmark"},null,-1)])],8,ws),t("span",Cs,o(e.type||"track"),1)]),t("div",$s,[t("h3",null,o(e.title||e.name||"—"),1),t("p",null,o(e.artist||e.host||""),1),e.added_at?(n(),l("span",Ss,o(z(e.added_at)),1)):R("",!0)])],8,_s))),128))])])):(n(),l("div",Bs,[s[17]||(s[17]=t("div",{class:"saves-empty-icon"},[t("i",{class:"fas fa-bookmark"})],-1)),s[18]||(s[18]=t("h3",null,"No bookmarks yet",-1)),s[19]||(s[19]=t("p",null,"Tap the bookmark icon on any track, show, or artist to save it here for easy access.",-1)),w(r,{to:"/shows",class:"saves-cta-btn"},{default:C(()=>[...s[16]||(s[16]=[y("Discover Shows",-1)])]),_:1})]))],512),[[N,d.value==="saved"]]),E(t("div",Ts,[c.value.length?(n(),l("div",Ds,[(n(!0),l($,null,S(c.value,e=>(n(),l("div",{key:j(e),class:"saves-recent-item",onClick:i=>h(e)},[t("div",Ps,[t("img",{src:e.artwork||e.cover_art||e.thumbnail||"/static/img/default-cover.jpg",alt:e.title||e.name,loading:"lazy"},null,8,Rs),s[20]||(s[20]=t("div",{class:"saves-recent-play"},[t("i",{class:"fas fa-play"})],-1))]),t("div",Es,[t("h3",null,o(e.title||e.name||"—"),1),t("p",null,o(e.artist||e.host||""),1),t("span",Ns,[t("span",Ls,o(I(e.type)),1),t("span",Vs,o(F(e.played_at)),1)])]),t("div",xs,[t("button",{type:"button",class:k(["saves-action-btn",{bookmarked:m(p).isBookmarked(e)}]),title:m(p).isBookmarked(e)?"Remove bookmark":"Add bookmark",onClick:T(i=>O(e),["stop"])},[...s[21]||(s[21]=[t("i",{class:"fas fa-bookmark"},null,-1)])],10,As)])],8,Ms))),128))])):(n(),l("div",js,[s[23]||(s[23]=t("div",{class:"saves-empty-icon"},[t("i",{class:"fas fa-history"})],-1)),s[24]||(s[24]=t("h3",null,"No recent plays",-1)),s[25]||(s[25]=t("p",null,"Content you listen to will appear here so you can easily find it again.",-1)),w(r,{to:"/music",class:"saves-cta-btn"},{default:C(()=>[...s[22]||(s[22]=[y("Browse Music",-1)])]),_:1})]))],512),[[N,d.value==="recent"]])])}}},Os=q(Is,[["__scopeId","data-v-3290342d"]]);export{Os as default};
