import{o as I,a as $,c as l,d as o,e as s,f as c,l as S,x as A,A as B,F as g,r as k,m as r,q as U,n as b,i as C,t as p,h as V}from"./index-BHVn4BJX.js";const z={class:"merch-shell"},N={class:"merch-controls"},D={class:"merch-search",role:"search"},L={class:"merch-pill"},P={key:0,class:"merch-grid"},R=["onMouseenter","onMouseleave"],E=["src","alt","title"],j={key:0,class:"image-toggle-hint"},H={key:1,class:"sale-pending-badge"},T={class:"merch-body"},O={class:"merch-top"},Q={class:"merch-title"},Z={class:"merch-price"},G={class:"usd"},J={class:"merch-chips"},K={class:"merch-actions"},W=["id"],X=["onClick"],Y={key:1,class:"merch-empty"},ee={key:2,class:"merch-grid"},ae={__name:"MerchView",setup(se){const u=r([]),v=r(new Set),f=r(!0),_=r(""),d=r("featured"),m=r({});function h(a){return String(a||"").toLowerCase()}function M(a){const t=h(a&&(a.kind||a.type||a.category));return!["theme","themes","subscription","subscriptions","membership","memberships"].includes(t)}const w=U(()=>{let a=Array.isArray(u.value)?[...u.value]:[];a=a.filter(e=>M(e));const t=h(_.value);return t&&(a=a.filter(e=>h(e.name||e.id).includes(t))),d.value==="low"?a.sort((e,n)=>(+e.price_usd||0)-(+n.price_usd||0)):d.value==="high"?a.sort((e,n)=>(+n.price_usd||0)-(+e.price_usd||0)):d.value==="az"&&a.sort((e,n)=>String(e.name||e.id||"").localeCompare(String(n.name||n.id||""))),a});function i(a){return!a||!a.id?!1:v.value.has(String(a.id))}function x(a){const t=h(a.name||a.id),e=+a.price_usd||0,n=[];return(t.includes("limited")||t.includes("drop"))&&n.push("Limited Drop"),t.includes("bundle")&&n.push("Bundle"),e>=50?n.push("Collector"):n.push("Supporter"),n.slice(0,2)}function q(a){if(i(a))return;const t=encodeURIComponent(a.id||""),e=encodeURIComponent(a.name||a.id||"Merch"),n=encodeURIComponent(a.price_usd??""),y=document.getElementById("qty_"+(a.id||"")),F=encodeURIComponent(y&&y.value?y.value:"1");window.location.assign(`/checkout?type=merch&item_id=${t}&qty=${F}&amount=${n}&title=${e}`)}return I(async()=>{f.value=!0;try{const a=await $("/api/merch");u.value=a.items||[],v.value=new Set((a.purchased_item_ids||[]).map(String))}catch{u.value=[],v.value=new Set}f.value=!1}),(a,t)=>(l(),o("div",z,[t[10]||(t[10]=s("section",{class:"podcasts-hero"},[s("div",{class:"podcasts-hero-inner"},[s("h1",null,[s("i",{class:"fas fa-shopping-bag","aria-hidden":"true"}),c(" Merch ")]),s("p",null,"Support Ahoy with limited drops and essentials.")])],-1)),t[11]||(t[11]=s("div",{class:"merch-hero desktop-only"},[s("h1",null,"Merch"),s("p",null,"Support Ahoy with limited drops and essentials. Fast checkout, easy quantities.")],-1)),s("div",N,[s("div",D,[t[2]||(t[2]=s("i",{class:"fas fa-search","aria-hidden":"true"},null,-1)),S(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>_.value=e),type:"search",placeholder:"Search merch…","aria-label":"Search merch"},null,512),[[A,_.value]])]),s("div",L,[t[4]||(t[4]=s("span",{style:{opacity:".7","font-size":"12px","letter-spacing":".08em","text-transform":"uppercase"}},"Sort",-1)),S(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e),"aria-label":"Sort merch"},[...t[3]||(t[3]=[s("option",{value:"featured"},"Featured",-1),s("option",{value:"low"},"Price: Low",-1),s("option",{value:"high"},"Price: High",-1),s("option",{value:"az"},"Name: A–Z",-1)])],512),[[B,d.value]])])]),w.value.length?(l(),o("div",P,[(l(!0),o(g,null,k(w.value,e=>(l(),o("div",{key:e.id,class:b(["merch-card",{"sale-pending":i(e)}])},[s("div",{class:"merch-media",onMouseenter:n=>m.value[e.id]=!!e.image_url_back,onMouseleave:n=>m.value[e.id]=!1},[s("img",{src:m.value[e.id]&&e.image_url_back?e.image_url_back:e.image_url||"/static/img/default-cover.jpg",alt:e.name||e.id,loading:"lazy",decoding:"async",title:m.value[e.id]?"Back view":"Front view"},null,8,E),e.image_url_back?(l(),o("div",j,[...t[5]||(t[5]=[s("i",{class:"fas fa-sync-alt"},null,-1),s("span",null,"Hover to see back",-1)])])):C("",!0),i(e)?(l(),o("div",H,[...t[6]||(t[6]=[s("i",{class:"fas fa-clock","aria-hidden":"true"},null,-1),s("span",null,"Sale Pending",-1)])])):C("",!0)],40,R),s("div",T,[s("div",O,[s("h3",Q,p(e.name||e.id),1),s("div",Z,[s("div",G,p(e.price_usd!=null?"$"+(+e.price_usd).toFixed(2):"—"),1),t[7]||(t[7]=s("div",{class:"sub"},"USD",-1))])]),s("div",J,[(l(!0),o(g,null,k(x(e),n=>(l(),o("span",{key:n,class:"merch-chip"},p(n),1))),128))]),s("div",K,[s("input",{class:"qty",type:"number",min:"1",max:"1",value:"1",id:"qty_"+(e.id||""),disabled:"","aria-label":"Quantity",title:"One-of-a-kind item"},null,8,W),s("a",{class:b(["merch-cta",{disabled:i(e)}]),href:"#",onClick:V(n=>i(e)?null:q(e),["prevent"])},[s("span",null,p(i(e)?"Sold":"Checkout"),1),s("i",{class:b(i(e)?"fas fa-lock":"fas fa-arrow-right"),"aria-hidden":"true"},null,2)],10,X)])])],2))),128))])):f.value?(l(),o("div",ee,[(l(),o(g,null,k(6,e=>s("div",{key:e,class:"merch-card"},[...t[9]||(t[9]=[s("div",{class:"merch-media skeleton",style:{"aspect-ratio":"4/3"}},null,-1),s("div",{class:"merch-body"},[s("div",{class:"skeleton",style:{height:"14px",width:"60%","margin-bottom":"6px"}}),s("div",{class:"skeleton",style:{height:"12px",width:"30%"}})],-1)])])),64))])):(l(),o("div",Y,[...t[8]||(t[8]=[c(" No merch items found yet. Add images to ",-1),s("code",null,"static/merch/images/",-1),c(" and run ",-1),s("code",null,"python manifest.py merch",-1),c(" to generate ",-1),s("code",null,"data/merch.json",-1),c(". ",-1)])]))]))}};export{ae as default};
