import{_ as x}from"./ahoy_logo--Z4AShNu.js";import{_ as B,o as L,E as m,c,d as u,e as s,g as r,t as w,k as a,j as o,i as l,l as N,G as V,N as D,m as v,r as F,B as T}from"./index-wlCC_hhh.js";const I={class:"account-page"},P={key:0,class:"account-card"},O={class:"account-profile"},W={class:"account-name"},$={class:"account-email"},j={class:"account-section"},Y={class:"wallet-balance"},z={class:"wallet-amount"},G={class:"account-wallet-actions"},J=["disabled"],M={key:0,class:"fas fa-spinner fa-spin"},R={key:1,class:"fas fa-wallet"},U={class:"account-section"},q={class:"account-danger-zone"},H={key:1,class:"delete-confirm-box neu-card-inset"},K={class:"delete-actions"},Q=["disabled"],X={key:0,class:"fas fa-spinner fa-spin"},Z=["disabled"],tt={key:1,class:"account-guest"},st={class:"account-section"},at={class:"account-guest-cta"},et={__name:"AccountView",setup(nt){const p=T(),e=D(),y=v(null),f=v(!1),g=v(!1),d=v(!1);L(async()=>{if(e.isLoggedIn.value)try{const i=await m("/payments/wallet");y.value=i.balance??0}catch{y.value=0}});async function C(){if(!e.isLoggedIn.value){p.push("/login");return}const i=10;f.value=!0;try{const t=await m("/payments/wallet/fund",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:i})});if(t.checkout_url){window.location.href=t.checkout_url;return}window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:t.error||"Could not start checkout",type:"error"}}))}catch(t){window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:t.message||"Failed to add funds",type:"error"}}))}finally{f.value=!1}}async function E(){await e.logout(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Signed out",type:"success"}})),p.push("/")}async function S(){d.value=!0;try{const i=await m("/api/auth/delete-account",{method:"POST"});i.success?(window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Account deleted",type:"success"}})),p.push("/"),await e.logout()):window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:i.error||"Deletion failed",type:"error"}}))}catch{window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Failed to delete account",type:"error"}}))}finally{d.value=!1}}return(i,t)=>{var k,b,h,_;const n=F("router-link");return c(),u("div",I,[t[23]||(t[23]=s("section",{class:"podcasts-hero account-page-header"},[s("div",{class:"podcasts-hero-inner account-hero-inner"},[s("img",{src:x,alt:"Ahoy",class:"account-hero-logo"}),s("div",null,[s("h1",null,"Account"),s("p",null,"Wallet & profile")])])],-1)),r(e).isLoggedIn.value?(c(),u("div",P,[s("div",O,[t[2]||(t[2]=s("div",{class:"account-avatar"},[s("i",{class:"fas fa-user-circle"})],-1)),s("div",W,w(((k=r(e).user.value)==null?void 0:k.display_name)||((b=r(e).user.value)==null?void 0:b.username)||((h=r(e).user.value)==null?void 0:h.email)),1),s("div",$,w((_=r(e).user.value)==null?void 0:_.email),1)]),s("section",j,[t[6]||(t[6]=s("h2",{class:"account-section-title"},"Wallet",-1)),s("div",Y,[t[3]||(t[3]=s("span",{class:"wallet-label"},"Balance",-1)),s("span",z,"$"+w((y.value??0).toFixed(2)),1)]),t[7]||(t[7]=s("p",{class:"wallet-note"},"Use your wallet for boosts and merch checkout.",-1)),s("div",G,[s("button",{type:"button",class:"account-btn primary",disabled:f.value,onClick:C},[f.value?(c(),u("i",M)):(c(),u("i",R)),t[4]||(t[4]=a(" Add funds ",-1))],8,J),o(n,{to:"/wallet",class:"account-btn secondary"},{default:l(()=>[...t[5]||(t[5]=[a("Transaction history",-1)])]),_:1})])]),s("section",U,[t[11]||(t[11]=s("h2",{class:"account-section-title"},"Links",-1)),o(n,{to:"/tip-artist",class:"account-link"},{default:l(()=>[...t[8]||(t[8]=[s("i",{class:"fas fa-heart"},null,-1),a(" Boost artists ",-1)])]),_:1}),o(n,{to:"/my-saves",class:"account-link"},{default:l(()=>[...t[9]||(t[9]=[s("i",{class:"fas fa-bookmark"},null,-1),a(" Saved ",-1)])]),_:1}),o(n,{to:"/settings",class:"account-link"},{default:l(()=>[...t[10]||(t[10]=[s("i",{class:"fas fa-cog"},null,-1),a(" Settings ",-1)])]),_:1})]),s("button",{type:"button",class:"account-btn logout",onClick:E},[...t[12]||(t[12]=[s("i",{class:"fas fa-sign-out-alt"},null,-1),a(" Sign out ",-1)])]),s("div",q,[g.value?(c(),u("div",H,[t[14]||(t[14]=s("p",null,"Delete your account and all saved data? This cannot be undone.",-1)),s("div",K,[s("button",{class:"account-btn danger",disabled:d.value,onClick:S},[d.value?(c(),u("i",X)):N("",!0),t[13]||(t[13]=a(" Yes, delete everything ",-1))],8,Q),s("button",{class:"account-btn secondary",disabled:d.value,onClick:t[1]||(t[1]=A=>g.value=!1)}," Cancel ",8,Z)])])):(c(),u("button",{key:0,type:"button",class:"account-btn danger-link",onClick:t[0]||(t[0]=A=>g.value=!0)}," Delete account "))])])):(c(),u("div",tt,[t[22]||(t[22]=V('<div class="account-guest-profile" data-v-dac4a5de><div class="account-avatar" data-v-dac4a5de><i class="fas fa-user-circle" data-v-dac4a5de></i></div><h2 class="account-guest-title" data-v-dac4a5de>Profile</h2><p class="account-guest-sub" data-v-dac4a5de>You&#39;re browsing as a guest. Save to this device and explore — create an account to sync everywhere.</p></div>',1)),s("section",st,[t[19]||(t[19]=s("h2",{class:"account-section-title"},"Features",-1)),o(n,{to:"/my-saves",class:"account-link"},{default:l(()=>[...t[15]||(t[15]=[s("i",{class:"fas fa-bookmark"},null,-1),s("span",null,[s("strong",null,"Saved"),a(" — Bookmarks and recently played")],-1)])]),_:1}),o(n,{to:"/playlists",class:"account-link"},{default:l(()=>[...t[16]||(t[16]=[s("i",{class:"fas fa-list-ul"},null,-1),s("span",null,[s("strong",null,"Playlists"),a(" — Create and manage (sign in to save)")],-1)])]),_:1}),o(n,{to:"/settings",class:"account-link"},{default:l(()=>[...t[17]||(t[17]=[s("i",{class:"fas fa-cog"},null,-1),s("span",null,[s("strong",null,"Settings"),a(" — Audio and preferences")],-1)])]),_:1}),o(n,{to:"/wallet",class:"account-link"},{default:l(()=>[...t[18]||(t[18]=[s("i",{class:"fas fa-wallet"},null,-1),s("span",null,[s("strong",null,"Wallet"),a(" — Add funds for boosts and merch (sign in)")],-1)])]),_:1})]),s("div",at,[t[21]||(t[21]=s("p",null,"Create a free account to sync your saves across devices and unlock wallet, playlists, and more.",-1)),o(n,{to:"/login?signup=1",class:"account-btn primary"},{default:l(()=>[...t[20]||(t[20]=[a("Create account",-1)])]),_:1})])]))])}}},it=B(et,[["__scopeId","data-v-dac4a5de"]]);export{it as default};
