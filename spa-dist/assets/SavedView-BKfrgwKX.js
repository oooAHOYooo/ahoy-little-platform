import{_ as K,z as H,u as q,o as G,b as U,c as n,d as l,B as w,e as t,f as k,j as C,k as m,i as D,t as r,n as y,l as M,v as P,F as S,r as $,L as X,p as Y,q as b,m as R,h as B}from"./index-Qvb-IFK5.js";const Q={class:"my-saves-container saved-page"},W={key:0,class:"saves-guest-banner"},Z={class:"saves-profile-hero"},ss={class:"saves-profile-content"},ts={class:"saves-profile-info"},es={class:"saves-username"},as={class:"saves-stats"},os={class:"saves-stat"},ns={class:"saves-stat-number"},ls={class:"saves-stat"},rs={class:"saves-stat-number"},is={class:"saves-tabs-glass"},vs={class:"saves-tab-count"},us={class:"saves-tab-count"},ds={class:"saves-content-glass"},cs={key:0,class:"saves-bookmarks-tab"},ps={class:"saves-filter-pills"},ks=["onClick"],ys={class:"saves-grid"},fs=["onClick"],_s={class:"saves-card-art"},bs=["src","alt"],gs={class:"saves-card-overlay"},hs=["onClick"],ws=["onClick"],Cs={class:"saves-type-badge"},ms={class:"saves-card-info"},Ss={key:0,class:"saves-date"},$s={key:1,class:"saves-empty-glass"},Rs={class:"saves-content-glass"},Bs={key:0,class:"saves-recent-list"},Es=["onClick"],Ts={class:"saves-recent-art"},Ds=["src","alt"],Ms={class:"saves-recent-info"},Ps={class:"saves-recent-time"},Ns={class:"saves-recent-actions"},Is=["title","onClick"],Ls={key:1,class:"saves-empty-glass"},N="ahoy.recentlyPlayed.v1",As=50,Vs={__name:"SavedView",setup(xs){const p=H(),f=q(),g=X(),d=R("saved"),c=R("all"),v=R([]),u=b(()=>Object.values(p.bookmarks.value)),I=b(()=>{var s,o,a;return u.value.length>=3?"My Collection":((s=g.user.value)==null?void 0:s.display_name)||((a=(o=g.user.value)==null?void 0:o.email)==null?void 0:a.split("@")[0])||"Saved"}),L=b(()=>[...new Set(u.value.map(s=>s.type||"track").filter(Boolean))]),A=b(()=>c.value==="all"?u.value:u.value.filter(e=>(e.type||"track")===c.value));function V(e){return e.id??e.slug??`${e.type}:${e.title}`}function x(e){return e.key??`${e.type||"track"}:${e.id}:${e.played_at||0}`}function O(e){return e?new Date(e).toLocaleDateString():""}function j(e){if(!e)return"";const s=new Date(e),a=new Date-s,i=Math.floor(a/6e4),E=Math.floor(a/36e5),T=Math.floor(a/864e5);return i<1?"Just now":i<60?`${i}m ago`:E<24?`${E}h ago`:T<7?`${T}d ago`:s.toLocaleDateString()}function _(){try{const e=localStorage.getItem(N);v.value=e?JSON.parse(e):[]}catch{v.value=[]}}function z(e){if(!(!e||e.id==null&&e.slug==null))try{const s={id:e.id??e.slug,type:e.type||"track",title:e.title||e.name,artist:e.artist||e.host||"",artwork:e.artwork||e.cover_art||e.thumbnail,audio_url:e.audio_url||e.url,url:e.url||e.audio_url,key:`${e.type||"track"}:${e.id??e.slug}`,played_at:new Date().toISOString()};let o=v.value.filter(a=>a.key!==s.key);o.unshift(s),o=o.slice(0,As),v.value=o,localStorage.setItem(N,JSON.stringify(o))}catch(s){console.warn("trackRecentPlay failed",s)}}function h(e){var s;z(e),((s=f.currentTrack)==null?void 0:s.id)===e.id&&f.isPlaying?f.pause():f.play(e)}function F(e){p.remove(e),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Removed from bookmarks",type:"success"}}))}function J(e){p.toggle(e),_()}return G(()=>{_(),window.addEventListener("recentlyPlayed:updated",_)}),U(()=>{window.removeEventListener("recentlyPlayed:updated",_)}),(e,s)=>{const o=Y("router-link");return n(),l("div",Q,[w(g).isLoggedIn.value?D("",!0):(n(),l("div",W,[t("p",null,[s[4]||(s[4]=k("Saves are stored on this device. ",-1)),C(o,{to:"/login?signup=1"},{default:m(()=>[...s[3]||(s[3]=[k("Create an account",-1)])]),_:1}),s[5]||(s[5]=k(" to sync across devices.",-1))])])),t("div",Z,[s[9]||(s[9]=t("div",{class:"saves-profile-glow"},null,-1)),t("div",ss,[s[8]||(s[8]=t("div",{class:"saves-avatar-wrapper"},[t("div",{class:"saves-avatar-guest"},[t("i",{class:"fas fa-bookmark"})])],-1)),t("div",ts,[t("h1",es,r(I.value),1),t("div",as,[t("div",os,[t("span",ns,r(u.value.length),1),s[6]||(s[6]=t("span",{class:"saves-stat-label"},"Bookmarks",-1))]),t("div",ls,[t("span",rs,r(v.value.length),1),s[7]||(s[7]=t("span",{class:"saves-stat-label"},"Recently Played",-1))])])])])]),t("div",is,[t("button",{type:"button",class:y([{active:d.value==="saved"},"saves-tab-btn"]),onClick:s[0]||(s[0]=a=>d.value="saved")},[s[10]||(s[10]=t("i",{class:"fas fa-bookmark"},null,-1)),s[11]||(s[11]=t("span",null,"Bookmarks",-1)),t("span",vs,r(u.value.length),1)],2),t("button",{type:"button",class:y([{active:d.value==="recent"},"saves-tab-btn"]),onClick:s[1]||(s[1]=a=>d.value="recent")},[s[12]||(s[12]=t("i",{class:"fas fa-history"},null,-1)),s[13]||(s[13]=t("span",null,"Recently Played",-1)),t("span",us,r(v.value.length),1)],2)]),M(t("div",ds,[u.value.length?(n(),l("div",cs,[t("div",ps,[t("button",{type:"button",class:y([{active:c.value==="all"},"saves-pill"]),onClick:s[2]||(s[2]=a=>c.value="all")}," All ",2),(n(!0),l(S,null,$(L.value,a=>(n(),l("button",{key:a,type:"button",class:y([{active:c.value===a},"saves-pill"]),onClick:i=>c.value=a},r(a==="track"?"Tracks":a==="show"?"Shows":a==="artist"?"Artists":a),11,ks))),128))]),t("div",ys,[(n(!0),l(S,null,$(A.value,a=>(n(),l("div",{key:V(a),class:"saves-card",onClick:i=>h(a)},[t("div",_s,[t("img",{src:a.cover_art||a.thumbnail||a.artwork||"/static/img/default-cover.jpg",alt:a.title||a.name,loading:"lazy"},null,8,bs),t("div",gs,[t("button",{type:"button",class:"saves-play-btn",onClick:B(i=>h(a),["stop"])},[...s[14]||(s[14]=[t("i",{class:"fas fa-play"},null,-1)])],8,hs)]),t("button",{type:"button",class:"saves-remove-btn",title:"Remove bookmark",onClick:B(i=>F(a),["stop"])},[...s[15]||(s[15]=[t("i",{class:"fas fa-bookmark"},null,-1)])],8,ws),t("span",Cs,r(a.type||"track"),1)]),t("div",ms,[t("h3",null,r(a.title||a.name||"—"),1),t("p",null,r(a.artist||a.host||""),1),a.added_at?(n(),l("span",Ss,r(O(a.added_at)),1)):D("",!0)])],8,fs))),128))])])):(n(),l("div",$s,[s[17]||(s[17]=t("div",{class:"saves-empty-icon"},[t("i",{class:"fas fa-bookmark"})],-1)),s[18]||(s[18]=t("h3",null,"No bookmarks yet",-1)),s[19]||(s[19]=t("p",null,"Tap the bookmark icon on any track, show, or artist to save it here for easy access.",-1)),C(o,{to:"/shows",class:"saves-cta-btn"},{default:m(()=>[...s[16]||(s[16]=[k("Discover Shows",-1)])]),_:1})]))],512),[[P,d.value==="saved"]]),M(t("div",Rs,[v.value.length?(n(),l("div",Bs,[(n(!0),l(S,null,$(v.value,a=>(n(),l("div",{key:x(a),class:"saves-recent-item",onClick:i=>h(a)},[t("div",Ts,[t("img",{src:a.artwork||a.cover_art||a.thumbnail||"/static/img/default-cover.jpg",alt:a.title||a.name,loading:"lazy"},null,8,Ds),s[20]||(s[20]=t("div",{class:"saves-recent-play"},[t("i",{class:"fas fa-play"})],-1))]),t("div",Ms,[t("h3",null,r(a.title||a.name||"—"),1),t("p",null,r(a.artist||a.host||""),1),t("span",Ps,r(j(a.played_at)),1)]),t("div",Ns,[t("button",{type:"button",class:y(["saves-action-btn",{bookmarked:w(p).isBookmarked(a)}]),title:w(p).isBookmarked(a)?"Remove bookmark":"Add bookmark",onClick:B(i=>J(a),["stop"])},[...s[21]||(s[21]=[t("i",{class:"fas fa-bookmark"},null,-1)])],10,Is)])],8,Es))),128))])):(n(),l("div",Ls,[s[23]||(s[23]=t("div",{class:"saves-empty-icon"},[t("i",{class:"fas fa-history"})],-1)),s[24]||(s[24]=t("h3",null,"No recent plays",-1)),s[25]||(s[25]=t("p",null,"Content you listen to will appear here so you can easily find it again.",-1)),C(o,{to:"/music",class:"saves-cta-btn"},{default:m(()=>[...s[22]||(s[22]=[k("Browse Music",-1)])]),_:1})]))],512),[[P,d.value==="recent"]])])}}},js=K(Vs,[["__scopeId","data-v-bfef6cee"]]);export{js as default};
