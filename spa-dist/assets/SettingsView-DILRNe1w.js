import{_ as te,n as ne,m as _,S as P,U as B,o as oe,E as S,b as ae,c as u,d as c,e,G as ie,k as i,g as k,F as O,t as l,j as y,i as b,s as F,y as R,q as le,l as V,f as de,V as L,N as re,r as ue,W as ce,X as ge,Y as me,Z as pe,$ as fe,B as ve}from"./index-rnNZzN5L.js";const he={class:"settings-page"},ye={class:"settings-container"},be={class:"settings-content"},Se={class:"settings-section neu-card"},we={class:"settings-profile"},_e={class:"settings-value"},ke={class:"settings-links"},Ce={key:1,class:"settings-guest"},Ee={class:"settings-section neu-card"},xe={class:"settings-row setting-toggle-row"},De=["aria-pressed"],Ve={class:"settings-row setting-toggle-row"},Le=["aria-pressed"],Te={class:"settings-grid"},Me={class:"setting-item"},Ae={class:"dial-container"},Ie={class:"dial-value"},Ne={class:"settings-section neu-card"},Pe={class:"settings-row"},Be={class:"theme-options"},Oe=["value"],Fe={class:"settings-section neu-card experimental-section"},Re={class:"experimental-grid"},Ye={class:"downloads-table-wrap"},Je={key:0,class:"downloads-table"},Xe=["href"],ze={key:1,class:"downloads-table-loading"},Ue={key:2,class:"downloads-table-error"},je={class:"settings-section neu-card"},Ge={class:"build-info-grid"},qe={class:"build-info-item"},He={class:"settings-value"},We={key:0,class:"build-info-item"},Ze={class:"settings-value"},$e={key:0,class:"git-commits-section"},Ke={class:"commit-list"},Qe={class:"commit-meta"},es={class:"commit-hash"},ss={class:"commit-author"},ts={class:"commit-date"},ns={class:"commit-message"},os={key:1,class:"build-info-loading"},T="ahoySettings",as={__name:"SettingsView",setup(is){const Y=ve(),v=re(),C=ne(),M=fe(),J=_(null),d=L({masterVolume:75}),g=_(P()),m=_(B()),r=L({version:"0.1.0",buildDate:"",commits:[],loading:!0});function X(){g.value=!g.value,ce(g.value),g.value&&ge()}function z(){m.value=!m.value,me(m.value),m.value&&pe()}const a=L({version:"",date:"",download_url:"",name:"",loading:!0,error:""}),A=_("");function U(){const t=new Date;A.value=t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}let E=!1,x=null,p=null,f=null;function j(){v.isLoggedIn.value?S("/api/user/profile",{credentials:"include"}).then(t=>{var s;(s=t==null?void 0:t.preferences)!=null&&s.audioSettings&&(d.masterVolume=Math.max(0,Math.min(100,t.preferences.audioSettings.masterVolume??75))),D()}).catch(()=>D()):D()}function D(){var t;try{const s=localStorage.getItem(T);if(s){const n=JSON.parse(s);((t=n.audioSettings)==null?void 0:t.masterVolume)!=null&&(d.masterVolume=Math.max(0,Math.min(100,n.audioSettings.masterVolume)))}}catch{}w()}function G(){const t={audioSettings:{...d}};localStorage.setItem(T,JSON.stringify(t)),v.isLoggedIn.value&&S("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({preferences:{audioSettings:d}})}).catch(()=>{}),w(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Settings saved!",type:"success"}}))}function q(){d.masterVolume=75;const t={audioSettings:{...d}};localStorage.setItem(T,JSON.stringify(t)),v.isLoggedIn.value&&S("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({preferences:{audioSettings:d}})}).catch(()=>{}),w(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Settings reset to defaults",type:"info"}}))}function w(){var s;const t=d.masterVolume/100;document.querySelectorAll("audio").forEach(n=>{n.volume=t});try{const n=(s=C.getAudioElement)==null?void 0:s.call(C);n&&(n.volume=t)}catch{}}function I(t,s){E=!0,x=s;const n=t.currentTarget;p=h=>H(h,n),f=()=>N(),document.addEventListener("mousemove",p),document.addEventListener("mouseup",f),document.addEventListener("touchmove",p,{passive:!1}),document.addEventListener("touchend",f)}function H(t,s){if(!E||!s)return;const n=t.touches?t.touches[0].clientX:t.clientX,h=t.touches?t.touches[0].clientY:t.clientY,o=s.getBoundingClientRect(),K=o.left+o.width/2,Q=o.top+o.height/2,ee=(Math.atan2(h-Q,n-K)*(180/Math.PI)+90+360)%360,se=Math.max(0,Math.min(100,ee/1.8));x==="masterVolume"&&(d.masterVolume=se),w()}function N(){E=!1,x=null,p&&(document.removeEventListener("mousemove",p),document.removeEventListener("touchmove",p)),f&&(document.removeEventListener("mouseup",f),document.removeEventListener("touchend",f)),p=null,f=null}function W(t){return t?new Date(t).toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}async function Z(){try{const t=await S("/api/build-info");t&&(r.version=t.version||"0.1.0",r.buildDate=t.buildDate||"",r.commits=t.commits||[])}catch(t){console.error("Failed to fetch build info:",t)}finally{r.loading=!1}}async function $(){await v.logout(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Signed out",type:"success"}})),Y.push("/")}return oe(()=>{g.value=P(),m.value=B(),j(),U(),S("/api/downloads/latest",{credentials:"include"}).then(t=>{a.version=(t==null?void 0:t.version)??"",a.date=(t==null?void 0:t.date)??"",a.download_url=(t==null?void 0:t.download_url)??"",a.name=(t==null?void 0:t.name)??"",a.loading=!1}).catch(()=>{a.error="No macOS release available",a.loading=!1}),Z()}),ae(()=>{N()}),(t,s)=>{var h;const n=ue("router-link");return u(),c("div",he,[e("div",ye,[s[34]||(s[34]=ie('<section class="podcasts-hero settings-page-header" data-v-33e4011f><div class="podcasts-hero-inner" data-v-33e4011f><h1 data-v-33e4011f><i class="fas fa-cog" aria-hidden="true" data-v-33e4011f></i> Settings </h1><p data-v-33e4011f>Customize your Ahoy experience.</p></div></section><div class="settings-header desktop-only" data-v-33e4011f><div class="settings-header-icon" data-v-33e4011f><i class="fas fa-cog" data-v-33e4011f></i></div><h1 data-v-33e4011f>Settings</h1><p data-v-33e4011f>Customize your Ahoy experience</p></div>',2)),e("div",be,[e("div",Se,[s[9]||(s[9]=e("h2",null,[e("i",{class:"fas fa-user"}),i(" Account")],-1)),k(v).isLoggedIn.value?(u(),c(O,{key:0},[e("div",we,[s[3]||(s[3]=e("span",{class:"settings-label"},"Logged in as",-1)),e("span",_e,l((h=k(v).user.value)==null?void 0:h.email),1)]),e("div",ke,[y(n,{to:"/account",class:"settings-link"},{default:b(()=>[...s[4]||(s[4]=[e("i",{class:"fas fa-user-circle"},null,-1),i(" Account & wallet ",-1)])]),_:1}),y(n,{to:"/my-saves",class:"settings-link"},{default:b(()=>[...s[5]||(s[5]=[e("i",{class:"fas fa-bookmark"},null,-1),i(" Saved ",-1)])]),_:1})]),e("button",{type:"button",class:"neu-btn neu-btn-secondary logout-btn",onClick:$},[...s[6]||(s[6]=[e("i",{class:"fas fa-sign-out-alt"},null,-1),i(" Sign out ",-1)])])],64)):(u(),c("div",Ce,[s[8]||(s[8]=e("p",null,"Sign in to manage your preferences.",-1)),y(n,{to:"/login",class:"neu-btn neu-btn-primary"},{default:b(()=>[...s[7]||(s[7]=[i("Sign in",-1)])]),_:1})]))]),e("div",Ee,[s[16]||(s[16]=e("h2",null,[e("i",{class:"fas fa-volume-up"}),i(" Audio")],-1)),e("div",xe,[s[11]||(s[11]=e("div",{class:"setting-toggle-label"},[e("span",{class:"setting-toggle-title"},"Save chime"),e("span",{class:"setting-toggle-desc"},"Play a short sound when you save a track or show")],-1)),e("button",{type:"button",class:F(["setting-toggle-btn",{on:g.value}]),"aria-pressed":g.value,onClick:X},[...s[10]||(s[10]=[e("span",{class:"setting-toggle-thumb"},null,-1)])],10,De)]),e("div",Ve,[s[13]||(s[13]=e("div",{class:"setting-toggle-label"},[e("span",{class:"setting-toggle-title"},"Tap sound"),e("span",{class:"setting-toggle-desc"},"A tiny chime when you tap buttons and links")],-1)),e("button",{type:"button",class:F(["setting-toggle-btn",{on:m.value}]),"aria-pressed":m.value,onClick:z},[...s[12]||(s[12]=[e("span",{class:"setting-toggle-thumb"},null,-1)])],10,Le)]),e("div",Te,[e("div",Me,[s[15]||(s[15]=e("label",null,"Master Volume",-1)),e("div",Ae,[e("div",{ref_key:"dialEl",ref:J,class:"neu-dial",style:le({transform:`rotate(${d.masterVolume*1.8-90}deg)`}),onMousedown:s[0]||(s[0]=R(o=>I(o,"masterVolume"),["prevent"])),onTouchstart:s[1]||(s[1]=R(o=>I(o,"masterVolume"),["prevent"]))},[...s[14]||(s[14]=[e("div",{class:"dial-handle"},null,-1)])],36),e("span",Ie,l(Math.round(d.masterVolume)),1)])])])]),e("div",Ne,[s[19]||(s[19]=e("h2",null,[e("i",{class:"fas fa-palette"}),i(" Appearance")],-1)),e("div",Pe,[s[18]||(s[18]=e("div",{class:"setting-toggle-label"},[e("span",{class:"setting-toggle-title"},"Theme"),e("span",{class:"setting-toggle-desc"},"Choose your preferred look")],-1)),e("div",Be,[e("select",{class:"settings-select",value:k(M).currentTheme.value,onChange:s[2]||(s[2]=o=>k(M).setTheme(o.target.value))},[...s[17]||(s[17]=[e("option",{value:"deep-blue"},"Deep Blue",-1),e("option",{value:"after-dark"},"After Dark",-1),e("option",{value:"default"},"Default",-1)])],40,Oe)])])]),e("div",Fe,[s[25]||(s[25]=e("h2",null,[e("i",{class:"fas fa-flask"}),i(" Experimental")],-1)),s[26]||(s[26]=e("p",{class:"experimental-disclaimer"},"These features are still in development and may change or be removed.",-1)),e("div",Re,[y(n,{to:"/focus",class:"experimental-card neu-card-inset"},{default:b(()=>[...s[20]||(s[20]=[e("div",{class:"experimental-card-icon"},[e("i",{class:"fas fa-headphones"})],-1),e("div",{class:"experimental-card-info"},[e("h3",null,"Focus Mode"),e("p",null,"Ambient audio for deep focus and relaxation")],-1),e("i",{class:"fas fa-chevron-right experimental-card-arrow"},null,-1)])]),_:1}),y(n,{to:"/mp3-player",class:"experimental-card neu-card-inset"},{default:b(()=>[...s[21]||(s[21]=[e("div",{class:"experimental-card-icon"},[e("i",{class:"fas fa-compact-disc"})],-1),e("div",{class:"experimental-card-info"},[e("h3",null,"MP3 Player"),e("p",null,"Import and play MP3s from your computer — Winamp style")],-1),e("i",{class:"fas fa-chevron-right experimental-card-arrow"},null,-1)])]),_:1}),y(n,{to:"/download",class:"experimental-card neu-card-inset"},{default:b(()=>[...s[22]||(s[22]=[e("div",{class:"experimental-card-icon"},[e("i",{class:"fas fa-download"})],-1),e("div",{class:"experimental-card-info"},[e("h3",null,"Download"),e("p",null,"Get Ahoy on web, Android, iOS, or desktop")],-1),e("i",{class:"fas fa-chevron-right experimental-card-arrow"},null,-1)])]),_:1})]),s[27]||(s[27]=e("p",{class:"downloads-table-intro"},[i("Latest macOS desktop build — also at "),e("a",{href:"/downloads",target:"_blank",rel:"noopener"},"app.ahoy.ooo/downloads"),i(".")],-1)),e("div",Ye,[a.version?(u(),c("table",Je,[s[24]||(s[24]=e("thead",null,[e("tr",null,[e("th",null,"Date"),e("th",null,"Version"),e("th",null,"Download")])],-1)),e("tbody",null,[e("tr",null,[e("td",null,l(A.value),1),e("td",null,l(a.version),1),e("td",null,[e("a",{href:a.download_url,target:"_blank",rel:"noopener",class:"download-table-link"},[i(l(a.name||"ZIP")+" ",1),s[23]||(s[23]=e("i",{class:"fas fa-external-link-alt"},null,-1))],8,Xe)])])])])):a.loading?(u(),c("p",ze,"Loading…")):a.error?(u(),c("p",Ue,l(a.error),1)):V("",!0)])]),e("div",je,[s[31]||(s[31]=e("h2",null,[e("i",{class:"fas fa-info-circle"}),i(" Build Info")],-1)),e("div",Ge,[e("div",qe,[s[28]||(s[28]=e("span",{class:"settings-label"},"Version",-1)),e("span",He,l(r.version),1)]),r.buildDate?(u(),c("div",We,[s[29]||(s[29]=e("span",{class:"settings-label"},"Build Date",-1)),e("span",Ze,l(r.buildDate),1)])):V("",!0)]),r.commits&&r.commits.length>0?(u(),c("div",$e,[s[30]||(s[30]=e("h3",null,"Recent Commits",-1)),e("div",Ke,[(u(!0),c(O,null,de(r.commits,o=>(u(),c("div",{key:o.hash,class:"commit-item neu-card-inset"},[e("div",Qe,[e("span",es,"#"+l(o.hash),1),e("span",ss,l(o.author),1),e("span",ts,l(W(o.timestamp)),1)]),e("p",ns,l(o.message),1)]))),128))])])):r.loading?(u(),c("p",os,"Loading build info...")):V("",!0)]),e("div",{class:"settings-actions"},[e("button",{type:"button",class:"neu-btn neu-btn-secondary",onClick:q},[...s[32]||(s[32]=[e("i",{class:"fas fa-undo"},null,-1),i(" Reset to Defaults ",-1)])]),e("button",{type:"button",class:"neu-btn neu-btn-primary",onClick:G},[...s[33]||(s[33]=[e("i",{class:"fas fa-save"},null,-1),i(" Save Settings ",-1)])])])])])])}}},rs=te(as,[["__scopeId","data-v-33e4011f"]]);export{rs as default};
