import{_ as C,o as S,G as k,c as i,d as c,e as t,B as u,t as v,f as a,j as o,k as e,H as B,L as x,m as b,p as A,s as E}from"./index-Qvb-IFK5.js";const L={class:"account-page"},V={key:0,class:"account-card"},F={class:"account-profile"},N={class:"account-name"},I={class:"account-email"},T={class:"account-section"},P={class:"wallet-balance"},j={class:"wallet-amount"},O={class:"account-wallet-actions"},W=["disabled"],D={key:0,class:"fas fa-spinner fa-spin"},G={key:1,class:"fas fa-wallet"},H={class:"account-section"},J={key:1,class:"account-guest"},M={class:"account-section"},R={class:"account-guest-cta"},U={__name:"AccountView",setup(Y){const p=E(),l=x(),f=b(null),d=b(!1);S(async()=>{if(l.isLoggedIn.value)try{const r=await k("/payments/wallet");f.value=r.balance??0}catch{f.value=0}});async function _(){if(!l.isLoggedIn.value){p.push("/login");return}const r=10;d.value=!0;try{const s=await k("/payments/wallet/fund",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:r})});if(s.checkout_url){window.location.href=s.checkout_url;return}window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:s.error||"Could not start checkout",type:"error"}}))}catch(s){window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:s.message||"Failed to add funds",type:"error"}}))}finally{d.value=!1}}async function h(){await l.logout(),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Signed out",type:"success"}})),p.push("/")}return(r,s)=>{var g,y,m,w;const n=A("router-link");return i(),c("div",L,[s[19]||(s[19]=t("div",{class:"unified-header"},[t("div",{class:"header-content"},[t("h1",null,"Account")])],-1)),u(l).isLoggedIn.value?(i(),c("div",V,[t("div",F,[s[0]||(s[0]=t("div",{class:"account-avatar"},[t("i",{class:"fas fa-user-circle"})],-1)),t("div",N,v(((g=u(l).user.value)==null?void 0:g.display_name)||((y=u(l).user.value)==null?void 0:y.username)||((m=u(l).user.value)==null?void 0:m.email)),1),t("div",I,v((w=u(l).user.value)==null?void 0:w.email),1)]),t("section",T,[s[4]||(s[4]=t("h2",{class:"account-section-title"},"Wallet",-1)),t("div",P,[s[1]||(s[1]=t("span",{class:"wallet-label"},"Balance",-1)),t("span",j,"$"+v((f.value??0).toFixed(2)),1)]),s[5]||(s[5]=t("p",{class:"wallet-note"},"Use your wallet for boosts and merch checkout.",-1)),t("div",O,[t("button",{type:"button",class:"account-btn primary",disabled:d.value,onClick:_},[d.value?(i(),c("i",D)):(i(),c("i",G)),s[2]||(s[2]=a(" Add funds ",-1))],8,W),o(n,{to:"/wallet",class:"account-btn secondary"},{default:e(()=>[...s[3]||(s[3]=[a("Transaction history",-1)])]),_:1})])]),t("section",H,[s[9]||(s[9]=t("h2",{class:"account-section-title"},"Links",-1)),o(n,{to:"/tip-artist",class:"account-link"},{default:e(()=>[...s[6]||(s[6]=[t("i",{class:"fas fa-heart"},null,-1),a(" Boost artists ",-1)])]),_:1}),o(n,{to:"/my-saves",class:"account-link"},{default:e(()=>[...s[7]||(s[7]=[t("i",{class:"fas fa-bookmark"},null,-1),a(" Saved ",-1)])]),_:1}),o(n,{to:"/settings",class:"account-link"},{default:e(()=>[...s[8]||(s[8]=[t("i",{class:"fas fa-cog"},null,-1),a(" Settings ",-1)])]),_:1})]),t("button",{type:"button",class:"account-btn logout",onClick:h},[...s[10]||(s[10]=[t("i",{class:"fas fa-sign-out-alt"},null,-1),a(" Sign out ",-1)])])])):(i(),c("div",J,[s[18]||(s[18]=B('<div class="account-guest-profile" data-v-44fd651c><div class="account-avatar" data-v-44fd651c><i class="fas fa-user-circle" data-v-44fd651c></i></div><h2 class="account-guest-title" data-v-44fd651c>Profile</h2><p class="account-guest-sub" data-v-44fd651c>You&#39;re browsing as a guest. Save to this device and explore — create an account to sync everywhere.</p></div>',1)),t("section",M,[s[15]||(s[15]=t("h2",{class:"account-section-title"},"Features",-1)),o(n,{to:"/my-saves",class:"account-link"},{default:e(()=>[...s[11]||(s[11]=[t("i",{class:"fas fa-bookmark"},null,-1),t("span",null,[t("strong",null,"Saved"),a(" — Bookmarks and recently played")],-1)])]),_:1}),o(n,{to:"/playlists",class:"account-link"},{default:e(()=>[...s[12]||(s[12]=[t("i",{class:"fas fa-list-ul"},null,-1),t("span",null,[t("strong",null,"Playlists"),a(" — Create and manage (sign in to save)")],-1)])]),_:1}),o(n,{to:"/settings",class:"account-link"},{default:e(()=>[...s[13]||(s[13]=[t("i",{class:"fas fa-cog"},null,-1),t("span",null,[t("strong",null,"Settings"),a(" — Audio and preferences")],-1)])]),_:1}),o(n,{to:"/wallet",class:"account-link"},{default:e(()=>[...s[14]||(s[14]=[t("i",{class:"fas fa-wallet"},null,-1),t("span",null,[t("strong",null,"Wallet"),a(" — Add funds for boosts and merch (sign in)")],-1)])]),_:1})]),t("div",R,[s[17]||(s[17]=t("p",null,"Create a free account to sync your saves across devices and unlock wallet, playlists, and more.",-1)),o(n,{to:"/login?signup=1",class:"account-btn primary"},{default:e(()=>[...s[16]||(s[16]=[a("Create account",-1)])]),_:1})])]))])}}},q=C(U,[["__scopeId","data-v-44fd651c"]]);export{q as default};
