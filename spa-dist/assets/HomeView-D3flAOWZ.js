import{_ as ot,u as tt,o as st,a as E,r as et,b as c,c as u,d as t,F as M,e as I,f as O,w as V,t as h,g as R,h as N,i as z,j as p,k as rt,l as dt,m as ct,n as j,p as H,q as G,v as J,s as ut,x as vt}from"./index-DKIbx5E3.js";const ht={key:0,class:"explore-widgets-container"},pt={class:"explore-widget podcast-widget"},gt={class:"widget-grid"},mt={class:"card-image"},ft=["src","alt"],wt={class:"card-title"},_t={class:"explore-widget video-widget"},yt={class:"widget-grid"},bt={class:"card-image"},kt=["src","alt"],$t={class:"card-title"},Ct={class:"explore-widget radio-widget"},xt={class:"widget-grid"},Tt=["onClick"],Vt={class:"card-image"},St=["src","alt"],At={class:"card-title"},Nt={class:"explore-widget music-widget"},Lt={class:"widget-grid"},Mt={class:"card-image"},It=["src","alt"],Dt={class:"card-title"},jt={class:"explore-widget artist-widget"},Rt={class:"widget-grid"},Et={class:"card-image circle"},Pt=["src","alt"],Bt={class:"card-title"},Ut={__name:"ExploreWidgets",setup(at){const Q=tt(),_=p(!0),w=p([]),S=p([]),o=p([]),k=p([]),D=p([]);function x(y,i){return!y||!y.length?[]:[...y].sort(()=>.5-Math.random()).slice(0,i)}function F(y){y&&Q.playTrack(y)}return st(async()=>{try{const[y,i,m,a]=await Promise.all([E("/api/podcasts").catch(()=>({shows:[]})),E("/api/shows").catch(()=>({shows:[]})),E("/api/music").catch(()=>({tracks:[],albums:[]})),E("/api/artists").catch(()=>({artists:[]}))]);w.value=x(y.shows||[],3),S.value=x(i.shows||[],3);const W=(m.tracks||[]).filter(n=>n.audio_url||n.preview_url);o.value=x(W,3);const P=m.tracks||[],$=new Map,B=[];for(const n of P)n.album&&n.album!=="Single"&&!$.has(n.album)?$.set(n.album,{id:n.album,title:n.album,cover_art:n.cover_art||n.artwork,artist:n.artist,type:"album"}):B.push({id:n.id,title:n.title,cover_art:n.cover_art||n.artwork,artist:n.artist,type:"track"});let g=Array.from($.values());if(g.length<3){const n=3-g.length,U=x(B,n);g=[...g,...U]}if(g.length<3){const n=3-g.length,U=new Set(g.map(v=>v.id||v.title)),K=P.filter(v=>!U.has(v.id)&&!U.has(v.title)),T=x(K,n).map(v=>({id:v.id,title:v.title,cover_art:v.cover_art||v.artwork,artist:v.artist,type:"track"}));g=[...g,...T]}k.value=g.slice(0,3);const C=(a.artists||[]).map(n=>({...n,slug:n.slug||n.id||(n.name||"").toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")}));D.value=x(C,3)}catch(y){console.error("Error loading explore widgets",y)}finally{_.value=!1}}),(y,i)=>{const m=et("router-link");return _.value?z("",!0):(c(),u("section",ht,[t("div",pt,[i[1]||(i[1]=t("div",{class:"widget-header"},[t("div",{class:"header-icon"},[t("i",{class:"fas fa-podcast"})]),t("div",{class:"header-text"},[t("h3",null,"Podcasts"),t("p",null,"Fresh episodes & shows")])],-1)),t("div",gt,[(c(!0),u(M,null,I(w.value,a=>(c(),O(m,{key:a.slug,to:`/podcasts/${a.slug}`,class:"widget-card"},{default:V(()=>[t("div",mt,[t("img",{src:a.artwork||"/static/img/default-cover.jpg",alt:a.title,loading:"lazy"},null,8,ft)]),t("div",wt,h(a.title),1)]),_:2},1032,["to"]))),128))]),R(m,{to:"/podcasts",class:"widget-cta cta-purple"},{default:V(()=>[...i[0]||(i[0]=[N(" Explore Podcasts ",-1)])]),_:1})]),t("div",_t,[i[4]||(i[4]=t("div",{class:"widget-header"},[t("div",{class:"header-icon"},[t("i",{class:"fas fa-video"})]),t("div",{class:"header-text"},[t("h3",null,"Videos"),t("p",null,"Watch latest content")])],-1)),t("div",yt,[(c(!0),u(M,null,I(S.value,a=>(c(),O(m,{key:a.id,to:`/videos?play=${a.id}`,class:"widget-card video-card"},{default:V(()=>[t("div",bt,[t("img",{src:a.thumbnail||"/static/img/default-cover.jpg",alt:a.title,loading:"lazy"},null,8,kt),i[2]||(i[2]=t("div",{class:"play-icon"},[t("i",{class:"fas fa-play"})],-1))]),t("div",$t,h(a.title),1)]),_:2},1032,["to"]))),128))]),R(m,{to:"/videos",class:"widget-cta cta-red"},{default:V(()=>[...i[3]||(i[3]=[N(" Watch Now ",-1)])]),_:1})]),t("div",Ct,[i[7]||(i[7]=t("div",{class:"widget-header"},[t("div",{class:"header-icon"},[t("i",{class:"fas fa-broadcast-tower"})]),t("div",{class:"header-text"},[t("h3",null,"Radio"),t("p",null,"Live 24/7 Stream")])],-1)),t("div",xt,[(c(!0),u(M,null,I(o.value,a=>(c(),u("div",{key:a.id,class:"widget-card",onClick:W=>F(a)},[t("div",Vt,[t("img",{src:a.cover_art||"/static/img/default-cover.jpg",alt:a.title,loading:"lazy"},null,8,St),i[5]||(i[5]=t("div",{class:"play-icon"},[t("i",{class:"fas fa-wave-square"})],-1))]),t("div",At,h(a.title),1)],8,Tt))),128))]),R(m,{to:"/radio",class:"widget-cta cta-orange"},{default:V(()=>[...i[6]||(i[6]=[N(" Tune In ",-1)])]),_:1})]),t("div",Nt,[i[9]||(i[9]=t("div",{class:"widget-header"},[t("div",{class:"header-icon"},[t("i",{class:"fas fa-music"})]),t("div",{class:"header-text"},[t("h3",null,"Music"),t("p",null,"Albums & Singles")])],-1)),t("div",Lt,[(c(!0),u(M,null,I(k.value,a=>(c(),O(m,{key:a.id||a.title,to:a.type==="album"?{path:"/music",query:{q:a.title}}:`/music/${a.id}`,class:"widget-card"},{default:V(()=>[t("div",Mt,[t("img",{src:a.cover_art||"/static/img/default-cover.jpg",alt:a.title,loading:"lazy"},null,8,It)]),t("div",Dt,h(a.title),1)]),_:2},1032,["to"]))),128))]),R(m,{to:"/music",class:"widget-cta cta-blue"},{default:V(()=>[...i[8]||(i[8]=[N(" Music Library ",-1)])]),_:1})]),t("div",jt,[i[11]||(i[11]=t("div",{class:"widget-header"},[t("div",{class:"header-icon"},[t("i",{class:"fas fa-users"})]),t("div",{class:"header-text"},[t("h3",null,"Artists"),t("p",null,"Meet the creators")])],-1)),t("div",Rt,[(c(!0),u(M,null,I(D.value,a=>(c(),O(m,{key:a.slug,to:`/artists/${a.slug}`,class:"widget-card artist-card-shape"},{default:V(()=>[t("div",Et,[t("img",{src:a.image||"/static/img/default-avatar.png",alt:a.name,loading:"lazy"},null,8,Pt)]),t("div",Bt,h(a.name),1)]),_:2},1032,["to"]))),128))]),R(m,{to:"/artists",class:"widget-cta cta-green"},{default:V(()=>[...i[10]||(i[10]=[N(" Discover Artists ",-1)])]),_:1})])]))}}},zt=ot(Ut,[["__scopeId","data-v-43231032"]]),Ft={class:"home-page"},Wt={class:"live-dashboard"},qt={class:"dashboard-grid"},Ot={class:"dash-preview"},Ht=["src"],Qt={class:"dash-overlay"},Kt={class:"dash-badges"},Gt={class:"channel-badge"},Jt={key:0,class:"channel-nav"},Xt={class:"dash-content"},Yt={class:"dash-actions"},Zt={class:"dashboard-sidebar"},ts={class:"dash-thumb"},ss=["src"],es={class:"dash-info"},as={class:"radio-next-list"},ls={class:"track-title"},is={class:"track-artist"},ns={key:0,class:"tv-channel-strip"},os={class:"tv-channel-strip-list"},rs=["onClick"],ds={class:"tv-channel-strip-meta"},cs={class:"tv-channel-strip-name"},us={class:"tv-channel-strip-now"},vs={key:0,class:"tv-channel-strip-next"},hs={class:"whats-new-section"},ps={class:"whats-new-container"},gs={class:"whats-new-header"},ms={key:0,href:"/whats-new",class:"view-all-link"},fs={class:"whats-new-loading"},ws={class:"whats-new-updates"},_s=["href"],ys={class:"whats-new-content"},bs={class:"whats-new-date"},ks={class:"whats-new-empty"},xs={__name:"HomeView",setup(at){const Q=vt(),_=tt(),w=p([]),S=p(0),o=p(null),k=p(null),D=p({}),x=p({});let F=null;const y={misc:"Channel 01 — Misc",films:"Channel 02 — Short Films","music-videos":"Channel 03 — Music Videos","live-shows":"Channel 04 — Live Shows"};function i(e,s){return y[e.id]||`Channel ${String(s+1).padStart(2,"0")} — ${e.name||"Unknown"}`}function m(){var l,A;const e=new Date().getHours(),s={},d={};for(let b=0;b<w.value.length;b++){const f=w.value[b];if((l=f==null?void 0:f.items)!=null&&l.length){const L=e%f.items.length;s[f.id]=f.items[L],d[f.id]=f.items.length>L+1?f.items[L+1]:f.items[0]}}if(D.value=s,x.value=d,(A=k.value)!=null&&A.id){const b=k.value.id;s[b]&&(o.value=s[b])}}function a(e){var d;if(!w.value.length)return;S.value=(e+w.value.length)%w.value.length;const s=w.value[S.value];k.value={...s,name:i(s,S.value)},D.value[s.id]?o.value=D.value[s.id]:(d=s.items)!=null&&d.length?o.value=s.items[0]:o.value={id:"placeholder",title:"No content available",thumbnail:"/static/img/default-cover.jpg",host:s.name}}function W(e){w.value.length&&a(S.value+(e==="next"?1:-1))}function P(e){!(e!=null&&e.id)||e.id==="placeholder"||e.id==="error"||Q.push({path:"/videos",query:{play:e.id}})}const $=p([]),B=p([]),g=p([]),C=p(null),n=ut(()=>{if(!C.value||!_.currentTrack)return!1;const e=String(C.value.id??""),s=String(_.currentTrack.id??"");return e===s&&_.isPlaying});function U(){const e=[...$.value];e.sort(()=>.5-Math.random()),B.value=e.map(s=>({...s,type:"track"})),g.value=B.value.slice(0,20)}function K(){if(n.value){_.pause();return}if(C.value){_.resume();return}const e=B.value[0]||g.value[0];e&&(C.value=e,_.setQueue($.value,$.value.findIndex(s=>s.id===e.id)))}const T=p([]),v=p(!0);function lt(e){if(!e)return"";try{return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short"})}catch{return e}}function it(e){if(e.year&&e.month&&e.section){const s=`/whats-new/${e.year}/${e.month}/${e.section}`;return e.slug?`${s}#update-${e.slug}`:s}return e.link?e.link:"/whats-new"}function nt(e){var d;const s=(e==null?void 0:e.channels)??((d=e==null?void 0:e.data)==null?void 0:d.channels)??[];return Array.isArray(s)?s.map(l=>({...l,id:(l==null?void 0:l.id)??"misc",name:(l==null?void 0:l.name)??"Channel",items:Array.isArray(l==null?void 0:l.items)?l.items:[]})):[]}return st(async()=>{try{let e=null;try{e=await apiFetch("/api/live-tv/channels?_="+Date.now())}catch{e=await E("/api/live-tv/channels").catch(()=>null)}const s=e?nt(e):[];if(w.value=s,s.length){const d=s.find(l=>l.id==="misc")||s[0];S.value=s.findIndex(l=>l.id===d.id),m(),a(S.value)}else o.value={id:"placeholder",title:"Loading Live TV...",thumbnail:"/static/img/default-cover.jpg",host:"Ahoy TV"},k.value={id:"misc",name:"Channel 01 — Misc"};F=setInterval(m,60*1e3)}catch{o.value={id:"error",title:"Live TV",thumbnail:"/static/img/default-cover.jpg",host:"Ahoy TV"},k.value={id:"misc",name:"Channel 01 — Misc"}}try{const s=((await E("/api/music").catch(()=>({tracks:[]}))).tracks||[]).filter(l=>l.audio_url||l.preview_url),d=new Set;$.value=s.filter(l=>d.has(l.id)?!1:(d.add(l.id),!0)),U()}catch{}_.currentTrack&&$.value.length&&$.value.some(s=>{var d;return String(s.id)===String((d=_.currentTrack)==null?void 0:d.id)})&&(C.value=_.currentTrack),v.value=!0;try{const s=(await E("/api/whats-new").catch(()=>({updates:[]}))).updates;if(Array.isArray(s))T.value=s.slice(0,4);else if(s&&typeof s=="object"){const d=[];for(const l of Object.keys(s).sort().reverse())for(const A of Object.keys(s[l]||{}).sort().reverse())for(const b of Object.keys(s[l][A]||{})){const f=(s[l][A][b].items||[]).map(L=>({...L,year:l,month:A,section:b}));d.push(...f)}T.value=d.slice(0,4)}else T.value=[]}catch{T.value=[]}finally{v.value=!1}}),rt(()=>{F&&clearInterval(F)}),dt(()=>_.currentTrack,e=>{if(!e)return;$.value.some(d=>String(d.id)===String(e.id))&&(C.value=e)},{deep:!0}),(e,s)=>{var l,A,b,f,L,X,Y,Z;const d=et("router-link");return c(),u("div",Ft,[s[22]||(s[22]=t("section",{class:"podcasts-hero"},[t("div",{class:"podcasts-hero-inner"},[t("h1",null,[t("i",{class:"fas fa-home","aria-hidden":"true"}),N(" Home")]),t("p",null,"Explore")])],-1)),t("section",Wt,[t("div",qt,[t("div",{class:"dashboard-main",role:"button",tabindex:"0",onClick:s[4]||(s[4]=r=>o.value&&o.value.id!=="placeholder"&&o.value.id!=="error"?P(o.value):null),onKeydown:s[5]||(s[5]=ct(j(r=>o.value&&o.value.id!=="placeholder"&&o.value.id!=="error"?P(o.value):null,["prevent"]),["enter"]))},[t("div",Ot,[t("img",{src:((l=o.value)==null?void 0:l.thumbnail)||"/static/img/default-cover.jpg",alt:"Live TV",class:"dash-bg"},null,8,Ht),t("div",Qt,[t("div",Kt,[s[6]||(s[6]=t("span",{class:"live-badge"},"LIVE TV",-1)),t("span",Gt,h(((A=k.value)==null?void 0:A.name)||"Channel 01 — Misc"),1)]),w.value.length>1?(c(),u("div",Jt,[t("button",{type:"button",class:"channel-nav-btn","aria-label":"Previous channel",onClick:s[0]||(s[0]=j(r=>W("prev"),["stop"]))},[...s[7]||(s[7]=[t("i",{class:"fas fa-chevron-left"},null,-1)])]),t("button",{type:"button",class:"channel-nav-btn","aria-label":"Next channel",onClick:s[1]||(s[1]=j(r=>W("next"),["stop"]))},[...s[8]||(s[8]=[t("i",{class:"fas fa-chevron-right"},null,-1)])])])):z("",!0),t("div",Xt,[t("h2",null,h(((b=o.value)==null?void 0:b.title)||"Loading..."),1),t("p",null,h(((f=o.value)==null?void 0:f.artist)||((L=o.value)==null?void 0:L.host)||""),1),t("div",Yt,[o.value&&o.value.id!=="placeholder"&&o.value.id!=="error"?(c(),u("button",{key:0,type:"button",class:"dash-play-btn",onClick:s[2]||(s[2]=j(r=>P(o.value),["stop"]))},[...s[9]||(s[9]=[t("i",{class:"fas fa-play"},null,-1),N(" Watch Now ",-1)])])):z("",!0),R(d,{to:"/live-tv",class:"dash-guide-btn",onClick:s[3]||(s[3]=j(()=>{},["stop"]))},{default:V(()=>[...s[10]||(s[10]=[t("i",{class:"fas fa-tv"},null,-1),N(" View All Channels ",-1)])]),_:1})])])])])],32),t("div",Zt,[s[14]||(s[14]=t("div",{class:"sidebar-header"},[t("h3",null,"Live Radio")],-1)),t("div",{class:H(["dash-item radio-item",{active:n.value}])},[t("div",ts,[t("img",{src:((X=C.value||g.value[0])==null?void 0:X.cover_art)||"https://ahoy.ooo/images/Ahoy-Indie-Media-DEFAULT-COVER-A-8.jpg",alt:"Radio"},null,8,ss),s[11]||(s[11]=t("div",{class:"dash-icon"},[t("i",{class:"fas fa-broadcast-tower"})],-1))]),t("div",es,[s[12]||(s[12]=t("div",{class:"dash-label"},"On Air Now",-1)),t("h4",null,h(((Y=C.value||g.value[0])==null?void 0:Y.title)||"Loading..."),1),t("p",null,h(((Z=C.value||g.value[0])==null?void 0:Z.artist)||""),1)]),t("button",{type:"button",class:"dash-action-btn","aria-label":"Play/Pause radio",onClick:j(K,["stop"])},[t("i",{class:H(n.value?"fas fa-pause":"fas fa-play")},null,2)])],2),t("div",as,[s[13]||(s[13]=t("div",{class:"list-label"},"Up Next",-1)),(c(!0),u(M,null,I(g.value.slice(0,3),r=>(c(),u("div",{key:r.id,class:"mini-track"},[t("span",ls,h(r.title),1),t("span",is,h(r.artist),1)]))),128))])])]),w.value.length>1?(c(),u("div",ns,[s[16]||(s[16]=t("div",{class:"tv-channel-strip-header"},[t("div",{class:"tv-channel-strip-title"},"Live TV Channels"),t("div",{class:"tv-channel-strip-subtitle"},"Tap a channel to switch")],-1)),t("div",os,[(c(!0),u(M,null,I(w.value,(r,q)=>(c(),u("button",{key:r.id,type:"button",class:H(["tv-channel-strip-item",{active:k.value&&k.value.id===r.id}]),onClick:j($s=>a(q),["stop"])},[t("div",ds,[t("span",cs,h(i(r,q)),1),s[15]||(s[15]=t("span",{class:"tv-channel-strip-live"},"LIVE",-1))]),t("div",us,h((D.value[r.id]||{}).title||"No content available"),1),x.value[r.id]?(c(),u("div",vs," Up next: "+h((x.value[r.id]||{}).title||""),1)):z("",!0)],10,rs))),128))])])):z("",!0)]),t("section",hs,[t("div",ps,[t("div",gs,[s[18]||(s[18]=t("h2",null,"What's New at Ahoy",-1)),!v.value&&T.value.length>0?(c(),u("a",ms,[...s[17]||(s[17]=[N(" View All ",-1),t("i",{class:"fas fa-arrow-right"},null,-1)])])):z("",!0)]),G(t("div",fs,[...s[19]||(s[19]=[t("span",null,"Loading updates...",-1)])],512),[[J,v.value]]),G(t("div",ws,[(c(!0),u(M,null,I(T.value,(r,q)=>(c(),u("a",{key:r.id||r.title||q,href:it(r),class:H(["whats-new-item clickable","type-"+(r.type||"update")])},[t("div",ys,[t("h3",null,h(r.title),1),t("p",null,h(r.description),1),t("span",bs,h(lt(r.date,r.type)),1)]),s[20]||(s[20]=t("div",{class:"whats-new-arrow"},[t("i",{class:"fas fa-chevron-right"})],-1))],10,_s))),128))],512),[[J,!v.value&&T.value.length>0]]),G(t("div",ks,[...s[21]||(s[21]=[t("p",null,"No updates available at this time.",-1),t("a",{href:"/whats-new",class:"view-archive-link"},"View Archive",-1)])],512),[[J,!v.value&&T.value.length===0]])])]),R(zt)])}}};export{xs as default};
