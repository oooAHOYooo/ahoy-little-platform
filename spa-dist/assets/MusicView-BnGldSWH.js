import{_ as D,b as i,c as u,d as e,l as w,n as _,t as p,m as F,p as h,h as d,u as L,o as z,k as E,w as S,F as M,r as R,a as N,i as O,j as T,f as V,q as A}from"./index-BS6VIDXW.js";const P=70,Y=120,H={__name:"PullRefresh",emits:["refresh"],setup(C,{emit:l}){const o=l,m=d(null),c=d(!1),a=d(!1),n=d(0),s=d(0),y=h(()=>a.value?P*.6:Math.min(s.value*.5,Y*.5)),t=h(()=>a.value?0:Math.min(s.value*.4,Y*.4)-40),k=h(()=>a.value?1:Math.min(s.value/P,1)),r=h(()=>s.value>=P);function f(){return window.scrollY<=0}function x(v){!f()||a.value||(n.value=v.touches[0].clientY,c.value=!0)}function $(v){if(!c.value||a.value)return;const g=v.touches[0].clientY-n.value;g>0?s.value=g:(c.value=!1,s.value=0)}function b(){c.value&&(r.value?(a.value=!0,s.value=0,o("refresh",B)):s.value=0,c.value=!1)}function B(){a.value=!1,s.value=0}return(v,g)=>(i(),u("div",{class:"pull-refresh-wrapper",ref_key:"wrapper",ref:m,onTouchstartPassive:x,onTouchmovePassive:$,onTouchendPassive:b},[e("div",{class:_(["pull-indicator",{active:c.value,refreshing:a.value}]),style:w({transform:`translateY(${t.value}px)`,opacity:k.value})},[e("i",{class:_(a.value?"fas fa-spinner fa-spin":"fas fa-arrow-down"),style:w({transform:r.value?"rotate(180deg)":""})},null,6),e("span",null,p(a.value?"Refreshing...":r.value?"Release to refresh":"Pull to refresh"),1)],6),e("div",{class:"pull-content",style:w({transform:`translateY(${y.value}px)`})},[F(v.$slots,"default",{},void 0)],4)],544))}},I=D(H,[["__scopeId","data-v-d1c2085f"]]),j={class:"music-container"},q={class:"unified-header music-subheader"},J={class:"header-content"},Q={class:"header-count"},U={key:0,class:"music-grid"},X=["onClick"],G=["src","alt"],K={class:"track-overlay"},W={class:"play-btn"},Z={class:"track-title"},ee={class:"track-artist"},se={key:1,class:"music-grid"},te={__name:"MusicView",setup(C){const l=L(),o=d([]);function m(n){var s;((s=l.currentTrack)==null?void 0:s.id)===o.value[n].id&&l.isPlaying?l.pause():l.setQueue(o.value,n)}async function c(){const n=await N("/api/music").catch(()=>({tracks:[]}));o.value=n.tracks||[]}async function a(n){try{const s=await A("/api/music");o.value=s.tracks||[],localStorage.setItem("ahoy:/api/music",JSON.stringify({data:s,ts:Date.now()}))}catch{}n()}return z(c),(n,s)=>{const y=O("router-link");return i(),E(I,{onRefresh:a},{default:S(()=>[e("div",j,[e("div",q,[e("div",J,[s[0]||(s[0]=e("h1",null,"Music",-1)),e("span",Q,p(o.value.length)+" tracks",1)])]),o.value.length?(i(),u("div",U,[(i(!0),u(M,null,R(o.value,(t,k)=>{var r,f;return i(),u("div",{key:t.id,class:_(["track-card",{playing:((r=T(l).currentTrack)==null?void 0:r.id)===t.id}])},[e("div",{class:"track-cover",onClick:x=>m(k)},[e("img",{src:t.cover_art,alt:t.title,loading:"lazy"},null,8,G),e("div",K,[e("button",W,[e("i",{class:_(((f=T(l).currentTrack)==null?void 0:f.id)===t.id&&T(l).isPlaying?"fas fa-pause":"fas fa-play")},null,2)])])],8,X),V(y,{to:`/music/${t.id}`,class:"track-info",style:{"text-decoration":"none",color:"inherit"}},{default:S(()=>[e("div",Z,p(t.title),1),e("div",ee,p(t.artist),1)]),_:2},1032,["to"])],2)}),128))])):(i(),u("div",se,[(i(),u(M,null,R(8,t=>e("div",{class:"track-card",key:t},[...s[1]||(s[1]=[e("div",{class:"track-cover skeleton"},null,-1),e("div",{class:"track-info"},[e("div",{class:"skeleton",style:{height:"14px",width:"60%","margin-bottom":"6px"}}),e("div",{class:"skeleton",style:{height:"12px",width:"40%"}})],-1)])])),64))]))])]),_:1})}}};export{te as default};
