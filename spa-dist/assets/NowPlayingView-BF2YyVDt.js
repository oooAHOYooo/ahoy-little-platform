import{u as E,z as N,B as n,c as u,d as p,e,t as l,C as f,n as g,F as P,r as $,i as M,j as V,k as j,f as z,m as _,q as F,p as I,I as A,P as Q,Q as R,K as D}from"./index-B7urDTQW.js";const H={key:0,class:"now-playing-page"},K={class:"np-artwork-container"},L=["src","alt"],U={class:"np-info"},X={class:"np-title"},G={class:"np-artist"},J={class:"np-seek"},O={class:"np-times"},W={class:"np-controls"},Y={class:"np-actions"},Z=["title"],ee=["title"],te={class:"np-speed-label"},se=["title"],ne={key:0,class:"np-queue"},ae={class:"np-queue-list"},oe=["onClick"],ie=["src"],le={class:"np-queue-info"},re={class:"np-queue-track"},ce={class:"np-queue-artist"},ue={key:1,class:"now-playing-page",style:{display:"flex","align-items":"center","justify-content":"center","min-height":"60vh"}},pe={style:{"text-align":"center",color:"rgba(255,255,255,0.4)"}},fe={__name:"NowPlayingView",setup(de){const t=E(),d=N(),{shareTrack:b}=D(),m=A(),k=R(),r=_(1),c=_(!1),h=Q(()=>t.getAudioElement()),v=F(()=>{if(!t.currentTrack||!t.queue.length)return[];const a=t.queue.findIndex(s=>s.id===t.currentTrack.id);return t.queue.slice(a+1,a+6)});function y(a){if(!a||!isFinite(a))return"0:00";const s=Math.floor(a/60),i=Math.floor(a%60);return`${s}:${i.toString().padStart(2,"0")}`}function w(a){const s=a.currentTarget.getBoundingClientRect(),i=(a.clientX-s.left)/s.width*100;t.seek(Math.max(0,Math.min(100,i)))}function S(){m.onBookmark(),d.toggle({...t.currentTrack,_type:"track"});const a=d.isBookmarked(t.currentTrack);window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:a?"Saved to library":"Removed from library",type:"bookmark"}}))}function C(){m.light(),b(t.currentTrack)}function T(){m.light(),r.value=h.cycle(r.value),window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:`Speed: ${r.value}x`,type:"info"}}))}function x(){m.light(),k.isActive()?(k.clear(),c.value=!1,window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Sleep timer off",type:"info"}}))):(k.start(30,()=>{t.pause(),c.value=!1,window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Sleep timer: pausing playback",type:"info"}}))}),c.value=!0,window.dispatchEvent(new CustomEvent("ahoy:toast",{detail:{message:"Sleep timer: 30 minutes",type:"info"}})))}function q(a){const s=t.queue.findIndex(i=>{var o;return i.id===((o=t.currentTrack)==null?void 0:o.id)});t.setQueue(t.queue,s+1+a)}return(a,s)=>{const i=I("router-link");return n(t).currentTrack?(u(),p("div",H,[e("div",K,[e("img",{src:n(t).currentTrack.cover_art||n(t).currentTrack.thumbnail||n(t).currentTrack.artwork||"/static/img/default-cover.jpg",alt:n(t).currentTrack.title,class:"np-artwork"},null,8,L)]),e("div",U,[e("h1",X,l(n(t).currentTrack.title),1),e("p",G,l(n(t).currentTrack.artist||""),1)]),e("div",J,[e("div",{class:"np-seek-bar",onClick:w,ref:"seekBar"},[e("div",{class:"np-seek-fill",style:f({width:n(t).progress+"%"})},null,4),e("div",{class:"np-seek-thumb",style:f({left:n(t).progress+"%"})},null,4)],512),e("div",O,[e("span",null,l(y(n(t).currentTime)),1),e("span",null,l(y(n(t).duration)),1)])]),e("div",W,[e("button",{class:"np-btn np-btn-secondary",onClick:s[0]||(s[0]=o=>n(t).previous()),"aria-label":"Previous"},[...s[3]||(s[3]=[e("i",{class:"fas fa-backward-step"},null,-1)])]),e("button",{class:"np-btn np-btn-play",onClick:s[1]||(s[1]=o=>n(t).togglePlay()),"aria-label":"Play/Pause"},[e("i",{class:g(n(t).isPlaying?"fas fa-pause":"fas fa-play"),style:{"margin-left":"2px"}},null,2)]),e("button",{class:"np-btn np-btn-secondary",onClick:s[2]||(s[2]=o=>n(t).next()),"aria-label":"Next"},[...s[4]||(s[4]=[e("i",{class:"fas fa-forward-step"},null,-1)])])]),e("div",Y,[e("button",{class:"np-action-btn",onClick:S,title:n(d).isBookmarked(n(t).currentTrack)?"Saved":"Save"},[e("i",{class:g(n(d).isBookmarked(n(t).currentTrack)?"fas fa-bookmark":"far fa-bookmark")},null,2)],8,Z),e("button",{class:"np-action-btn",onClick:T,title:`Speed: ${r.value}x`},[e("span",te,l(r.value)+"x",1)],8,ee),e("button",{class:"np-action-btn",onClick:x,title:c.value?"Sleep timer on":"Sleep timer"},[e("i",{class:"fas fa-moon",style:f({color:c.value?"var(--accent-primary, #6ddcff)":""})},null,4)],8,se),e("button",{class:"np-action-btn",onClick:C},[...s[5]||(s[5]=[e("i",{class:"fas fa-share-alt"},null,-1)])])]),v.value.length?(u(),p("div",ne,[s[6]||(s[6]=e("h3",{class:"np-queue-title"},"Up Next",-1)),e("div",ae,[(u(!0),p(P,null,$(v.value,(o,B)=>(u(),p("div",{key:o.id,class:"np-queue-item",onClick:me=>q(B)},[e("img",{src:o.cover_art||o.artwork||"/static/img/default-cover.jpg",class:"np-queue-art"},null,8,ie),e("div",le,[e("div",re,l(o.title),1),e("div",ce,l(o.artist),1)])],8,oe))),128))])])):M("",!0)])):(u(),p("div",ue,[e("div",pe,[s[8]||(s[8]=e("i",{class:"fas fa-music",style:{"font-size":"48px","margin-bottom":"16px",display:"block"}},null,-1)),s[9]||(s[9]=e("p",null,"No track playing",-1)),V(i,{to:"/music",style:{color:"var(--accent-primary, #6ddcff)","margin-top":"12px",display:"inline-block"}},{default:j(()=>[...s[7]||(s[7]=[z("Browse Music",-1)])]),_:1})])]))}}};export{fe as default};
