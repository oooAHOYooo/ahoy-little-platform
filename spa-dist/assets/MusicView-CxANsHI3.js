import{_ as G,c,d,e as t,C as V,n as r,t as y,D as K,q as x,m as v,u as W,z as Z,o as tt,y as et,k as Y,f as U,r as D,F as L,l as P,A as j,x as st,v as Q,i as at,E as z,p as lt,B as n,h as _,j as H}from"./index-CQc-P5P4.js";const F=70,O=120,ot={__name:"PullRefresh",emits:["refresh"],setup(X,{emit:l}){const k=l,E=v(null),h=v(!1),u=v(!1),g=v(0),i=v(0),w=x(()=>u.value?F*.6:Math.min(i.value*.5,O*.5)),p=x(()=>u.value?0:Math.min(i.value*.4,O*.4)-40),B=x(()=>u.value?1:Math.min(i.value/F,1)),f=x(()=>i.value>=F);function q(){return window.scrollY<=0}function m(T){!q()||u.value||(g.value=T.touches[0].clientY,h.value=!0)}function I(T){if(!h.value||u.value)return;const A=T.touches[0].clientY-g.value;A>0?i.value=A:(h.value=!1,i.value=0)}function C(){h.value&&(f.value?(u.value=!0,i.value=0,k("refresh",N)):i.value=0,h.value=!1)}function N(){u.value=!1,i.value=0}return(T,A)=>(c(),d("div",{class:"pull-refresh-wrapper",ref_key:"wrapper",ref:E,onTouchstartPassive:m,onTouchmovePassive:I,onTouchendPassive:C},[t("div",{class:r(["pull-indicator",{active:h.value,refreshing:u.value}]),style:V({transform:`translateY(${p.value}px)`,opacity:B.value})},[t("i",{class:r(u.value?"fas fa-spinner fa-spin":"fas fa-arrow-down"),style:V({transform:f.value?"rotate(180deg)":""})},null,6),t("span",null,y(u.value?"Refreshing...":f.value?"Release to refresh":"Pull to refresh"),1)],6),t("div",{class:"pull-content",style:V({transform:`translateY(${w.value}px)`})},[K(T.$slots,"default",{},void 0)],4)],544))}},it=G(ot,[["__scopeId","data-v-d1c2085f"]]),nt={class:"music-container"},rt={class:"podcasts-section podcasts-featured-section"},ut={class:"podcasts-section-header podcasts-featured-header"},ct={class:"podcast-filter-chips"},dt=["onClick"],vt={class:"podcast-shows-dropdown-mobile"},pt=["value"],ft={class:"music-header-toolbar"},mt={class:"search-bar music-toolbar-search"},yt={class:"view-options"},ht={class:"music-list"},bt={class:"music-table-wrap"},_t={class:"music-table"},kt=["onClick"],gt={class:"col-cover"},wt=["src","alt"],Ct={class:"col-play"},Tt=["aria-label","onClick"],$t={class:"col-title"},St={class:"col-artist"},Pt={class:"col-duration"},xt={class:"col-plays"},Bt={class:"col-action"},At=["aria-label","onClick"],Mt=["title","onClick"],Rt=["aria-pressed","onClick"],Dt={class:"music-grid"},Lt=["onClick"],Et=["src","alt"],qt={class:"track-overlay"},It=["onClick"],Nt=["onClick"],Vt=["onClick"],Yt=["title","onClick"],Qt={class:"track-title"},Ft={class:"track-artist"},Ut={class:"track-duration"},jt={key:0,class:"music-grid"},zt={key:1,class:"empty-state"},Ht={__name:"MusicView",setup(X){const l=W(),k=Z();function E(a){k.toggle({type:"track",id:a.id,title:a.title,cover_art:a.cover_art})}function h(a){const e=a&&(a.cover_art||a.artwork);return typeof e=="string"&&e.trim()?e:"/static/img/default-cover.jpg"}function u(a){if(!a||!a.artist)return;const e={recipientType:"artist",recipientId:a.artist_slug||a.artist,recipientName:a.artist};if(typeof document<"u"&&document.dispatchEvent)document.dispatchEvent(new CustomEvent("ahoy:boost:open",{detail:e}));else{const o=new URLSearchParams({type:"boost",artist_id:e.recipientId||e.recipientName,amount:"1"});window.location.href=`/checkout?${o.toString()}`}}const g=v([]),i=v(!0),w=v(""),p=v(""),B=v("plays"),f=v("list"),q=x(()=>{const a=new Set;for(const e of g.value)e.artist&&a.add(e.artist);return Array.from(a).sort()}),m=x(()=>{let a=[...g.value];if(w.value){const e=w.value.toLowerCase();a=a.filter(o=>(o.title||"").toLowerCase().includes(e)||(o.artist||"").toLowerCase().includes(e)||(o.album||"").toLowerCase().includes(e))}return p.value&&(a=a.filter(e=>e.artist===p.value)),a.sort((e,o)=>{switch(B.value){case"title":return(e.title||"").localeCompare(o.title||"");case"artist":return(e.artist||"").localeCompare(o.artist||"");case"added_date":return new Date(o.added_date||0)-new Date(e.added_date||0);case"plays":return(o.play_count||0)-(e.play_count||0);default:return 0}}),a});function I(a){if(!a&&a!==0)return"0:00";const e=Math.floor(Number(a)/60),o=Math.floor(Number(a)%60);return`${e}:${o.toString().padStart(2,"0")}`}function C(a){var s;const e=m.value,o=e[a];if(o){if(((s=l.currentTrack)==null?void 0:s.id)===o.id&&l.isPlaying){l.pause();return}l.setQueue(e,a)}}function N(a){l.addToQueue({type:"track",id:a.id,title:a.title,artist:a.artist,cover_art:a.cover_art,duration_seconds:a.duration_seconds})}function T(){if(m.value.length===0)return;const a=Math.floor(Math.random()*m.value.length);C(a)}async function A(){i.value=!0;try{const a=await z("/api/music?t="+Date.now());g.value=a.tracks||[]}catch{g.value=[]}i.value=!1}async function J(a){try{const e=await z("/api/music?t="+Date.now());g.value=e.tracks||[]}catch{}a()}return tt(A),(a,e)=>{const o=lt("router-link");return c(),et(it,{onRefresh:J},{default:Y(()=>[t("div",nt,[e[25]||(e[25]=t("section",{class:"podcasts-hero"},[t("div",{class:"podcasts-hero-inner"},[t("h1",null,[t("i",{class:"fas fa-music","aria-hidden":"true"}),U(" Music Library ")]),t("p",null,"Explore")])],-1)),t("section",rt,[t("div",ut,[e[10]||(e[10]=t("div",null,[t("h2",null,"Tracks"),t("p",{class:"podcasts-section-subtitle"},"Filter by artist or search. Sort and switch between list and grid.")],-1)),t("div",ct,[t("button",{type:"button",class:r(["podcast-filter-chip",{active:!p.value}]),onClick:e[0]||(e[0]=s=>p.value="")}," All ",2),(c(!0),d(L,null,D(q.value.slice(0,14),s=>(c(),d("button",{key:s,type:"button",class:r(["podcast-filter-chip",{active:p.value===s}]),onClick:$=>p.value=s},y(s),11,dt))),128))])]),t("div",vt,[P(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>p.value=s),class:"podcast-show-select","aria-label":"Filter by artist"},[e[11]||(e[11]=t("option",{value:""},"All Artists",-1)),(c(!0),d(L,null,D(q.value,s=>(c(),d("option",{key:s,value:s},y(s),9,pt))),128))],512),[[j,p.value]])]),t("div",ft,[t("div",mt,[e[13]||(e[13]=t("i",{class:"fas fa-search","aria-hidden":"true"},null,-1)),P(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>w.value=s),type:"text",class:"search-input",placeholder:"Search music...","aria-label":"Search music"},null,512),[[st,w.value]]),P(t("button",{type:"button",class:"search-clear","aria-label":"Clear search",onClick:e[3]||(e[3]=s=>w.value="")},[...e[12]||(e[12]=[t("i",{class:"fas fa-times","aria-hidden":"true"},null,-1)])],512),[[Q,w.value]])]),P(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>B.value=s),class:"music-toolbar-sort","aria-label":"Sort music"},[...e[14]||(e[14]=[t("option",{value:"title"},"Title",-1),t("option",{value:"artist"},"Artist",-1),t("option",{value:"plays"},"Plays",-1),t("option",{value:"added_date"},"Date Added",-1)])],512),[[j,B.value]]),t("div",yt,[t("button",{type:"button",class:r(["view-btn",{active:f.value==="grid"}]),"aria-label":"Grid view",onClick:e[5]||(e[5]=s=>f.value="grid")},[...e[15]||(e[15]=[t("i",{class:"fas fa-th","aria-hidden":"true"},null,-1)])],2),t("button",{type:"button",class:r(["view-btn",{active:f.value==="list"}]),"aria-label":"List view",onClick:e[6]||(e[6]=s=>f.value="list")},[...e[16]||(e[16]=[t("i",{class:"fas fa-list","aria-hidden":"true"},null,-1)])],2)]),t("button",{type:"button",class:"episode-btn music-toolbar-play",title:"Play Random",onClick:T},[...e[17]||(e[17]=[t("i",{class:"fas fa-random","aria-hidden":"true"},null,-1),t("span",{class:"sr-only"},"Play Random",-1)])])])]),P(t("div",ht,[t("div",bt,[t("table",_t,[e[20]||(e[20]=t("thead",null,[t("tr",null,[t("th",{class:"col-cover"}),t("th",{class:"col-play"}),t("th",{class:"col-title"},"Title"),t("th",{class:"col-artist"},"Artist"),t("th",{class:"col-duration"},"Time"),t("th",{class:"col-plays"},"Plays"),t("th",{class:"col-action"},"Actions")])],-1)),t("tbody",null,[(c(!0),d(L,null,D(m.value,(s,$)=>{var M,R,b;return c(),d("tr",{key:s.id,class:r(["music-table-row",{playing:((M=n(l).currentTrack)==null?void 0:M.id)===s.id}]),onClick:S=>C($)},[t("td",gt,[t("img",{class:"music-table-thumb",src:h(s),alt:s.title,loading:"lazy",onError:e[7]||(e[7]=S=>S.target.src="/static/img/default-cover.jpg")},null,40,wt)]),t("td",Ct,[t("button",{type:"button",class:"play-btn","aria-label":((R=n(l).currentTrack)==null?void 0:R.id)===s.id&&n(l).isPlaying?"Pause":"Play",onClick:_(S=>C($),["stop"])},[t("i",{class:r(((b=n(l).currentTrack)==null?void 0:b.id)===s.id&&n(l).isPlaying?"fas fa-pause":"fas fa-play")},null,2)],8,Tt)]),t("td",$t,[H(o,{to:`/music/${s.id}`,class:"title-text",onClick:e[8]||(e[8]=_(()=>{},["stop"]))},{default:Y(()=>[U(y(s.title),1)]),_:2},1032,["to"])]),t("td",St,y(s.artist),1),t("td",Pt,y(I(s.duration_seconds)),1),t("td",xt,y(s.play_count||0),1),t("td",Bt,[t("button",{type:"button",class:r(["action-btn queue-btn",{"in-queue":n(l).isInQueue({id:s.id})}]),title:"Add to queue","aria-label":n(l).isInQueue({id:s.id})?"In queue":"Add to queue",onClick:_(S=>N(s),["stop"])},[t("i",{class:r(n(l).isInQueue({id:s.id})?"fas fa-check":"fas fa-plus")},null,2),e[18]||(e[18]=t("span",{class:"sr-only"},"Add to queue",-1))],10,At),t("button",{type:"button",class:"action-btn boost-btn",title:"Boost "+(s.artist||"artist"),"aria-label":"Boost artist",onClick:_(S=>u(s),["stop"])},[...e[19]||(e[19]=[t("i",{class:"fas fa-heart"},null,-1),t("span",{class:"sr-only"},"Boost",-1)])],8,Mt),t("button",{type:"button",class:r(["action-btn bm-btn",{bookmarked:n(k).isBookmarked({id:s.id})}]),"aria-pressed":n(k).isBookmarked({id:s.id}),title:"Save",onClick:_(S=>E(s),["stop"])},[t("i",{class:r(n(k).isBookmarked({id:s.id})?"fas fa-bookmark":"far fa-bookmark")},null,2)],10,Rt)])],10,kt)}),128))])])])],512),[[Q,f.value==="list"&&!i.value&&m.value.length>0]]),P(t("div",Dt,[(c(!0),d(L,null,D(m.value,(s,$)=>{var M,R;return c(),d("div",{key:s.id,class:r(["track-card",{playing:((M=n(l).currentTrack)==null?void 0:M.id)===s.id}])},[t("div",{class:"track-cover",onClick:b=>C($)},[t("img",{src:h(s),alt:s.title,loading:"lazy",onError:e[9]||(e[9]=b=>b.target.src="/static/img/default-cover.jpg")},null,40,Et),t("div",qt,[t("button",{type:"button",class:"play-btn",onClick:_(b=>C($),["stop"])},[t("i",{class:r(((R=n(l).currentTrack)==null?void 0:R.id)===s.id&&n(l).isPlaying?"fas fa-pause":"fas fa-play")},null,2)],8,It),t("button",{type:"button",class:"track-overlay-btn add-to-playlist-btn",title:"Add to queue",onClick:_(b=>N(s),["stop"])},[...e[21]||(e[21]=[t("i",{class:"fas fa-plus"},null,-1)])],8,Nt),t("button",{type:"button",class:"track-overlay-btn boost-btn",title:"Boost artist",onClick:_(b=>u(s),["stop"])},[...e[22]||(e[22]=[t("i",{class:"fas fa-heart"},null,-1)])],8,Vt),t("button",{type:"button",class:"track-overlay-btn bm-btn",title:n(k).isBookmarked({id:s.id})?"Unsave":"Save",onClick:_(b=>E(s),["stop"])},[t("i",{class:r(n(k).isBookmarked({id:s.id})?"fas fa-bookmark":"far fa-bookmark")},null,2)],8,Yt)])],8,Lt),H(o,{to:`/music/${s.id}`,class:"track-info",style:{"text-decoration":"none",color:"inherit"}},{default:Y(()=>[t("div",Qt,y(s.title),1),t("div",Ft,y(s.artist),1),t("div",Ut,y(I(s.duration_seconds)),1)]),_:2},1032,["to"])],2)}),128))],512),[[Q,f.value==="grid"&&!i.value&&m.value.length>0]]),i.value?(c(),d("div",jt,[(c(),d(L,null,D(8,s=>t("div",{key:s,class:"track-card"},[...e[23]||(e[23]=[t("div",{class:"track-cover skeleton"},null,-1),t("div",{class:"track-info"},[t("div",{class:"skeleton",style:{height:"14px",width:"60%","margin-bottom":"6px"}}),t("div",{class:"skeleton",style:{height:"12px",width:"40%","margin-bottom":"4px"}}),t("div",{class:"skeleton",style:{height:"10px",width:"36px"}})],-1)])])),64))])):!i.value&&m.value.length===0?(c(),d("div",zt,[...e[24]||(e[24]=[t("i",{class:"fas fa-music"},null,-1),t("h3",null,"No music found",-1),t("p",null,"Try adjusting your filters or search terms",-1)])])):at("",!0)])]),_:1})}}},Gt=G(Ht,[["__scopeId","data-v-60314292"]]);export{Gt as default};
